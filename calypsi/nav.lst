###############################################################################
#                                                                             #
# Calypsi ISO C compiler for 6502                                version 5.12 #
#                                                       07/Nov/2025  20:26:14 #
# Command line:                                                               #
#               --list-file=F:\Entwicklungsprojekte\github-nobru\midnightmega\calypsi\nav.lst #
#               -D asm=__asm -I calypsi.h -D VERSION="v0.6.6-beta" -I         #
#               ..\mega65-libc\include -O 2 --core 45gs02 --target MEGA65     #
#               -D FULLFEATURES -o                                            #
#               F:\Entwicklungsprojekte\github-nobru\midnightmega\calypsi\nav.o #
#               nav.c                                                         #
#                                                                             #
###############################################################################

    \ 0000                      .rtmodel version,"1"
    \ 0000                      .rtmodel codeModel,"plain"
    \ 0000                      .rtmodel core,"45gs02"
    \ 0000                      .rtmodel doubleSize,"32"
    \ 0000                      .rtmodel target,"mega65"
    \ 0000                      .extern BAM2Attic
    \ 0000                      .extern BAMAllocateTracks
    \ 0000                      .extern BAMCheckSizeinFilebuffer
    \ 0000                      .extern FormatPartition
    \ 0000                      .extern FreeBlocks
    \ 0000                      .extern FreeTracks
    \ 0000                      .extern GetBAM
    \ 0000                      .extern PutBAM
    \ 0000                      .extern _AllocStackSave
    \ 0000                      .extern _DeallocStackRestore
    \ 0000                      .extern _DecVsp
    \ 0000                      .extern _DivMod16
    \ 0000                      .extern _FillQ
    \ 0000                      .extern _IncVsp
    \ 0000                      .extern _LoadVspEA
    \ 0000                      .extern _Mul8
    \ 0000                      .extern _RestoreRegisters
    \ 0000                      .extern _SpillZP
    \ 0000                      .extern _UDivMod16
    \ 0000                      .extern _ValueSwitch16
    \ 0000                      .extern _Vfp
    \ 0000                      .extern _Vsp
    \ 0000                      .extern _Zp
    \ 0000                      .extern _miniInit
    \ 0000                      .extern atoi
    \ 0000                      .extern blink
    \ 0000                      .extern bordercolor
    \ 0000                      .extern cgetc
    \ 0000                      .extern copywholedisk
    \ 0000                      .extern cputc
    \ 0000                      .extern cputcxy
    \ 0000                      .extern cputs
    \ 0000                      .extern cputsxy
    \ 0000                      .extern csputdec
    \ 0000                      .extern deletedirententry
    \ 0000                      .extern direntflags
    \ 0000                      .extern getDiskname
    \ 0000                      .extern getdirent
    \ 0000                      .extern getdirententry
    \ 0000                      .extern gethyppodirent
    \ 0000                      .extern getkeymodstate
    \ 0000                      .extern getscreenaddr
    \ 0000                      .extern getscreensize
    \ 0000                      .extern gettype
    \ 0000                      .extern gotoxy
    \ 0000                      .extern hyppo_chdir
    \ 0000                      .extern hyppo_closedir
    \ 0000                      .extern hyppo_d81attach0
    \ 0000                      .extern hyppo_d81attach1
    \ 0000                      .extern hyppo_dos_attach
    \ 0000                      .extern hyppo_findfirst
    \ 0000                      .extern hyppo_freeze_self
    \ 0000                      .extern hyppo_get_proc_desc
    \ 0000                      .extern hyppo_getversion_majorHDOS
    \ 0000                      .extern hyppo_getversion_majorhyppo
    \ 0000                      .extern hyppo_getversion_minorHDOS
    \ 0000                      .extern hyppo_getversion_minorhyppo
    \ 0000                      .extern hyppo_rmdir
    \ 0000                      .extern hyppo_rmfile
    \ 0000                      .extern hyppo_setname
    \ 0000                      .extern inputbox
    \ 0000                      .extern lcopy
    \ 0000                      .extern lfill
    \ 0000                      .extern mcbox
    \ 0000                      .extern mcputc
    \ 0000                      .extern mcputsxy
    \ 0000                      .extern messagebox
    \ 0000                      .extern msprintf
    \ 0000                      .extern mstrcmp
    \ 0000                      .extern option
    \ 0000                      .extern petsciitoscreencode_s
    \ 0000                      .extern progress
    \ 0000                      .extern readblockchain
    \ 0000                      .extern renamedisk
    \ 0000                      .extern revers
    \ 0000                      .extern rewritedirent
    \ 0000                      .extern romlist
    \ 0000                      .extern sidbong
    \ 0000                      .extern strcopy
    \ 0000                      .extern strcpy
    \ 0000                      .extern strmakefilename
    \ 0000                      .extern swapdirententry
    \ 0000                      .extern taskblock
    \ 0000                      .extern text
    \ 0000                      .extern textcolor
    \ 0000                      .extern usleep
    \ 0000                      .extern wherex
    \ 0000                      .extern writeblockchain
    \ 0000                      .extern writenewdirententry
0001                #include <stdlib.h>
0002                #include <stdint.h>
0003                #include <stdio.h>
0004                #include <string.h>
0005                #include <limits.h>
0006                #include <mega65/conio.h>  // llvm instead of <printf.h>
0007                #include <mega65/memory.h>  // mega65-libc
0008                #include <mega65/hal.h>  // mega65-libc
0009                #include "regions.h"
0010                #include "conioextensions.h"
0011                #include "hyppo.h"
0012                #include "fileio.h"
0013                #include "texts.h"
0014                #include "romlist.h"
0015                #include "nav.h"
0016                #include "sid.h"
0017
0018                // *********************************************************
0019                // ***  nav.c Midnight Mega's window mgmt                ***
0020                // *********************************************************
0021
0022                // flags and stuff:
0023                // __attribute__((section(".data")))
0024                MIDNIGHT* midnight[2] = { (MIDNIGHT*) MIDNIGHTLEFTPAGE,
    \ 0000                      .section data,data
    \ 0000                      .public midnight
    \ 0000 001d001e midnight:   .word   0x1d00,0x1e00
0025                                          (MIDNIGHT*) MIDNIGHTRIGHTPAGE };
0026                unsigned char disknames[2][DOSFILENAMELEN + 1]; // @@ change for pointer
    \ 0000                      .section zdata,bss
    \ 0000                      .public disknames
    \ 0000          disknames:  .space  34
0027                unsigned char lfnname[LFNFILENAMELEN];         // @@ change for pointer
    \ 0000                      .section zdata,bss
    \ 0000                      .public lfnname
    \ 0000          lfnname:    .space  64
0028
0029                #define DIRENTPERSCREEN 22
0030                // @@ The in here present recognition of 0xa0 is also in conioextensions.c
0031                // @@ string build-up may be used elsewhere
0032                unsigned char s[2 * DOSFILENAMEANDTYPELEN]; // @@@@
    \ 0000                      .section zdata,bss
    \ 0000                      .public s
    \ 0000          s:          .space  80
0033                void listbox(unsigned char iscurrent, unsigned char side,
0034                             unsigned char x, unsigned char y,
0035                             unsigned char currentitem, unsigned char nbritems)  {
    \ 0000                      .section code,text
    \ 0000                      .public listbox
    \ 0000 a200     listbox:    ldx     #0
    \ 0002 a00b                 ldy     #11
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+27
    \ 0009 a5..                 lda     zp:_Zp
    \ 000b 85..                 sta     zp:_Zp+32
    \ 000d a5..                 lda     zp:_Zp+1
    \ 000f 85..                 sta     zp:_Zp+33
    \ 0011 a5..                 lda     zp:_Zp+2
    \ 0013 85..                 sta     zp:_Zp+34
    \ 0015 a5..                 lda     zp:_Zp+3
    \ 0017 85..                 sta     zp:_Zp+35
    \ 0019 a5..                 lda     zp:_Zp+4
    \ 001b 85..                 sta     zp:_Zp+26
0036                  unsigned int n;
0037                  unsigned char i;
0038                  unsigned char j;
0039                  unsigned int ofs = 0;
    \ 001d 8a                   txa
    \ 001e 85..                 sta     zp:_Zp+30
    \ 0020 85..                 sta     zp:_Zp+31
0040                  DIRENT* ds;
0041
0042                  if (currentitem + 1 >= DIRENTPERSCREEN)  ofs = currentitem + 1 - DIRENTPERSCREEN;
    \ 0022 a6..                 ldx     zp:_Zp+35
    \ 0024 86..                 stx     zp:_Zp
    \ 0026 85..                 sta     zp:_Zp+1
    \ 0028 e3..                 inw     zp:_Zp
    \ 002a a5..                 lda     zp:_Zp
    \ 002c c916                 cmp     #22
    \ 002e a5..                 lda     zp:_Zp+1
    \ 0030 e900                 sbc     #0
    \ 0032 5002                 bvc     `?L827`
    \ 0034 4980                 eor     #-128
    \ 0036 300d     `?L827`:    bmi     `?L5`
    \ 0038 a5..                 lda     zp:_Zp+35
    \ 003a 18                   clc
    \ 003b 69eb                 adc     #235
    \ 003d 85..                 sta     zp:_Zp+30
    \ 003f a900                 lda     #0
    \ 0041 69ff                 adc     #255
    \ 0043 85..                 sta     zp:_Zp+31
    \ 0045          `?L5`:
0043
0044                  for (n = 0 ; n < DIRENTPERSCREEN; n++)  {
    \ 0045 20....               jsr     `?L2060`
    \ 0048          `?L8`:
    \ 0048 a5..                 lda     zp:_Zp+28
    \ 004a c916                 cmp     #22
    \ 004c a5..                 lda     zp:_Zp+29
    \ 004e e900                 sbc     #0
    \ 0050 b3d101               lbcs    `?L10`
0045                    ds = getdirententry(side, n + ofs);
    \ 0053 a5..                 lda     zp:_Zp+30
    \ 0055 18                   clc
    \ 0056 65..                 adc     zp:_Zp+28
    \ 0058 85..                 sta     zp:_Zp
    \ 005a a5..                 lda     zp:_Zp+31
    \ 005c 65..                 adc     zp:_Zp+29
    \ 005e 85..                 sta     zp:_Zp+1
    \ 0060 a5..                 lda     zp:_Zp+32
    \ 0062 20....               jsr     getdirententry
0046                    if (ds == NULL || (n + ofs) > nbritems)  break;
    \ 0065 20....               jsr     `?L2022`
    \ 0068 a5..                 lda     zp:_Zp+24
    \ 006a 05..                 ora     zp:_Zp+25
    \ 006c f3b501               lbeq    `?L10`
    \ 006f a6..                 ldx     zp:_Zp+26
    \ 0071 20....               jsr     `?L1953`
    \ 0074 85..                 sta     zp:_Zp+1
    \ 0076 a5..                 lda     zp:_Zp+30
    \ 0078 18                   clc
    \ 0079 65..                 adc     zp:_Zp+28
    \ 007b 85..                 sta     zp:_Zp+2
    \ 007d a5..                 lda     zp:_Zp+31
    \ 007f 65..                 adc     zp:_Zp+29
    \ 0081 20....               jsr     `?L2042`
    \ 0084 939d01               lbcc    `?L10`
0047
0048                    i = 0;
    \ 0087 a900                 lda     #0
    \ 0089 85..                 sta     zp:_Zp+2
0049                    if (n + ofs == currentitem)  s[i++] = '>';
    \ 008b 20....               jsr     `?L1926`
    \ 008e d009                 bne     `?L15`
    \ 0090 a5..                 lda     zp:_Zp+2
    \ 0092 e6..                 inc     zp:_Zp+2
    \ 0094 aa                   tax
    \ 0095 a93e                 lda     #62
    \ 0097 8007                 bra     `?L1812`
    \ 0099          `?L15`:
0050                    else                   s[i++] = ' ';
    \ 0099 a5..                 lda     zp:_Zp+2
    \ 009b e6..                 inc     zp:_Zp+2
    \ 009d aa                   tax
    \ 009e a920                 lda     #32
    \ 00a0          `?L1812`:
    \ 00a0 9d....               sta     s,x
0051                    s[i++] = ' ';
    \ 00a3 a5..                 lda     zp:_Zp+2
    \ 00a5 e6..                 inc     zp:_Zp+2
0052                    j = 0;
    \ 00a7 20....               jsr     `?L1951`
    \ 00aa a900                 lda     #0
    \ 00ac 85..                 sta     zp:_Zp
    \ 00ae          `?L18`:
0053                    while (ds->name[j] != 0xa0 && ds->name[j] != 0 && j < DOSFILENAMELEN)  {
    \ 00ae 20....               jsr     `?L1970`
    \ 00b1 18                   clc
    \ 00b2 a5..                 lda     zp:_Zp+4
    \ 00b4 65..                 adc     zp:_Zp
    \ 00b6 85..                 sta     zp:_Zp+4
    \ 00b8 9002                 bcc     `?L830`
    \ 00ba e6..                 inc     zp:_Zp+5
    \ 00bc a000     `?L830`:    ldy     #0
    \ 00be b1..                 lda     (_Zp+4),y
    \ 00c0 c9a0                 cmp     #-96
    \ 00c2 f02f                 beq     `?L22`
    \ 00c4 20....               jsr     `?L1970`
    \ 00c7 ab....               ldz     _Zp
    \ 00ca b2..                 lda     (_Zp+4),z
    \ 00cc f025                 beq     `?L22`
    \ 00ce ab....               ldz     _Zp
    \ 00d1 c210                 cpz     #16
    \ 00d3 b01e                 bcs     `?L22`
0054                      s[i++] = ds->name[j];
    \ 00d5 20....               jsr     `?L1970`
    \ 00d8 18                   clc
    \ 00d9 a5..                 lda     zp:_Zp+4
    \ 00db 65..                 adc     zp:_Zp
    \ 00dd 85..                 sta     zp:_Zp+4
    \ 00df 9002                 bcc     `?L832`
    \ 00e1 e6..                 inc     zp:_Zp+5
    \ 00e3          `?L832`:
    \ 00e3 a5..                 lda     zp:_Zp+2
    \ 00e5 e6..                 inc     zp:_Zp+2
    \ 00e7 aa                   tax
    \ 00e8 a300                 ldz     #0
    \ 00ea b2..                 lda     (_Zp+4),z
    \ 00ec 9d....               sta     s,x
0055                      j++;
    \ 00ef e6..                 inc     zp:_Zp
    \ 00f1 80bb                 bra     `?L18`
    \ 00f3          `?L22`:
0056                    }
0057                    for ( ; j < DOSFILENAMELEN; j++)  s[i++] = ' ';
    \ 00f3 ab....               ldz     _Zp
    \ 00f6 c210                 cpz     #16
    \ 00f8 931d01               lbcc    `?L21`
0058                    s[i++] = ' ';
    \ 00fb a5..                 lda     zp:_Zp+2
    \ 00fd e6..                 inc     zp:_Zp+2
0059                    s[i++] = 93; // '|';
0060                    s[i++] = ' ';
0061                    i = gettype(ds->type, s, i);
    \ 00ff 20....               jsr     `?L1951`
    \ 0102 a5..                 lda     zp:_Zp+2
    \ 0104 e6..                 inc     zp:_Zp+2
    \ 0106 aa                   tax
    \ 0107 a95d                 lda     #93
    \ 0109 9d....               sta     s,x
    \ 010c a5..                 lda     zp:_Zp+2
    \ 010e e6..                 inc     zp:_Zp+2
    \ 0110 20....               jsr     `?L1951`
    \ 0113 a9..                 lda     #.byte0 s
    \ 0115 85..                 sta     zp:_Zp
    \ 0117 a9..                 lda     #.byte1 s
    \ 0119 85..                 sta     zp:_Zp+1
    \ 011b a002                 ldy     #2
    \ 011d b1..                 lda     (_Zp+24),y
    \ 011f 20....               jsr     gettype
    \ 0122 85..                 sta     zp:_Zp
0062                    s[i++] = ' ';
    \ 0124 e6..                 inc     zp:_Zp
0063                    s[i++] = 93; // '|';
0064                    s[i++] = ' ';
0065                    
0066                    s[i++] = 0;
0067                    if (direntflags[side][n + ofs].flags & DIRFLAGSisselected)  textcolor(COLOUR_YELLOW);
    \ 0126 20....               jsr     `?L1951`
    \ 0129 a5..                 lda     zp:_Zp
    \ 012b e6..                 inc     zp:_Zp
    \ 012d aa                   tax
    \ 012e a95d                 lda     #93
    \ 0130 9d....               sta     s,x
    \ 0133 a5..                 lda     zp:_Zp
    \ 0135 e6..                 inc     zp:_Zp
    \ 0137 20....               jsr     `?L1951`
    \ 013a a5..                 lda     zp:_Zp
    \ 013c aa                   tax
    \ 013d a900                 lda     #0
    \ 013f 9d....               sta     s,x
    \ 0142 a6..                 ldx     zp:_Zp+32
    \ 0144 86..                 stx     zp:_Zp
    \ 0146 20....               jsr     `?L1912`
    \ 0149 f005                 beq     `?L835`
    \ 014b          `?L836`:
    \ 014b 20....               jsr     `?L1990`
    \ 014e d0fb                 bne     `?L836`
    \ 0150          `?L835`:
    \ 0150 20....               jsr     `?L1911`
    \ 0153 20....               jsr     `?L2025`
    \ 0156 f004                 beq     `?L25`
    \ 0158 a907                 lda     #7
    \ 015a 800c                 bra     `?L1811`
    \ 015c          `?L25`:
0068                    else if (ds->type == VAL_DOSFTYPE_DEL)  textcolor(COLOUR_GREY2);
    \ 015c a002                 ldy     #2
    \ 015e b1..                 lda     (_Zp+24),y
    \ 0160 d004                 bne     `?L28`
    \ 0162 a90c                 lda     #12
    \ 0164 8002                 bra     `?L1811`
    \ 0166          `?L28`:
0069                    else                                    textcolor(COLOUR_CYAN);
    \ 0166 a903                 lda     #3
    \ 0168          `?L1811`:
    \ 0168 20....               jsr     textcolor
0070                    if ((n + ofs == currentitem) && iscurrent)  revers(1);
    \ 016b 20....               jsr     `?L1926`
    \ 016e d008                 bne     `?L31`
    \ 0170 a5..                 lda     zp:_Zp+27
    \ 0172 f004                 beq     `?L31`
    \ 0174 a901                 lda     #1
    \ 0176 8002                 bra     `?L1809`
    \ 0178          `?L31`:
0071                    else  revers(0);
    \ 0178 a900                 lda     #0
    \ 017a          `?L1809`:
    \ 017a 20....               jsr     revers
0072                    /* new colour scheme for Deft's can't del DEL:
0073                    if ((direntflags[side][n + ofs].flags & DIRFLAGSisselected) ||
0074                        ((n + ofs == currentitem) && iscurrent))  {
0075                      revers(1);
0076                    } else {
0077                      revers(0);
0078                    }
0079                    if (direntflags[side][n + ofs].flags & DIRFLAGSisselected)  {
0080                      if ((n + ofs == currentitem) && iscurrent)  textcolor(COLOUR_GREY2);
0081                      else                                        textcolor(COLOUR_YELLOW);
0082                    } else if (ds->type == VAL_DOSFTYPE_DEL)  textcolor(COLOUR_GREY2);
0083                    else                                      textcolor(COLOUR_CYAN);
0084                    */
0085                    cputsxy(x, y + n, s);  // print what we've got so far
    \ 017d 20....               jsr     `?L2074`
    \ 0180 a5..                 lda     zp:_Zp+28
    \ 0182 18                   clc
    \ 0183 65..                 adc     zp:_Zp+34
    \ 0185 85..                 sta     zp:_Zp
    \ 0187 a5..                 lda     zp:_Zp+33
    \ 0189 20....               jsr     cputsxy
0086                    // i = i + sprintf((char*) &s[i], "%4d", ds->size);
0087                    if (ds->size > 0)  {
    \ 018c a31e                 ldz     #30
    \ 018e b2..                 lda     (_Zp+24),z
    \ 0190 1b                   inz
    \ 0191 12..                 ora     (_Zp+24),z
    \ 0193 f01a                 beq     `?L34`
0088                      csputdec(ds->size, 5, 0);
    \ 0195 a900                 lda     #0
    \ 0197 85..                 sta     zp:_Zp+4
    \ 0199 3b                   dez
    \ 019a b2..                 lda     (_Zp+24),z
    \ 019c 85..                 sta     zp:_Zp
    \ 019e 1b                   inz
    \ 019f b2..                 lda     (_Zp+24),z
    \ 01a1 20....               jsr     `?L1934`
    \ 01a4 85..                 sta     zp:_Zp+2
    \ 01a6 85..                 sta     zp:_Zp+3
    \ 01a8 a905                 lda     #5
    \ 01aa 20....               jsr     csputdec
    \ 01ad 800b                 bra     `?L35`
    \ 01af          `?L34`:
0089                    } else {
0090                      cputs((unsigned char*) "    ");
    \ 01af a9..                 lda     #.byte0 `_StringLiteral_    `
    \ 01b1 85..                 sta     zp:_Zp
    \ 01b3 a9..                 lda     #.byte1 `_StringLiteral_    `
    \ 01b5 85..                 sta     zp:_Zp+1
    \ 01b7 20....               jsr     cputs
    \ 01ba          `?L35`:
0091                    }
0092                    cputc(' '); // s[i++] = ' ';
    \ 01ba a920                 lda     #32
    \ 01bc 20....               jsr     cputc
0093                    if (n + ofs == currentitem)  cputc('<'); // s[i++] = '<';
    \ 01bf 20....               jsr     `?L1926`
    \ 01c2 d004                 bne     `?L37`
    \ 01c4 a93c                 lda     #60
    \ 01c6 8002                 bra     `?L1807`
    \ 01c8          `?L37`:
0094                    else                   cputc(' '); // s[i++] = ' ';
    \ 01c8 a920                 lda     #32
    \ 01ca          `?L1807`:
    \ 01ca 20....               jsr     cputc
0095                //    s[i++] = 0;
0096
0097                //    if (n + ofs == currentitem)  revers(1);
0098                //    else                   revers(0);
0099                //    cputsxy(x, y + n, s);
0100                    textcolor(COLOUR_CYAN);
    \ 01cd a903                 lda     #3
    \ 01cf 20....               jsr     textcolor
0101                    if ((midnight[side]->flags & MIDNIGHTFLAGdirsortactive) &&
0102                        (direntflags[side][n + ofs].flags & DIRFLAGSisselected) &&
0103                        (n + ofs == currentitem))  {
    \ 01d2 a5..                 lda     zp:_Zp+32
    \ 01d4 20....               jsr     `?L1908`
    \ 01d7 20....               jsr     `?L1987`
    \ 01da f036                 beq     `?L9`
    \ 01dc a6..                 ldx     zp:_Zp+32
    \ 01de 20....               jsr     `?L1953`
    \ 01e1 20....               jsr     `?L1912`
    \ 01e4 f005                 beq     `?L850`
    \ 01e6          `?L851`:
    \ 01e6 20....               jsr     `?L1990`
    \ 01e9 d0fb                 bne     `?L851`
    \ 01eb          `?L850`:
    \ 01eb 20....               jsr     `?L1911`
    \ 01ee 20....               jsr     `?L2025`
    \ 01f1 f01f                 beq     `?L9`
    \ 01f3 20....               jsr     `?L1926`
    \ 01f6 d01a                 bne     `?L9`
0104                      cputc(' ');
    \ 01f8 a920                 lda     #32
    \ 01fa 20....               jsr     cputc
0105                      if (currentitem > 0)         cputc(0x1e);
    \ 01fd a5..                 lda     zp:_Zp+35
    \ 01ff f005                 beq     `?L44`
    \ 0201 a91e                 lda     #30
    \ 0203 20....               jsr     cputc
    \ 0206          `?L44`:
0106                      if (currentitem < nbritems)  mcputc('v');
    \ 0206 ab....               ldz     _Zp+35
    \ 0209 d4..                 cpz     zp:_Zp+26
    \ 020b b005                 bcs     `?L9`
    \ 020d a976                 lda     #118
    \ 020f 20....               jsr     mcputc
    \ 0212          `?L9`:
    \ 0212 e3..                 inw     zp:_Zp+28
    \ 0214 4c....               jmp     `?L8`
    \ 0217          `?L21`:
    \ 0217 a5..                 lda     zp:_Zp+2
    \ 0219 e6..                 inc     zp:_Zp+2
    \ 021b 20....               jsr     `?L1951`
    \ 021e e6..                 inc     zp:_Zp
    \ 0220 4c....               jmp     `?L22`
    \ 0223          `?L10`:
0107                //      msprintf(" \x1ev");
0108                    }
0109                  }
0110                  revers(0);  // otherwise last entry selected makes neighbouring frame reversed
    \ 0223 20....               jsr     `?L1973`
0111                //  cputln();
0112                }
    \ 0226 a00b                 ldy     #11
    \ 0228 4c....               jmp     _RestoreRegisters
0113
0114                void Deselect(unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public Deselect
    \ 0000          Deselect:
    \ 0000 85..                 sta     zp:_Zp+6
0115                  unsigned int i;
0116
0117                  // deselect all entries:
0118                  for (i = 0; i < NBRENTRIES; i++)  {
    \ 0002 a900                 lda     #0
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008          `?L53`:
    \ 0008 a5..                 lda     zp:_Zp
    \ 000a c9f8                 cmp     #248
    \ 000c a5..                 lda     zp:_Zp+1
    \ 000e e900                 sbc     #0
    \ 0010 9001                 bcc     `?L52`
0119                    direntflags[side][i].flags &= ~(DIRFLAGSisselected);
0120                  }
0121                }
    \ 0012 60                   rts
    \ 0013          `?L52`:
    \ 0013 a6..                 ldx     zp:_Zp+6
    \ 0015 86..                 stx     zp:_Zp+2
    \ 0017 a900                 lda     #0
    \ 0019 85..                 sta     zp:_Zp+3
    \ 001b cb....               asw     _Zp+2
    \ 001e cb....               asw     _Zp+2
    \ 0021 cb....               asw     _Zp+2
    \ 0024 a5..                 lda     zp:_Zp+2
    \ 0026 85..                 sta     zp:_Zp+4
    \ 0028 a5..                 lda     zp:_Zp+3
    \ 002a 85..                 sta     zp:_Zp+5
    \ 002c a905                 lda     #5
    \ 002e aa                   tax
    \ 002f f006                 beq     `?L857`
    \ 0031          `?L858`:
    \ 0031 cb....               asw     _Zp+4
    \ 0034 ca                   dex
    \ 0035 d0fa                 bne     `?L858`
    \ 0037          `?L857`:
    \ 0037 a5..                 lda     zp:_Zp+4
    \ 0039 38                   sec
    \ 003a e5..                 sbc     zp:_Zp+2
    \ 003c 85..                 sta     zp:_Zp+2
    \ 003e a5..                 lda     zp:_Zp+5
    \ 0040 e5..                 sbc     zp:_Zp+3
    \ 0042 85..                 sta     zp:_Zp+3
    \ 0044 18                   clc
    \ 0045 a5..                 lda     zp:_Zp+2
    \ 0047 69..                 adc     #.byte0 direntflags
    \ 0049 85..                 sta     zp:_Zp+4
    \ 004b a5..                 lda     zp:_Zp+3
    \ 004d 20....               jsr     `?L2064`
    \ 0050 18                   clc
    \ 0051 a5..                 lda     zp:_Zp+4
    \ 0053 65..                 adc     zp:_Zp+2
    \ 0055 85..                 sta     zp:_Zp+4
    \ 0057 9002                 bcc     `?L860`
    \ 0059 e6..                 inc     zp:_Zp+5
    \ 005b a9fe     `?L860`:    lda     #-2
    \ 005d a300                 ldz     #0
    \ 005f 32..                 and     (_Zp+4),z
    \ 0061 92..                 sta     (_Zp+4),z
    \ 0063 e3..                 inw     zp:_Zp
    \ 0065 80a1                 bra     `?L53`
0122
0123                void shortcutprint(unsigned char active, char* textbefore, char* textafter)  {
    \ 0000                      .section code,text
    \ 0000                      .public shortcutprint
    \ 0000          shortcutprint:
    \ 0000 a200                 ldx     #0
    \ 0002 a004                 ldy     #4
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+28
    \ 0009 a5..                 lda     zp:_Zp
    \ 000b 85..                 sta     zp:_Zp+26
    \ 000d a5..                 lda     zp:_Zp+1
    \ 000f 85..                 sta     zp:_Zp+27
    \ 0011 a5..                 lda     zp:_Zp+2
    \ 0013 85..                 sta     zp:_Zp+24
    \ 0015 a5..                 lda     zp:_Zp+3
    \ 0017 85..                 sta     zp:_Zp+25
0124                  textcolor(COLOUR_WHITE);
    \ 0019 a901                 lda     #1
    \ 001b 20....               jsr     textcolor
0125                  msprintf(textbefore);
    \ 001e 20....               jsr     `?L1944`
    \ 0021 20....               jsr     msprintf
0126                  if (active)  textcolor(COLOUR_CYAN);
    \ 0024 a5..                 lda     zp:_Zp+28
    \ 0026 f004                 beq     `?L59`
    \ 0028 a903                 lda     #3
    \ 002a 8002                 bra     `?L1814`
    \ 002c          `?L59`:
0127                  else         textcolor(COLOUR_GREY);
    \ 002c a90c                 lda     #12
    \ 002e          `?L1814`:
    \ 002e 20....               jsr     textcolor
0128                  revers(1);
    \ 0031 a901                 lda     #1
    \ 0033 20....               jsr     revers
0129                  msprintf(textafter);
    \ 0036 a5..                 lda     zp:_Zp+24
    \ 0038 85..                 sta     zp:_Zp
    \ 003a a5..                 lda     zp:_Zp+25
    \ 003c 85..                 sta     zp:_Zp+1
    \ 003e 20....               jsr     msprintf
0130                  revers(0);
    \ 0041 20....               jsr     `?L1973`
0131                }
    \ 0044 a004                 ldy     #4
    \ 0046 4c....               jmp     _RestoreRegisters
0132
0133                void shortcuts(unsigned char mod, unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public shortcuts
    \ 0000 a2fe     shortcuts:  ldx     #254
    \ 0002 a005                 ldy     #5
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+25
    \ 0009 a5..                 lda     zp:_Zp
    \ 000b 85..                 sta     zp:_Zp+24
0134                  unsigned char width;
0135                  unsigned char height;
0136
0137                  gotoxy(0, 24);
    \ 000d a918                 lda     #24
    \ 000f 85..                 sta     zp:_Zp
    \ 0011 a900                 lda     #0
    \ 0013 20....               jsr     gotoxy
0138                  if (midnight[side]->flags & MIDNIGHTFLAGdirsortactive)  {
    \ 0016 a5..                 lda     zp:_Zp+24
    \ 0018 20....               jsr     `?L1908`
    \ 001b 20....               jsr     `?L1987`
    \ 001e f33401               lbeq    `?L65`
0139                    textcolor(COLOUR_YELLOW);
    \ 0021 a907                 lda     #7
    \ 0023 20....               jsr     textcolor
0140                    msprintf("Arrange entries:");
    \ 0026 a9..                 lda     #.byte0 `_StringLiteral_Arrange entries:`
    \ 0028 85..                 sta     zp:_Zp
    \ 002a a9..                 lda     #.byte1 `_StringLiteral_Arrange entries:`
    \ 002c 85..                 sta     zp:_Zp+1
    \ 002e 20....               jsr     msprintf
0141                    shortcutprint(TRUE, " \x1e",  "Crsr up");
    \ 0031 a9..                 lda     #.byte0 `_StringLiteral_Crsr up`
    \ 0033 85..                 sta     zp:_Zp+2
    \ 0035 a9..                 lda     #.byte1 `_StringLiteral_Crsr up`
    \ 0037 85..                 sta     zp:_Zp+3
    \ 0039 a9..                 lda     #.byte0 `_StringLiteral_[32,30]`
    \ 003b 85..                 sta     zp:_Zp
    \ 003d a9..                 lda     #.byte1 `_StringLiteral_[32,30]`
    \ 003f 85..                 sta     zp:_Zp+1
    \ 0041 a901                 lda     #1
    \ 0043 20....               jsr     shortcutprint
0142                    shortcutprint(TRUE, " v",  "Crsr down");
    \ 0046 a9..                 lda     #.byte0 `_StringLiteral_Crsr down`
    \ 0048 85..                 sta     zp:_Zp+2
    \ 004a a9..                 lda     #.byte1 `_StringLiteral_Crsr down`
    \ 004c 85..                 sta     zp:_Zp+3
    \ 004e a9..                 lda     #.byte0 `_StringLiteral_ v`
    \ 0050 85..                 sta     zp:_Zp
    \ 0052 a9..                 lda     #.byte1 `_StringLiteral_ v`
    \ 0054 85..                 sta     zp:_Zp+1
    \ 0056 a901                 lda     #1
    \ 0058 20....               jsr     shortcutprint
0143                    shortcutprint(TRUE, " Space",  "select");
    \ 005b a9..                 lda     #.byte0 _StringLiteral_select
    \ 005d 85..                 sta     zp:_Zp+2
    \ 005f a9..                 lda     #.byte1 _StringLiteral_select
    \ 0061 85..                 sta     zp:_Zp+3
    \ 0063 a9..                 lda     #.byte0 `_StringLiteral_ Space`
    \ 0065 85..                 sta     zp:_Zp
    \ 0067 a9..                 lda     #.byte1 `_StringLiteral_ Space`
    \ 0069 85..                 sta     zp:_Zp+1
    \ 006b a901                 lda     #1
    \ 006d 20....               jsr     shortcutprint
0144                    shortcutprint(TRUE, " STOP",  "abort");
    \ 0070 a9..                 lda     #.byte0 _StringLiteral_abort
    \ 0072 85..                 sta     zp:_Zp+2
    \ 0074 a9..                 lda     #.byte1 _StringLiteral_abort
    \ 0076 85..                 sta     zp:_Zp+3
    \ 0078 a9..                 lda     #.byte0 `_StringLiteral_ STOP`
    \ 007a 85..                 sta     zp:_Zp
    \ 007c a9..                 lda     #.byte1 `_StringLiteral_ STOP`
    \ 007e 85..                 sta     zp:_Zp+1
    \ 0080 a901                 lda     #1
    \ 0082 20....               jsr     shortcutprint
0145                    shortcutprint(TRUE, " RETURN",  "save");
    \ 0085 a9..                 lda     #.byte0 _StringLiteral_save
    \ 0087 85..                 sta     zp:_Zp+2
    \ 0089 a9..                 lda     #.byte1 _StringLiteral_save
    \ 008b 85..                 sta     zp:_Zp+3
    \ 008d a9..                 lda     #.byte0 `_StringLiteral_ RETURN`
    \ 008f 85..                 sta     zp:_Zp
    \ 0091 a9..                 lda     #.byte1 `_StringLiteral_ RETURN`
    \ 0093 85..                 sta     zp:_Zp+1
    \ 0095 a901                 lda     #1
    \ 0097 20....               jsr     shortcutprint
0146
0147                    getscreensize(&width, &height);
    \ 009a a5..                 lda     zp:_Vsp
    \ 009c 85..                 sta     zp:_Zp+2
    \ 009e a5..                 lda     zp:_Vsp+1
    \ 00a0 85..                 sta     zp:_Zp+3
    \ 00a2 a2..                 ldx     #_Zp
    \ 00a4 a901                 lda     #1
    \ 00a6 20....               jsr     _LoadVspEA
    \ 00a9 20....               jsr     getscreensize
0148                //    while (wherex() + 1 < width)  { cputc(' '); }
0149                    lfill(getscreenaddr() + (width * height) - width + wherex(),
    \ 00ac 20....               jsr     getscreenaddr
    \ 00af 4242a5..             ldq     zp:_Zp
    \ 00b3 424285..             stq     zp:_Zp+4
    \ 00b7 20....               jsr     `?L1994`
    \ 00ba 3002                 bmi     `?L883`
    \ 00bc a900                 lda     #0
    \ 00be          `?L883`:
    \ 00be 85..                 sta     zp:_Zp+2
    \ 00c0 85..                 sta     zp:_Zp+3
    \ 00c2 4242a5..             ldq     zp:_Zp
    \ 00c6 18                   clc
    \ 00c7 424265..             adcq    zp:_Zp+4
    \ 00cb 48                   pha
    \ 00cc da                   phx
    \ 00cd 5a                   phy
    \ 00ce db                   phz
    \ 00cf a001                 ldy     #1
    \ 00d1 b1..                 lda     (_Vsp),y
    \ 00d3 20....               jsr     `?L1967`
    \ 00d6 fb                   plz
    \ 00d7 7a                   ply
    \ 00d8 fa                   plx
    \ 00d9 68                   pla
    \ 00da 38                   sec
    \ 00db 4242e5..             sbcq    zp:_Zp
    \ 00df 48                   pha
    \ 00e0 da                   phx
    \ 00e1 5a                   phy
    \ 00e2 db                   phz
    \ 00e3 20....               jsr     wherex
    \ 00e6 20....               jsr     `?L1967`
    \ 00e9 fb                   plz
    \ 00ea 7a                   ply
    \ 00eb fa                   plx
    \ 00ec 68                   pla
    \ 00ed 20....               jsr     `?L2008`
    \ 00f0 20....               jsr     `?L1968`
    \ 00f3 85..                 sta     zp:_Zp+28
    \ 00f5 b002                 bcs     `?L887`
    \ 00f7 c6..                 dec     zp:_Zp+29
    \ 00f9          `?L887`:
    \ 00f9 20....               jsr     `?L1991`
    \ 00fc a920                 lda     #32
    \ 00fe 20....               jsr     lfill
0150                          ' ', width - wherex());
0151                    lfill(COLOR_RAM_BASE + + (width * height) - width + wherex(),
    \ 0101 20....               jsr     `?L1994`
    \ 0104 3002                 bmi     `?L891`
    \ 0106 a900                 lda     #0
    \ 0108          `?L891`:
    \ 0108 85..                 sta     zp:_Zp+2
    \ 010a 20....               jsr     `?L2044`
    \ 010d aa                   tax
    \ 010e a0f8                 ldy     #248
    \ 0110 a30f                 ldz     #15
    \ 0112 20....               jsr     `?L2008`
    \ 0115 424285..             stq     zp:_Zp
    \ 0119 20....               jsr     _SpillZP
    \ 011c 04..                 .byte   4,_Zp
    \ 011e a005                 ldy     #5
    \ 0120 b1..                 lda     (_Vsp),y
    \ 0122 20....               jsr     `?L1967`
    \ 0125 20....               jsr     _FillQ
    \ 0128 38                   sec
    \ 0129 4242e5..             sbcq    zp:_Zp
    \ 012d 424285..             stq     zp:_Zp+24
    \ 0131 20....               jsr     wherex
    \ 0134 20....               jsr     `?L1967`
    \ 0137 4242a5..             ldq     zp:_Zp
    \ 013b 18                   clc
    \ 013c 424265..             adcq    zp:_Zp+24
    \ 0140 20....               jsr     `?L1968`
    \ 0143 85..                 sta     zp:_Zp+28
    \ 0145 b002                 bcs     `?L895`
    \ 0147 c6..                 dec     zp:_Zp+29
    \ 0149          `?L895`:
    \ 0149 20....               jsr     `?L1991`
    \ 014c a903                 lda     #3
    \ 014e 20....               jsr     lfill
    \ 0151 4c....               jmp     `?L66`
    \ 0154          `?L65`:
0152                          COLOUR_CYAN, width - wherex());
0153                  } else {
0154                    // MODKEY, with 1 meaning the key was held during the event:
0155                    // Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0
0156                    // CAPS  NO    ALT   C=    CTRL  SHIFT SHIFT
0157                    // LOCK  SCROLL                  right left
0158                    if (mod & 20)  {  // Alt or ctrl are masked
    \ 0154 a914                 lda     #20
    \ 0156 24..                 bit     zp:_Zp+25
    \ 0158 f07e                 beq     `?L68`
0159                      shortcutprint(FALSE, " 1",  "Help  ");
    \ 015a a9..                 lda     #.byte0 `_StringLiteral_Help  `
    \ 015c 85..                 sta     zp:_Zp+2
    \ 015e a9..                 lda     #.byte1 `_StringLiteral_Help  `
    \ 0160 20....               jsr     `?L2009`
    \ 0163 a9..                 lda     #.byte1 `_StringLiteral_ 1`
    \ 0165 20....               jsr     `?L1934`
    \ 0168 20....               jsr     `?L2010`
0160                      shortcutprint(FALSE, " 2",  "Mount ");
    \ 016b a9..                 lda     #.byte1 `_StringLiteral_ 2`
    \ 016d 20....               jsr     `?L1934`
    \ 0170 20....               jsr     `?L2013`
0161                      shortcutprint(FALSE, " 3",  "View  ");
    \ 0173 a9..                 lda     #.byte1 `_StringLiteral_ 3`
    \ 0175 20....               jsr     `?L1934`
    \ 0178 20....               jsr     `?L1984`
0162                      shortcutprint(FALSE, " 4",  "Edit  ");
    \ 017b a9..                 lda     #.byte0 `_StringLiteral_ 4`
    \ 017d 85..                 sta     zp:_Zp
    \ 017f a9..                 lda     #.byte1 `_StringLiteral_ 4`
    \ 0181 20....               jsr     `?L1934`
    \ 0184 20....               jsr     shortcutprint
0163                      shortcutprint(FALSE, " 5",  "Copy  ");
    \ 0187 a9..                 lda     #.byte0 `_StringLiteral_Copy  `
    \ 0189 85..                 sta     zp:_Zp+2
    \ 018b a9..                 lda     #.byte1 `_StringLiteral_Copy  `
    \ 018d 85..                 sta     zp:_Zp+3
    \ 018f a9..                 lda     #.byte0 `_StringLiteral_ 5`
    \ 0191 85..                 sta     zp:_Zp
    \ 0193 a9..                 lda     #.byte1 `_StringLiteral_ 5`
    \ 0195 20....               jsr     `?L1934`
    \ 0198 20....               jsr     `?L1982`
0164                      shortcutprint(FALSE, " 6",  "Rename"); // "RenMov");
    \ 019b a9..                 lda     #.byte0 `_StringLiteral_ 6`
    \ 019d 85..                 sta     zp:_Zp
    \ 019f a9..                 lda     #.byte1 `_StringLiteral_ 6`
    \ 01a1 20....               jsr     `?L1934`
    \ 01a4 20....               jsr     `?L2017`
0165                      shortcutprint(FALSE, " 7",  "Mkdir ");
    \ 01a7 a9..                 lda     #.byte1 `_StringLiteral_ 7`
    \ 01a9 20....               jsr     `?L1934`
    \ 01ac 20....               jsr     `?L1980`
0166                      shortcutprint(FALSE, " 8",  "Delete");
    \ 01af a9..                 lda     #.byte0 `_StringLiteral_ 8`
    \ 01b1 85..                 sta     zp:_Zp
    \ 01b3 a9..                 lda     #.byte1 `_StringLiteral_ 8`
    \ 01b5 20....               jsr     `?L1934`
    \ 01b8 20....               jsr     shortcutprint
0167                      shortcutprint(FALSE, " 9",  "Menu  ");
    \ 01bb a9..                 lda     #.byte0 `_StringLiteral_Menu  `
    \ 01bd 85..                 sta     zp:_Zp+2
    \ 01bf a9..                 lda     #.byte1 `_StringLiteral_Menu  `
    \ 01c1 85..                 sta     zp:_Zp+3
    \ 01c3 a9..                 lda     #.byte0 `_StringLiteral_ 9`
    \ 01c5 85..                 sta     zp:_Zp
    \ 01c7 a9..                 lda     #.byte1 `_StringLiteral_ 9`
    \ 01c9 20....               jsr     `?L1934`
    \ 01cc 20....               jsr     shortcutprint
0168                      shortcutprint(FALSE, " 10", "Quit ");
    \ 01cf a9..                 lda     #.byte0 `_StringLiteral_Quit `
    \ 01d1 85..                 sta     zp:_Zp+2
    \ 01d3 a9..                 lda     #.byte1 `_StringLiteral_Quit `
    \ 01d5 4c....               jmp     `?L1818`
    \ 01d8          `?L68`:
0169                    } else if (((mod & 9) == 9) ||
0170                               ((mod & 10) == 10)) {  // MEGA key, C= and any of the shift keys
    \ 01d8 a909                 lda     #9
    \ 01da 25..                 and     zp:_Zp+25
    \ 01dc c909                 cmp     #9
    \ 01de f3bc01               lbeq    `?L73`
    \ 01e1 a90a                 lda     #10
    \ 01e3 25..                 and     zp:_Zp+25
    \ 01e5 c90a                 cmp     #10
    \ 01e7 f3b301               lbeq    `?L73`
0171                      shortcutprint(FALSE, " 1",  "      ");
0172                      shortcutprint(FALSE, " 2",  "      ");
0173                      shortcutprint(FALSE, " 3",  "      ");
0174                      shortcutprint(FALSE, " 4",  "      ");
0175                      shortcutprint(FALSE, " 5",  "      ");
0176                      shortcutprint(FALSE, " 6",  "      ");
0177                      shortcutprint(FALSE, " 7",  "      ");
0178                      shortcutprint(FALSE, " 8",  "      ");
0179                      shortcutprint(FALSE, " 9",  "      ");
0180                      shortcutprint(FALSE, " 10", "     ");
0181                    } else if (mod & 8)  {  // MEGA key, C=
    \ 01ea bf..03               bbs3    zp:_Zp+25,`?L2661`
    \ 01ed 4c....               jmp     `?L74`
    \ 01f0          `?L2661`:
0182                      shortcutprint(FALSE, " 1",  "      ");
    \ 01f0 a9..                 lda     #.byte0 `_StringLiteral_      `
    \ 01f2 85..                 sta     zp:_Zp+2
    \ 01f4 a9..                 lda     #.byte1 `_StringLiteral_      `
    \ 01f6 20....               jsr     `?L2009`
    \ 01f9 a9..                 lda     #.byte1 `_StringLiteral_ 1`
    \ 01fb 20....               jsr     `?L1934`
    \ 01fe 20....               jsr     `?L1917`
0183                      shortcutprint(FALSE, " 2",  "      ");
    \ 0201 20....               jsr     `?L2012`
    \ 0204 a9..                 lda     #.byte1 `_StringLiteral_ 2`
    \ 0206 20....               jsr     `?L1934`
    \ 0209 20....               jsr     shortcutprint
0184                      shortcutprint( TRUE, " 3",  "Freezr");
    \ 020c a9..                 lda     #.byte0 _StringLiteral_Freezr
    \ 020e 85..                 sta     zp:_Zp+2
    \ 0210 a9..                 lda     #.byte1 _StringLiteral_Freezr
    \ 0212 20....               jsr     `?L2015`
    \ 0215 a9..                 lda     #.byte1 `_StringLiteral_ 3`
    \ 0217 85..                 sta     zp:_Zp+1
    \ 0219 a901                 lda     #1
    \ 021b 20....               jsr     `?L1917`
0185                      shortcutprint(FALSE, " 4",  "      ");
    \ 021e a9..                 lda     #.byte0 `_StringLiteral_ 4`
    \ 0220 85..                 sta     zp:_Zp
    \ 0222 a9..                 lda     #.byte1 `_StringLiteral_ 4`
    \ 0224 20....               jsr     `?L1934`
    \ 0227 20....               jsr     shortcutprint
0186                      shortcutprint((midnight[side]->dirtrack == HEADERTRACK),
    \ 022a a5..                 lda     zp:_Zp+24
    \ 022c 20....               jsr     `?L1908`
    \ 022f a047                 ldy     #71
    \ 0231 b1..                 lda     (_Zp),y
    \ 0233 c928                 cmp     #40
    \ 0235 f004                 beq     `?L666`
    \ 0237 a900                 lda     #0
    \ 0239 8002                 bra     `?L1821`
    \ 023b a901     `?L666`:    lda     #1
    \ 023d          `?L1821`:
    \ 023d 85..                 sta     zp:_Zp+4
    \ 023f a9..                 lda     #.byte0 _StringLiteral_DskCpy
    \ 0241 85..                 sta     zp:_Zp+2
    \ 0243 a9..                 lda     #.byte1 _StringLiteral_DskCpy
    \ 0245 85..                 sta     zp:_Zp+3
    \ 0247 a9..                 lda     #.byte0 `_StringLiteral_ 5`
    \ 0249 85..                 sta     zp:_Zp
    \ 024b a9..                 lda     #.byte1 `_StringLiteral_ 5`
    \ 024d 85..                 sta     zp:_Zp+1
    \ 024f a5..                 lda     zp:_Zp+4
    \ 0251 20....               jsr     `?L1917`
0187                                           " 5",  "DskCpy");
0188                      shortcutprint(FALSE, " 6",  "      ");
    \ 0254 a9..                 lda     #.byte0 `_StringLiteral_ 6`
    \ 0256 85..                 sta     zp:_Zp
    \ 0258 a9..                 lda     #.byte1 `_StringLiteral_ 6`
    \ 025a 20....               jsr     `?L1934`
    \ 025d 20....               jsr     shortcutprint
0189                      shortcutprint((midnight[side]->dirtrack == HEADERTRACK),
    \ 0260 a5..                 lda     zp:_Zp+24
    \ 0262 20....               jsr     `?L1908`
    \ 0265 a047                 ldy     #71
    \ 0267 b1..                 lda     (_Zp),y
    \ 0269 c928                 cmp     #40
    \ 026b f004                 beq     `?L669`
    \ 026d a900                 lda     #0
    \ 026f 8002                 bra     `?L1815`
    \ 0271 a901     `?L669`:    lda     #1
    \ 0273          `?L1815`:
    \ 0273 85..                 sta     zp:_Zp+4
    \ 0275 a9..                 lda     #.byte0 _StringLiteral_Format
    \ 0277 85..                 sta     zp:_Zp+2
    \ 0279 a9..                 lda     #.byte1 _StringLiteral_Format
    \ 027b 20....               jsr     `?L2019`
    \ 027e a9..                 lda     #.byte1 `_StringLiteral_ 7`
    \ 0280 85..                 sta     zp:_Zp+1
    \ 0282 a5..                 lda     zp:_Zp+4
    \ 0284 20....               jsr     `?L1917`
0190                                           " 7",  "Format");
0191                      shortcutprint(FALSE, " 8",  "      ");
    \ 0287 a9..                 lda     #.byte0 `_StringLiteral_ 8`
    \ 0289 85..                 sta     zp:_Zp
    \ 028b a9..                 lda     #.byte1 `_StringLiteral_ 8`
    \ 028d 20....               jsr     `?L1934`
    \ 0290 20....               jsr     shortcutprint
0192                      shortcutprint( TRUE, " 9",  "ROMlst");
    \ 0293 a9..                 lda     #.byte0 _StringLiteral_ROMlst
    \ 0295 85..                 sta     zp:_Zp+2
    \ 0297 a9..                 lda     #.byte1 _StringLiteral_ROMlst
    \ 0299 8071                 bra     `?L1820`
    \ 029b          `?L74`:
0193                      shortcutprint(FALSE, " 10", "     ");
0194                    } else if (mod & 3)  {                   // either of the shift keys makes
    \ 029b a903                 lda     #3
    \ 029d 24..                 bit     zp:_Zp+25
    \ 029f f077                 beq     `?L77`
0195                      shortcutprint( TRUE, " 1",  "Mount "); // next even numbered F key
    \ 02a1 a9..                 lda     #.byte0 `_StringLiteral_Mount `
    \ 02a3 85..                 sta     zp:_Zp+2
    \ 02a5 a9..                 lda     #.byte1 `_StringLiteral_Mount `
    \ 02a7 20....               jsr     `?L2009`
    \ 02aa a9..                 lda     #.byte1 `_StringLiteral_ 1`
    \ 02ac 85..                 sta     zp:_Zp+1
    \ 02ae a901                 lda     #1
    \ 02b0 20....               jsr     `?L1917`
0196                      shortcutprint(FALSE, " 2",  "      ");
    \ 02b3 20....               jsr     `?L2012`
    \ 02b6 a9..                 lda     #.byte1 `_StringLiteral_ 2`
    \ 02b8 20....               jsr     `?L1934`
    \ 02bb 20....               jsr     `?L1984`
0197                      shortcutprint(FALSE, " 3",  "Edit  ");
    \ 02be 20....               jsr     `?L2016`
    \ 02c1 a9..                 lda     #.byte1 `_StringLiteral_ 3`
    \ 02c3 20....               jsr     `?L1934`
    \ 02c6 20....               jsr     `?L1917`
0198                      shortcutprint(FALSE, " 4",  "      ");
    \ 02c9 a9..                 lda     #.byte0 `_StringLiteral_ 4`
    \ 02cb 85..                 sta     zp:_Zp
    \ 02cd a9..                 lda     #.byte1 `_StringLiteral_ 4`
    \ 02cf 20....               jsr     `?L1934`
    \ 02d2 20....               jsr     `?L1982`
0199                      shortcutprint( TRUE, " 5",  "Rename"); // "RenMov");
    \ 02d5 a9..                 lda     #.byte0 `_StringLiteral_ 5`
    \ 02d7 85..                 sta     zp:_Zp
    \ 02d9 a9..                 lda     #.byte1 `_StringLiteral_ 5`
    \ 02db 85..                 sta     zp:_Zp+1
    \ 02dd a901                 lda     #1
    \ 02df 20....               jsr     `?L1917`
0200                      shortcutprint(FALSE, " 6",  "      ");
    \ 02e2 a9..                 lda     #.byte0 `_StringLiteral_ 6`
    \ 02e4 85..                 sta     zp:_Zp
    \ 02e6 a9..                 lda     #.byte1 `_StringLiteral_ 6`
    \ 02e8 20....               jsr     `?L1934`
    \ 02eb 20....               jsr     `?L1980`
0201                      shortcutprint( TRUE, " 7",  "Delete");
    \ 02ee 20....               jsr     `?L2020`
    \ 02f1 a9..                 lda     #.byte1 `_StringLiteral_ 7`
    \ 02f3 85..                 sta     zp:_Zp+1
    \ 02f5 a901                 lda     #1
    \ 02f7 20....               jsr     `?L1917`
0202                      shortcutprint(FALSE, " 8",  "      ");
    \ 02fa a9..                 lda     #.byte0 `_StringLiteral_ 8`
    \ 02fc 85..                 sta     zp:_Zp
    \ 02fe a9..                 lda     #.byte1 `_StringLiteral_ 8`
    \ 0300 20....               jsr     `?L1934`
    \ 0303 20....               jsr     shortcutprint
0203                      shortcutprint( TRUE, " 9",  "Quit  ");
    \ 0306 a9..                 lda     #.byte0 `_StringLiteral_Quit  `
    \ 0308 85..                 sta     zp:_Zp+2
    \ 030a a9..                 lda     #.byte1 `_StringLiteral_Quit  `
    \ 030c          `?L1820`:
    \ 030c 20....               jsr     `?L1999`
0204                      shortcutprint(FALSE, " 10", "     ");
    \ 030f a9..                 lda     #.byte0 `_StringLiteral_     `
    \ 0311 85..                 sta     zp:_Zp+2
    \ 0313 a9..                 lda     #.byte1 `_StringLiteral_     `
    \ 0315 4c....               jmp     `?L1818`
    \ 0318          `?L77`:
0205                    } else {
0206                      shortcutprint( TRUE, " 1",  "Help  ");
    \ 0318 a9..                 lda     #.byte0 `_StringLiteral_Help  `
    \ 031a 85..                 sta     zp:_Zp+2
    \ 031c a9..                 lda     #.byte1 `_StringLiteral_Help  `
    \ 031e 20....               jsr     `?L2009`
    \ 0321 a9..                 lda     #.byte1 `_StringLiteral_ 1`
    \ 0323 85..                 sta     zp:_Zp+1
    \ 0325 a901                 lda     #1
    \ 0327 20....               jsr     `?L2010`
0207                      shortcutprint( TRUE, " 2",  "Mount ");
    \ 032a a9..                 lda     #.byte1 `_StringLiteral_ 2`
    \ 032c 85..                 sta     zp:_Zp+1
    \ 032e a901                 lda     #1
    \ 0330 20....               jsr     `?L2013`
0208                      shortcutprint(FALSE, " 3",  "View  ");
    \ 0333 a9..                 lda     #.byte1 `_StringLiteral_ 3`
    \ 0335 20....               jsr     `?L1934`
    \ 0338 20....               jsr     `?L1984`
0209                      shortcutprint(FALSE, " 4",  "Edit  ");
    \ 033b a9..                 lda     #.byte0 `_StringLiteral_ 4`
    \ 033d 85..                 sta     zp:_Zp
    \ 033f a9..                 lda     #.byte1 `_StringLiteral_ 4`
    \ 0341 20....               jsr     `?L1934`
    \ 0344 20....               jsr     shortcutprint
0210                      shortcutprint( TRUE, " 5",  "Copy  ");
    \ 0347 a9..                 lda     #.byte0 `_StringLiteral_Copy  `
    \ 0349 85..                 sta     zp:_Zp+2
    \ 034b a9..                 lda     #.byte1 `_StringLiteral_Copy  `
    \ 034d 85..                 sta     zp:_Zp+3
    \ 034f a9..                 lda     #.byte0 `_StringLiteral_ 5`
    \ 0351 85..                 sta     zp:_Zp
    \ 0353 a9..                 lda     #.byte1 `_StringLiteral_ 5`
    \ 0355 85..                 sta     zp:_Zp+1
    \ 0357 a901                 lda     #1
    \ 0359 20....               jsr     `?L1982`
0211                      shortcutprint( TRUE, " 6",  "Rename"); // "RenMov");
    \ 035c a9..                 lda     #.byte0 `_StringLiteral_ 6`
    \ 035e 85..                 sta     zp:_Zp
    \ 0360 a9..                 lda     #.byte1 `_StringLiteral_ 6`
    \ 0362 85..                 sta     zp:_Zp+1
    \ 0364 a901                 lda     #1
    \ 0366 20....               jsr     `?L2017`
0212                      shortcutprint( TRUE, " 7",  "Mkdir ");
    \ 0369 a9..                 lda     #.byte1 `_StringLiteral_ 7`
    \ 036b 85..                 sta     zp:_Zp+1
    \ 036d a901                 lda     #1
    \ 036f 20....               jsr     `?L1980`
0213                      shortcutprint( TRUE, " 8",  "Delete");
    \ 0372 a9..                 lda     #.byte0 `_StringLiteral_ 8`
    \ 0374 85..                 sta     zp:_Zp
    \ 0376 a9..                 lda     #.byte1 `_StringLiteral_ 8`
    \ 0378 85..                 sta     zp:_Zp+1
    \ 037a a901                 lda     #1
    \ 037c 20....               jsr     shortcutprint
0214                      shortcutprint( TRUE, " 9",  "Menu  ");
    \ 037f a9..                 lda     #.byte0 `_StringLiteral_Menu  `
    \ 0381 85..                 sta     zp:_Zp+2
    \ 0383 a9..                 lda     #.byte1 `_StringLiteral_Menu  `
    \ 0385 20....               jsr     `?L1999`
0215                      shortcutprint( TRUE, " 10", "Quit ");
    \ 0388 a9..                 lda     #.byte0 `_StringLiteral_Quit `
    \ 038a 85..                 sta     zp:_Zp+2
    \ 038c a9..                 lda     #.byte1 `_StringLiteral_Quit `
    \ 038e 85..                 sta     zp:_Zp+3
    \ 0390 a9..                 lda     #.byte0 `_StringLiteral_ 10`
    \ 0392 85..                 sta     zp:_Zp
    \ 0394 a9..                 lda     #.byte1 `_StringLiteral_ 10`
    \ 0396 85..                 sta     zp:_Zp+1
    \ 0398 a901                 lda     #1
    \ 039a 807f                 bra     `?L1817`
    \ 039c          `?L73`:
    \ 039c a9..                 lda     #.byte0 `_StringLiteral_      `
    \ 039e 85..                 sta     zp:_Zp+2
    \ 03a0 a9..                 lda     #.byte1 `_StringLiteral_      `
    \ 03a2 20....               jsr     `?L2009`
    \ 03a5 a9..                 lda     #.byte1 `_StringLiteral_ 1`
    \ 03a7 20....               jsr     `?L1934`
    \ 03aa 20....               jsr     `?L1917`
    \ 03ad 20....               jsr     `?L2012`
    \ 03b0 a9..                 lda     #.byte1 `_StringLiteral_ 2`
    \ 03b2 20....               jsr     `?L1934`
    \ 03b5 20....               jsr     `?L1917`
    \ 03b8 20....               jsr     `?L2016`
    \ 03bb a9..                 lda     #.byte1 `_StringLiteral_ 3`
    \ 03bd 20....               jsr     `?L1934`
    \ 03c0 20....               jsr     `?L1917`
    \ 03c3 a9..                 lda     #.byte0 `_StringLiteral_ 4`
    \ 03c5 85..                 sta     zp:_Zp
    \ 03c7 a9..                 lda     #.byte1 `_StringLiteral_ 4`
    \ 03c9 20....               jsr     `?L1934`
    \ 03cc 20....               jsr     `?L1917`
    \ 03cf a9..                 lda     #.byte0 `_StringLiteral_ 5`
    \ 03d1 85..                 sta     zp:_Zp
    \ 03d3 a9..                 lda     #.byte1 `_StringLiteral_ 5`
    \ 03d5 20....               jsr     `?L1934`
    \ 03d8 20....               jsr     `?L1917`
    \ 03db a9..                 lda     #.byte0 `_StringLiteral_ 6`
    \ 03dd 85..                 sta     zp:_Zp
    \ 03df a9..                 lda     #.byte1 `_StringLiteral_ 6`
    \ 03e1 20....               jsr     `?L1934`
    \ 03e4 20....               jsr     `?L1917`
    \ 03e7 20....               jsr     `?L2020`
    \ 03ea a9..                 lda     #.byte1 `_StringLiteral_ 7`
    \ 03ec 20....               jsr     `?L1934`
    \ 03ef 20....               jsr     `?L1917`
    \ 03f2 a9..                 lda     #.byte0 `_StringLiteral_ 8`
    \ 03f4 85..                 sta     zp:_Zp
    \ 03f6 a9..                 lda     #.byte1 `_StringLiteral_ 8`
    \ 03f8 20....               jsr     `?L1934`
    \ 03fb 20....               jsr     `?L1917`
    \ 03fe a9..                 lda     #.byte0 `_StringLiteral_ 9`
    \ 0400 85..                 sta     zp:_Zp
    \ 0402 a9..                 lda     #.byte1 `_StringLiteral_ 9`
    \ 0404 20....               jsr     `?L1934`
    \ 0407 20....               jsr     shortcutprint
    \ 040a a9..                 lda     #.byte0 `_StringLiteral_     `
    \ 040c 85..                 sta     zp:_Zp+2
    \ 040e a9..                 lda     #.byte1 `_StringLiteral_     `
    \ 0410          `?L1818`:
    \ 0410 85..                 sta     zp:_Zp+3
    \ 0412 a9..                 lda     #.byte0 `_StringLiteral_ 10`
    \ 0414 85..                 sta     zp:_Zp
    \ 0416 a9..                 lda     #.byte1 `_StringLiteral_ 10`
    \ 0418 20....               jsr     `?L1934`
    \ 041b          `?L1817`:
    \ 041b 20....               jsr     shortcutprint
    \ 041e          `?L66`:
0216                    }
0217                  }
0218
0219                  textcolor(COLOUR_CYAN);
    \ 041e a903                 lda     #3
    \ 0420 20....               jsr     textcolor
0220                }
    \ 0423 a202                 ldx     #2
    \ 0425 a005                 ldy     #5
    \ 0427 4c....               jmp     _DeallocStackRestore
0221
0222                void optionstring(unsigned char optionbyte, unsigned char optionbitmask,
0223                                   char* str, unsigned char tabpos, unsigned char pos)  {
    \ 0000                      .section code,text
    \ 0000                      .public optionstring
    \ 0000          optionstring:
    \ 0000 85..                 sta     zp:_Zp+5
0224                  unsigned char i;
0225                  unsigned char j;
0226
0227                  i = 0;
    \ 0002 a900                 lda     #0
    \ 0004 85..                 sta     zp:_Zp+6
0228                  if (optionbyte & optionbitmask)  s[i++] = '*'; // 81; // 113; // filled o
    \ 0006 a5..                 lda     zp:_Zp
    \ 0008 25..                 and     zp:_Zp+5
    \ 000a f009                 beq     `?L83`
    \ 000c a5..                 lda     zp:_Zp+6
    \ 000e e6..                 inc     zp:_Zp+6
    \ 0010 aa                   tax
    \ 0011 a92a                 lda     #42
    \ 0013 8007                 bra     `?L1824`
    \ 0015          `?L83`:
0229                  else                             s[i++] = 'o'; // 87; // 119; // empty o
    \ 0015 a5..                 lda     zp:_Zp+6
    \ 0017 e6..                 inc     zp:_Zp+6
    \ 0019 aa                   tax
    \ 001a a96f                 lda     #111
    \ 001c          `?L1824`:
    \ 001c 9d....               sta     s,x
0230                  s[i++] = ' ';
    \ 001f a5..                 lda     zp:_Zp+6
    \ 0021 e6..                 inc     zp:_Zp+6
0231                  if (tabpos == pos)  s[i++] = '>';
    \ 0023 20....               jsr     `?L1951`
    \ 0026 ab....               ldz     _Zp+4
    \ 0029 d4..                 cpz     zp:_Zp+1
    \ 002b d009                 bne     `?L86`
    \ 002d a5..                 lda     zp:_Zp+6
    \ 002f e6..                 inc     zp:_Zp+6
    \ 0031 aa                   tax
    \ 0032 a93e                 lda     #62
    \ 0034 8007                 bra     `?L1823`
    \ 0036          `?L86`:
0232                  else                s[i++] = ' ';
    \ 0036 a5..                 lda     zp:_Zp+6
    \ 0038 e6..                 inc     zp:_Zp+6
    \ 003a aa                   tax
    \ 003b a920                 lda     #32
    \ 003d          `?L1823`:
    \ 003d 9d....               sta     s,x
0233                  s[i++] = ' ';
    \ 0040 a5..                 lda     zp:_Zp+6
    \ 0042 e6..                 inc     zp:_Zp+6
0234                  j = 0;
    \ 0044 20....               jsr     `?L1951`
    \ 0047 a900                 lda     #0
    \ 0049 85..                 sta     zp:_Zp
    \ 004b          `?L89`:
0235                  while (str[j] != 0 && j < DOSFILENAMEANDTYPELEN)  {
    \ 004b ab....               ldz     _Zp
    \ 004e b2..                 lda     (_Zp+2),z
    \ 0050 f02a                 beq     `?L93`
    \ 0052 ab....               ldz     _Zp
    \ 0055 c228                 cpz     #40
    \ 0057 b023                 bcs     `?L93`
0236                    s[i++] = str[j];
    \ 0059 a5..                 lda     zp:_Zp+2
    \ 005b 85..                 sta     zp:_Zp+8
    \ 005d a5..                 lda     zp:_Zp+3
    \ 005f 85..                 sta     zp:_Zp+9
    \ 0061 18                   clc
    \ 0062 a5..                 lda     zp:_Zp+8
    \ 0064 65..                 adc     zp:_Zp
    \ 0066 85..                 sta     zp:_Zp+8
    \ 0068 9002                 bcc     `?L949`
    \ 006a e6..                 inc     zp:_Zp+9
    \ 006c          `?L949`:
    \ 006c a5..                 lda     zp:_Zp+6
    \ 006e e6..                 inc     zp:_Zp+6
    \ 0070 aa                   tax
    \ 0071 a300                 ldz     #0
    \ 0073 b2..                 lda     (_Zp+8),z
    \ 0075 9d....               sta     s,x
0237                    j++;
    \ 0078 e6..                 inc     zp:_Zp
    \ 007a 80cf                 bra     `?L89`
    \ 007c          `?L93`:
0238                  }
0239                  for ( ; j < DOSFILENAMELEN; j++)  s[i++] = ' ';
    \ 007c ab....               ldz     _Zp
    \ 007f c210                 cpz     #16
    \ 0081 9039                 bcc     `?L92`
0240                  s[i++] = ' ';
    \ 0083 a5..                 lda     zp:_Zp+6
    \ 0085 e6..                 inc     zp:_Zp+6
0241                  if (tabpos == pos)  s[i++] = '<';
    \ 0087 20....               jsr     `?L1951`
    \ 008a ab....               ldz     _Zp+4
    \ 008d d4..                 cpz     zp:_Zp+1
    \ 008f d009                 bne     `?L96`
    \ 0091 a5..                 lda     zp:_Zp+6
    \ 0093 e6..                 inc     zp:_Zp+6
    \ 0095 aa                   tax
    \ 0096 a93c                 lda     #60
    \ 0098 8007                 bra     `?L1822`
    \ 009a          `?L96`:
0242                  else                s[i++] = ' ';
    \ 009a a5..                 lda     zp:_Zp+6
    \ 009c e6..                 inc     zp:_Zp+6
    \ 009e aa                   tax
    \ 009f a920                 lda     #32
    \ 00a1          `?L1822`:
    \ 00a1 9d....               sta     s,x
0243                  
0244                  s[i++] = 0;
    \ 00a4 a5..                 lda     zp:_Zp+6
    \ 00a6 aa                   tax
    \ 00a7 a900                 lda     #0
    \ 00a9 9d....               sta     s,x
0245                  mcputsxy(12, 6 + pos, (char*) s);
    \ 00ac 20....               jsr     `?L2074`
    \ 00af a906                 lda     #6
    \ 00b1 18                   clc
    \ 00b2 65..                 adc     zp:_Zp+4
    \ 00b4 85..                 sta     zp:_Zp
    \ 00b6 a90c                 lda     #12
    \ 00b8 20....               jsr     mcputsxy
0246                }
    \ 00bb 60                   rts
    \ 00bc          `?L92`:
    \ 00bc a5..                 lda     zp:_Zp+6
    \ 00be e6..                 inc     zp:_Zp+6
    \ 00c0 20....               jsr     `?L1951`
    \ 00c3 e6..                 inc     zp:_Zp
    \ 00c5 80b5                 bra     `?L93`
0247
0248                unsigned char setupbox()  {
    \ 0000                      .section code,text
    \ 0000                      .public setupbox
    \ 0000 a200     setupbox:   ldx     #0
    \ 0002 a003                 ldy     #3
    \ 0004 20....               jsr     _AllocStackSave
0249                  unsigned char clear = 1;
    \ 0007 a901                 lda     #1
    \ 0009 85..                 sta     zp:_Zp+26
0250                  unsigned char shadow = 1;
    \ 000b 85..                 sta     zp:_Zp+25
0251                  char c;
0252                  unsigned char tabpos = 0;
    \ 000d a900                 lda     #0
    \ 000f 85..                 sta     zp:_Zp+24
0253                  unsigned char bitshifter = 1;
    \ 0011 a901                 lda     #1
    \ 0013 85..                 sta     zp:_Zp+27
    \ 0015          `?L104`:
0254
0255                  // Because of the additional messagebox we need to redraw all:
0256                  while(1)  {
0257                    mcbox(10, 4, 70, 20, COLOUR_CYAN, BOX_STYLE_INNER, clear, shadow);
    \ 0015 a5..                 lda     zp:_Zp+25
    \ 0017 85..                 sta     zp:_Zp+6
    \ 0019 a5..                 lda     zp:_Zp+26
    \ 001b 20....               jsr     `?L1930`
0258                  
0259                    revers(1);
0260                    mcputsxy(14, 4, " Midnight Mega ");
0261                    mcputsxy(31, 4, " Setup ");
    \ 001e a9..                 lda     #.byte0 `_StringLiteral_ Setup `
    \ 0020 85..                 sta     zp:_Zp+2
    \ 0022 a9..                 lda     #.byte1 `_StringLiteral_ Setup `
    \ 0024 85..                 sta     zp:_Zp+3
    \ 0026 a904                 lda     #4
    \ 0028 85..                 sta     zp:_Zp
    \ 002a a91f                 lda     #31
    \ 002c 20....               jsr     `?L1956`
0262                    mcputsxy(40, 4, " The MEGA65 file commander ");
    \ 002f a928                 lda     #40
    \ 0031 20....               jsr     `?L1972`
0263                    revers(0);
0264
0265                    mcputsxy(23, 16, "Use the spacebar to select/unselect.");
    \ 0034 a9..                 lda     #.byte0 `_StringLiteral_Use the spacebar to select/unselect.`
    \ 0036 85..                 sta     zp:_Zp+2
    \ 0038 a9..                 lda     #.byte1 `_StringLiteral_Use the spacebar to select/unselect.`
    \ 003a 85..                 sta     zp:_Zp+3
    \ 003c a910                 lda     #16
    \ 003e 85..                 sta     zp:_Zp
    \ 0040 a917                 lda     #23
    \ 0042 20....               jsr     mcputsxy
0266                    revers(1);
    \ 0045 a901                 lda     #1
    \ 0047 20....               jsr     revers
0267                    mcputsxy(36, 18, "   OK   ");
    \ 004a 20....               jsr     `?L1971`
0268                //  mcputsxy(12, 18, "  Save  ");
0269                //  mcputsxy(60, 18, " Cancel ");
0270                    revers(0);
0271
0272                //  while(1)  {
0273                    if (tabpos > OPTIONMAX)  {
    \ 004d a304                 ldz     #4
    \ 004f d4..                 cpz     zp:_Zp+24
    \ 0051 b003                 bcs     `?L106`
0274                      tabpos = OPTIONMAX;
    \ 0053 6b                   tza
    \ 0054 85..                 sta     zp:_Zp+24
    \ 0056          `?L106`:
0275                    }         // byte           bit          2 * DOSFILENAMEANDTYPELEN  pos
0276                    optionstring(option.option, OPTIONshowDEL, "show DEL files", tabpos, 0);
    \ 0056 a900                 lda     #0
    \ 0058 85..                 sta     zp:_Zp+4
    \ 005a a9..                 lda     #.byte0 `_StringLiteral_show DEL files`
    \ 005c 85..                 sta     zp:_Zp+2
    \ 005e a9..                 lda     #.byte1 `_StringLiteral_show DEL files`
    \ 0060 85..                 sta     zp:_Zp+3
    \ 0062 20....               jsr     `?L1950`
    \ 0065 a901                 lda     #1
    \ 0067 20....               jsr     `?L1966`
0277                    optionstring(option.option, OPTIONshowALO, "copy allocated BAM blocks only", tabpos, 1);
    \ 006a a901                 lda     #1
    \ 006c 85..                 sta     zp:_Zp+4
    \ 006e a9..                 lda     #.byte0 `_StringLiteral_copy allocated BAM blocks only`
    \ 0070 85..                 sta     zp:_Zp+2
    \ 0072 a9..                 lda     #.byte1 `_StringLiteral_copy allocated BAM blocks only`
    \ 0074 85..                 sta     zp:_Zp+3
    \ 0076 20....               jsr     `?L1950`
    \ 0079 a902                 lda     #2
    \ 007b 20....               jsr     `?L1966`
0278                    optionstring(option.option, OPTIONshowDRV, "show drive access overlay", tabpos, 2);
    \ 007e a902                 lda     #2
    \ 0080 85..                 sta     zp:_Zp+4
    \ 0082 a9..                 lda     #.byte0 `_StringLiteral_show drive access overlay`
    \ 0084 85..                 sta     zp:_Zp+2
    \ 0086 a9..                 lda     #.byte1 `_StringLiteral_show drive access overlay`
    \ 0088 85..                 sta     zp:_Zp+3
    \ 008a 20....               jsr     `?L1950`
    \ 008d a904                 lda     #4
    \ 008f 20....               jsr     `?L1966`
0279                    optionstring(option.option, OPTIONshow4, "goes nowhere and does nothing", tabpos, 3);
    \ 0092 a903                 lda     #3
    \ 0094 20....               jsr     `?L2045`
    \ 0097 20....               jsr     `?L1950`
    \ 009a a908                 lda     #8
    \ 009c 20....               jsr     `?L1966`
0280                    optionstring(option.option, OPTIONshow5, "goes nowhere and does nothing", tabpos, 4);
    \ 009f a904                 lda     #4
    \ 00a1 20....               jsr     `?L2045`
    \ 00a4 20....               jsr     `?L1950`
    \ 00a7 a910                 lda     #16
    \ 00a9 20....               jsr     `?L1966`
0281                    c = cgetc();
    \ 00ac 20....               jsr     cgetc
    \ 00af 85..                 sta     zp:_Zp
0282                    switch (c) {
    \ 00b1 a9..                 lda     #.byte0 `?L672`
    \ 00b3 85..                 sta     zp:_Zp+2
    \ 00b5 a9..                 lda     #.byte1 `?L672`
    \ 00b7 85..                 sta     zp:_Zp+3
    \ 00b9 20....               jsr     `?L1993`
    \ 00bc          `?L117`:
0283                      case 0x91: // Crsrup
0284                      case 0x9d: // Left
0285                        if (tabpos > 0)  tabpos--;
    \ 00bc a5..                 lda     zp:_Zp+24
    \ 00be f355ff               lbeq    `?L104`
    \ 00c1 c6..                 dec     zp:_Zp+24
    \ 00c3 4c....               jmp     `?L104`
    \ 00c6          `?L114`:
0286                      break;
0287                      case 0x11: // Crsrdown
0288                      case 0x1d: // Right
0289                        tabpos++;
0290                      break;
0291
0292                      case ' ':
0293                        option.option ^= (bitshifter << tabpos);
    \ 00c6 a5..                 lda     zp:_Zp+27
    \ 00c8 85..                 sta     zp:_Zp
    \ 00ca a6..                 ldx     zp:_Zp+24
    \ 00cc f005                 beq     `?L970`
    \ 00ce          `?L971`:
    \ 00ce 06..                 asl     zp:_Zp
    \ 00d0 ca                   dex
    \ 00d1 d0fb                 bne     `?L971`
    \ 00d3          `?L970`:
    \ 00d3 a5..                 lda     zp:_Zp
    \ 00d5 4d....               eor     option
    \ 00d8 8d....               sta     option
0294                //        valuesbox(0, "opt", "opt=", option.option,
0295                //                        "tabpos=", tabpos);
0296                      break;
    \ 00db 4c....               jmp     `?L104`
    \ 00de          `?L115`:
    \ 00de e6..                 inc     zp:_Zp+24
    \ 00e0 4c....               jmp     `?L104`
    \ 00e3          `?L113`:
0297
0298                      case 13: // RETURN
0299                        return TRUE;
    \ 00e3 a901                 lda     #1
0300                      break;
0301
0302                      case 3:  // STOP
0303                      case 27: // Esc
0304                        sidbong();
0305                        messagebox(MBOXNOCANCEL, "Currently this option dialog cannot",
0306                                                 "be quit unsaved. So use RETURN to",
0307                                                 "accept.", 0);
0308                //        return FALSE;
0309                      break;
0310
0311                      default:
0312                        sidbong();
0313                //        mh4printf("val=", c);
0314                //        cputc(' ');
0315                //        usleep(400000); // microseconds
0316                      break;
0317                    }
0318                  }
0319                }
    \ 00e5 a003                 ldy     #3
    \ 00e7 4c....               jmp     _RestoreRegisters
    \ 00ea          `?L111`:
    \ 00ea 20....               jsr     sidbong
    \ 00ed 20....               jsr     `?L1909`
    \ 00f0 a9..                 lda     #.byte0 `_StringLiteral_accept.`
    \ 00f2 85..                 sta     zp:_Zp+4
    \ 00f4 a9..                 lda     #.byte1 `_StringLiteral_accept.`
    \ 00f6 85..                 sta     zp:_Zp+5
    \ 00f8 a9..                 lda     #.byte0 `_StringLiteral_be quit unsaved. So use RETURN to`
    \ 00fa 85..                 sta     zp:_Zp+2
    \ 00fc a9..                 lda     #.byte1 `_StringLiteral_be quit unsaved. So use RETURN to`
    \ 00fe 85..                 sta     zp:_Zp+3
    \ 0100 a9..                 lda     #.byte0 `_StringLiteral_Currently this option dialog cannot`
    \ 0102 85..                 sta     zp:_Zp
    \ 0104 a9..                 lda     #.byte1 `_StringLiteral_Currently this option dialog cannot`
    \ 0106 85..                 sta     zp:_Zp+1
    \ 0108 a904                 lda     #4
    \ 010a 20....               jsr     `?L1915`
    \ 010d 4c....               jmp     `?L104`
    \ 0110          `?L110`:
    \ 0110 20....               jsr     sidbong
    \ 0113 4c....               jmp     `?L104`
0320
0321                unsigned char menubox(unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public menubox
    \ 0000 a200     menubox:    ldx     #0
    \ 0002 a006                 ldy     #6
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+30
0322                  unsigned char clear = 1;
    \ 0009 a901                 lda     #1
    \ 000b 85..                 sta     zp:_Zp+25
0323                  unsigned char shadow = 1;
    \ 000d 85..                 sta     zp:_Zp+24
0324                  char c;
0325                  unsigned char pos = 0;
    \ 000f a900                 lda     #0
    \ 0011 85..                 sta     zp:_Zp+26
0326                  unsigned char ret = FALSE;
    \ 0013 85..                 sta     zp:_Zp+28
0327                  unsigned char i;
0328                  unsigned char drawn = FALSE;
    \ 0015 85..                 sta     zp:_Zp+29
    \ 0017          `?L134`:
0329
0330                  // Because of the additional messagebox we need to redraw all:
0331                  while(1)  {
0332                    if (!drawn)  {
    \ 0017 a5..                 lda     zp:_Zp+29
    \ 0019 d02f                 bne     `?L136`
0333                      mcbox(10, 4, 70, 20, COLOUR_CYAN, BOX_STYLE_INNER, clear, shadow);
    \ 001b a5..                 lda     zp:_Zp+24
    \ 001d 85..                 sta     zp:_Zp+6
    \ 001f a5..                 lda     zp:_Zp+25
    \ 0021 20....               jsr     `?L1930`
0334                    
0335                      revers(1);
0336                      mcputsxy(14, 4, " Midnight Mega ");
0337                      mcputsxy(31, 4, " Menu ");
    \ 0024 a9..                 lda     #.byte0 `_StringLiteral_ Menu `
    \ 0026 85..                 sta     zp:_Zp+2
    \ 0028 a9..                 lda     #.byte1 `_StringLiteral_ Menu `
    \ 002a 85..                 sta     zp:_Zp+3
    \ 002c a904                 lda     #4
    \ 002e 85..                 sta     zp:_Zp
    \ 0030 a91f                 lda     #31
    \ 0032 20....               jsr     `?L1956`
0338                      mcputsxy(40, 4, " The MEGA65 file commander ");
    \ 0035 a928                 lda     #40
    \ 0037 20....               jsr     mcputsxy
0339                      mcputsxy(36, 18, "   OK   ");
    \ 003a 20....               jsr     `?L1971`
0340                  //  mcputsxy(12, 18, "  Save  ");
0341                  //  mcputsxy(60, 18, " Cancel ");
0342                      revers(0);
0343                      text(MENUTITLE, TRUE);
    \ 003d a901                 lda     #1
    \ 003f 85..                 sta     zp:_Zp
    \ 0041 a95d                 lda     #93
    \ 0043 20....               jsr     text
0344                //      text(MENUDIRSORT, FALSE);
0345                //      text(MENUSETUP, FALSE);
0346                      drawn = TRUE;
    \ 0046 a901                 lda     #1
    \ 0048 85..                 sta     zp:_Zp+29
    \ 004a          `?L136`:
0347                    }
0348
0349                    if (pos >= MENUMAX)  {
    \ 004a ab....               ldz     _Zp+26
    \ 004d c202                 cpz     #2
    \ 004f 9004                 bcc     `?L139`
0350                      pos = MENUMAX - 1;
    \ 0051 a901                 lda     #1
    \ 0053 85..                 sta     zp:_Zp+26
    \ 0055          `?L139`:
0351                    }
0352                    for (i = 0; i < MENUMAX; i++)  {
    \ 0055 a900                 lda     #0
    \ 0057 85..                 sta     zp:_Zp+27
    \ 0059          `?L142`:
    \ 0059 ab....               ldz     _Zp+27
    \ 005c c202                 cpz     #2
    \ 005e 938300               lbcc    `?L141`
0353                      if (pos == i)  cputcxy(12, 8 + i, '>');
0354                      else           cputcxy(12, 8 + i, ' ');
0355                    }
0356
0357                    c = cgetc();
    \ 0061 20....               jsr     cgetc
    \ 0064 85..                 sta     zp:_Zp
0358                    switch (c) {
    \ 0066 a9..                 lda     #.byte0 `?L673`
    \ 0068 85..                 sta     zp:_Zp+2
    \ 006a a9..                 lda     #.byte1 `?L673`
    \ 006c 85..                 sta     zp:_Zp+3
    \ 006e 20....               jsr     `?L1993`
    \ 0071          `?L156`:
0359                      case 0x91: // Crsrup
0360                      case 0x9d: // Left
0361                        if (pos > 0)  pos--;
    \ 0071 a5..                 lda     zp:_Zp+26
    \ 0073 f0a2                 beq     `?L134`
    \ 0075 c6..                 dec     zp:_Zp+26
    \ 0077 809e                 bra     `?L134`
    \ 0079          `?L154`:
0362                      break;
0363                      case 0x11: // Crsrdown
0364                      case 0x1d: // Right
0365                        pos++;
    \ 0079 e6..                 inc     zp:_Zp+26
0366                      break;
    \ 007b 809a                 bra     `?L134`
    \ 007d          `?L153`:
0367
0368                      case 13: // RETURN
0369                        switch (pos) {
    \ 007d a5..                 lda     zp:_Zp+26
    \ 007f 85..                 sta     zp:_Zp
    \ 0081 f007                 beq     `?L166`
0370                          case 0:  // dirsort
0371                            if (midnight[side]->flags & MIDNIGHTFLAGismounted)  {
0372                              midnight[side]->flags |= MIDNIGHTFLAGdirsortactive;
0373                              Deselect(side);
0374                              return FALSE;
0375                            } else {
0376                              messagebox(MBOXNOCANCEL, "Directory entry sorting,",
0377                                         "on storage card not possible",
0378                                         " ", 0);
0379                              drawn = FALSE;
0380                            }
0381                          break;
0382                          default:
0383                            ret = setupbox();
    \ 0083 20....               jsr     setupbox
    \ 0086 85..                 sta     zp:_Zp+28
0384                            drawn = FALSE;
0385                          break;
    \ 0088 803f                 bra     `?L1825`
    \ 008a          `?L166`:
    \ 008a a5..                 lda     zp:_Zp+30
    \ 008c 20....               jsr     `?L1908`
    \ 008f 20....               jsr     `?L1942`
    \ 0092 f01a                 beq     `?L167`
    \ 0094 a5..                 lda     zp:_Zp+30
    \ 0096 0a                   asl     a
    \ 0097 aa                   tax
    \ 0098 18                   clc
    \ 0099 6b                   tza
    \ 009a 20....               jsr     `?L1914`
    \ 009d a902                 lda     #2
    \ 009f a300                 ldz     #0
    \ 00a1 12..                 ora     (_Zp),z
    \ 00a3 92..                 sta     (_Zp),z
    \ 00a5 a5..                 lda     zp:_Zp+30
    \ 00a7 20....               jsr     Deselect
    \ 00aa a900                 lda     #0
    \ 00ac 802a                 bra     `?L131`
    \ 00ae          `?L167`:
    \ 00ae 20....               jsr     `?L1909`
    \ 00b1 20....               jsr     `?L1922`
    \ 00b4 a9..                 lda     #.byte0 `_StringLiteral_on storage card not possible`
    \ 00b6 85..                 sta     zp:_Zp+2
    \ 00b8 a9..                 lda     #.byte1 `_StringLiteral_on storage card not possible`
    \ 00ba 85..                 sta     zp:_Zp+3
    \ 00bc a9..                 lda     #.byte0 `_StringLiteral_Directory entry sorting,`
    \ 00be 85..                 sta     zp:_Zp
    \ 00c0 a9..                 lda     #.byte1 `_StringLiteral_Directory entry sorting,`
    \ 00c2 85..                 sta     zp:_Zp+1
    \ 00c4 a904                 lda     #4
    \ 00c6 20....               jsr     `?L1915`
    \ 00c9 a900     `?L1825`:   lda     #0
    \ 00cb 85..                 sta     zp:_Zp+29
0386                        }
0387                        if (ret)  return TRUE;
    \ 00cd a5..                 lda     zp:_Zp+28
    \ 00cf f346ff               lbeq    `?L134`
    \ 00d2 a901                 lda     #1
    \ 00d4 8002                 bra     `?L131`
    \ 00d6          `?L151`:
0388                      break;
0389
0390                      case 3:  // STOP
0391                      case 27: // Esc
0392                        return FALSE;
    \ 00d6 a900                 lda     #0
    \ 00d8          `?L131`:
0393                      break;
0394
0395                      default:
0396                        sidbong();
0397                //        mh4printf("val=", c);
0398                //        cputc(' ');
0399                //        usleep(400000); // microseconds
0400                      break;
0401                    }
0402                  }
0403                }
    \ 00d8 a006                 ldy     #6
    \ 00da 4c....               jmp     _RestoreRegisters
    \ 00dd          `?L150`:
    \ 00dd 20....               jsr     sidbong
    \ 00e0 4c....               jmp     `?L134`
    \ 00e3          `?L141`:
    \ 00e3 ab....               ldz     _Zp+27
    \ 00e6 d4..                 cpz     zp:_Zp+26
    \ 00e8 d004                 bne     `?L145`
    \ 00ea a93e                 lda     #62
    \ 00ec 8002                 bra     `?L1828`
    \ 00ee a920     `?L145`:    lda     #32
    \ 00f0          `?L1828`:
    \ 00f0 85..                 sta     zp:_Zp+1
    \ 00f2 a908                 lda     #8
    \ 00f4 18                   clc
    \ 00f5 65..                 adc     zp:_Zp+27
    \ 00f7 85..                 sta     zp:_Zp
    \ 00f9 a90c                 lda     #12
    \ 00fb 20....               jsr     cputcxy
    \ 00fe e6..                 inc     zp:_Zp+27
    \ 0100 4c....               jmp     `?L142`
0404
0405                void helpbegin()  {
    \ 0000                      .section code,text
    \ 0000                      .public helpbegin
    \ 0000          helpbegin:
0406                  text(HELPBEGIN, TRUE);
    \ 0000 a901                 lda     #1
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a964                 lda     #100
    \ 0006 20....               jsr     text
0407                  cputcxy(7, 24, ' ');
    \ 0009 a920                 lda     #32
    \ 000b 85..                 sta     zp:_Zp+1
    \ 000d a918                 lda     #24
    \ 000f 85..                 sta     zp:_Zp
    \ 0011 a907                 lda     #7
    \ 0013 20....               jsr     cputcxy
0408                  // cputs(petsciitoscreencode_s(VERSION));   @@@@
0409                  msprintf(VERSION);
    \ 0016 20....               jsr     `?L2073`
    \ 0019 20....               jsr     `?L2023`
0410                  cputc(' ');
0411                }
    \ 001c 60                   rts
0412
0413                unsigned char helpbox()  {
    \ 0000                      .section code,text
    \ 0000                      .public helpbox
    \ 0000 a200     helpbox:    ldx     #0
    \ 0002 a000                 ldy     #0
    \ 0004 20....               jsr     _AllocStackSave
0414                  unsigned char clear = 1;
0415                  unsigned char shadow = 1;
0416                  char c;
0417                  unsigned char page = 0;
    \ 0007 8a                   txa
    \ 0008 85..                 sta     zp:_Zp+24
    \ 000a          `?L189`:
0418
0419                  // Because of the additional messagebox we need to redraw all:
0420                  while(1)  {
0421                /*
0422                    mcbox(4, 0, 76, 24, COLOUR_CYAN, BOX_STYLE_INNER, clear, shadow);
0423                  
0424                    revers(1);
0425                    mcputsxy(14, 0, " Midnight Mega ");
0426                    mcputsxy(31, 0, " Help ");
0427                    mcputsxy(40, 0, " The MEGA65 file commander ");
0428                    revers(0);
0429
0430                    mcputsxy(7, 24, " ");
0431                    msprintf(VERSION);
0432                    msprintf(" ");
0433                    mcputsxy(52, 24, " github.com/nobruinfo ");
0434
0435                    revers(1);
0436                    mcputsxy(6,  2, " Ctrl ");
0437                    revers(0);
0438                    msprintf(" ");
0439                    revers(1);
0440                    msprintf(" r ");
0441                    revers(0);
0442                    msprintf(" to rescan current file panel (left or right).");
0443
0444                    mcputsxy(6,  4, "Due to Hypervisor limitations .d81 image files can neither be copied");
0445                    mcputsxy(6,  5, "as a whole nor be created, use ");
0446                    revers(1);
0447                    msprintf(" Mega ");
0448                    revers(0);
0449                    msprintf(" ");
0450                    revers(1);
0451                    msprintf(" F3 ");
0452                    revers(0);
0453                    msprintf(" for the freezer.");
0454
0455                    revers(1);
0456                    mcputsxy(6,  7, " Mega ");
0457                    revers(0);
0458                    msprintf(" ");
0459                    revers(1);
0460                    msprintf(" F5 ");
0461                    revers(0);
0462                    msprintf(" copies all blocks (allocated ones if configured) to");
0463                    mcputsxy(6,  8, "the opposite side, this will ");
0464                    highlight(1);
0465                    msprintf("overwrite");
0466                    highlight(0);
0467                    msprintf(" a whole disk (image)");
0468                    mcputsxy(6,  9, "contents irrevocably.");
0469
0470                    revers(1);
0471                    mcputsxy(6, 11, " ");
0472                    cputc(31);  // left arrow character
0473                    msprintf(" ");
0474                    revers(0);
0475                    msprintf(" in the upper left of your keyboard can be used instead of the");
0476                    revers(1);
0477                    mcputsxy(6, 12, " .. ");
0478                    revers(0);
0479                    msprintf(" directory entry to climb to the parent directory.");
0480
0481                    mcputsxy(6, 14, "Currently the left pane is always drive 0 and the right one drive 1,");
0482                    mcputsxy(6, 15, "a later handling within the same drive is planned allowing you");
0483                    mcputsxy(6, 16, "to copy files within one disk.");
0484
0485                    revers(1);
0486                    mcputsxy(6, 18, " F2 ");
0487                    revers(0);
0488                    msprintf(" (");
0489                    revers(1);
0490                    msprintf(" Shift ");
0491                    revers(0);
0492                    msprintf(" ");
0493                    revers(1);
0494                    msprintf(" F1 ");
0495                    revers(0);
0496
0497                    msprintf(" on the MEGA65 of course) is used for switching");
0498                    mcputsxy(6, 19, "from a mounted .d81 to the selection within the storage card and");
0499                    mcputsxy(6, 20, "back. ");
0500                    revers(1);
0501                    msprintf(" F11 ");
0502                    revers(0);
0503                    msprintf(" unmounts the current side to reach a real floppy drive.");
0504
0505                    revers(1);
0506                    mcputsxy(36, 22, "   OK   ");
0507                    revers(0);
0508                */
0509
0510                    switch (page) {
    \ 000a a5..                 lda     zp:_Zp+24
    \ 000c 85..                 sta     zp:_Zp
    \ 000e ab....               ldz     _Zp
    \ 0011 3b                   dez
    \ 0012 f014                 beq     `?L194`
    \ 0014 a202                 ldx     #2
    \ 0016 e4..                 cpx     zp:_Zp
    \ 0018 f007                 beq     `?L193`
0511                      case 1:
0512                        helpbegin();
0513                        text(HELP1, TRUE);
0514                      break;
0515
0516                      case 2:
0517                        helpbegin();
0518                        text(HELP2, TRUE);
0519                      break;
0520
0521                      default:
0522                        helpbegin();
    \ 001a 20....               jsr     `?L2039`
0523                        text(HELP0, TRUE);
    \ 001d a96a                 lda     #106
    \ 001f 800c                 bra     `?L1830`
    \ 0021          `?L193`:
    \ 0021 20....               jsr     `?L2039`
    \ 0024 a98d                 lda     #-115
    \ 0026 8005                 bra     `?L1830`
    \ 0028          `?L194`:
    \ 0028 20....               jsr     `?L2039`
    \ 002b a97b                 lda     #123
    \ 002d          `?L1830`:
    \ 002d 20....               jsr     text
0524                      break;
0525                    }
0526
0527                    c = cgetc();
    \ 0030 20....               jsr     cgetc
    \ 0033 85..                 sta     zp:_Zp
0528                    switch (c) {
    \ 0035 a9..                 lda     #.byte0 `?L677`
    \ 0037 85..                 sta     zp:_Zp+2
    \ 0039 a9..                 lda     #.byte1 `?L677`
    \ 003b 85..                 sta     zp:_Zp+3
    \ 003d 20....               jsr     `?L1993`
    \ 0040          `?L206`:
0529                      case 0x91: // Crsrup
0530                        if (page > 0)  page--;
    \ 0040 a5..                 lda     zp:_Zp+24
    \ 0042 f0c6                 beq     `?L189`
    \ 0044 c6..                 dec     zp:_Zp+24
    \ 0046 80c2                 bra     `?L189`
    \ 0048          `?L205`:
0531                      break;
0532                      case 0x11: // Crsrdown
0533                        if (page < HELPMAX)  page++;
    \ 0048 ab....               ldz     _Zp+24
    \ 004b c202                 cpz     #2
    \ 004d b0bb                 bcs     `?L189`
    \ 004f e6..                 inc     zp:_Zp+24
    \ 0051 80b7                 bra     `?L189`
    \ 0053          `?L203`:
0534                      break;
0535
0536                      case ' ':
0537                      case 13: // RETURN
0538                        return TRUE;
    \ 0053 a901                 lda     #1
    \ 0055 8002                 bra     `?L186`
    \ 0057          `?L201`:
0539                      break;
0540
0541                      case 3:  // STOP
0542                      case 27: // Esc
0543                        return FALSE;
    \ 0057 a900                 lda     #0
    \ 0059          `?L186`:
0544                      break;
0545
0546                /*        // Testing:
0547                      case 0x1f: // HELP
0548                      case 0xf1: // unused F keys
0549                        clrhome();
0550                        text(0);
0551                        text(1);
0552                        text(2);
0553                        text(3);
0554                        text(4);
0555                        text(5);
0556                        text(6);
0557                        text(7);
0558                        text(8);
0559                        cgetc();
0560                      break;
0561                */
0562
0563                      default:
0564                        sidbong();
0565                //        mprintf("val=", c);
0566                //        cputc(' ');
0567                      break;
0568                    }
0569                  }
0570                }
    \ 0059 a000                 ldy     #0
    \ 005b 4c....               jmp     _RestoreRegisters
    \ 005e          `?L200`:
    \ 005e 20....               jsr     sidbong
    \ 0061 80a7                 bra     `?L189`
0571
0572                // This uses $1703 so has to be called off usage of this memory:
0573                unsigned char legacyHDOS()  {
    \ 0000                      .section code,text
    \ 0000                      .public legacyHDOS
    \ 0000 a200     legacyHDOS: ldx     #0
    \ 0002 a001                 ldy     #1
    \ 0004 20....               jsr     _AllocStackSave
0574                //  unsigned char majorhyppo;
0575                //  unsigned char minorhyppo;
0576                //  unsigned char majorHDOS;
0577                //  unsigned char minorHDOS;
0578
0579                //  minorHDOS = hyppo_getversion(&majorhyppo, &minorhyppo, &majorHDOS, &minorHDOS);
0580                  if ((((hyppo_getversion_majorhyppo() * 100) + hyppo_getversion_minorhyppo()) < 102) ||
0581                      (((hyppo_getversion_majorHDOS() * 100) + hyppo_getversion_minorHDOS()) < 103))  return TRUE;
    \ 0007 20....               jsr     hyppo_getversion_majorhyppo
    \ 000a 20....               jsr     `?L2021`
    \ 000d 20....               jsr     hyppo_getversion_minorhyppo
    \ 0010 20....               jsr     `?L2061`
    \ 0013 9002                 bcc     `?L1015`
    \ 0015 e6..                 inc     zp:_Zp+25
    \ 0017          `?L1015`:
    \ 0017 a5..                 lda     zp:_Zp+24
    \ 0019 c966                 cmp     #102
    \ 001b a5..                 lda     zp:_Zp+25
    \ 001d e900                 sbc     #0
    \ 001f 5002                 bvc     `?L1017`
    \ 0021 4980                 eor     #-128
    \ 0023 3022     `?L1017`:   bmi     `?L225`
    \ 0025 20....               jsr     hyppo_getversion_majorHDOS
    \ 0028 20....               jsr     `?L2021`
    \ 002b 20....               jsr     hyppo_getversion_minorHDOS
    \ 002e 20....               jsr     `?L2061`
    \ 0031 9002                 bcc     `?L1022`
    \ 0033 e6..                 inc     zp:_Zp+25
    \ 0035          `?L1022`:
    \ 0035 a5..                 lda     zp:_Zp+24
    \ 0037 c967                 cmp     #103
    \ 0039 a5..                 lda     zp:_Zp+25
    \ 003b e900                 sbc     #0
    \ 003d 5002                 bvc     `?L1024`
    \ 003f 4980                 eor     #-128
    \ 0041 3004     `?L1024`:   bmi     `?L225`
0582                  else return FALSE;
    \ 0043 a900                 lda     #0
    \ 0045 8002                 bra     `?L222`
    \ 0047 a901     `?L225`:    lda     #1
    \ 0049          `?L222`:
0583                }
    \ 0049 a001                 ldy     #1
    \ 004b 4c....               jmp     _RestoreRegisters
0584
0585                unsigned char rombox()  {
    \ 0000                      .section code,text
    \ 0000                      .public rombox
    \ 0000          rombox:
0586                  unsigned char clear = 1;
    \ 0000 a901                 lda     #1
    \ 0002 85..                 sta     zp:_Zp+5
0587                  unsigned char shadow = 1;
    \ 0004 85..                 sta     zp:_Zp+6
0588                  char c;
0589
0590                  mcbox(4, 4, 75, 20, COLOUR_CYAN, BOX_STYLE_INNER, clear, shadow);
    \ 0006 85..                 sta     zp:_Zp+4
    \ 0008 a903                 lda     #3
    \ 000a 85..                 sta     zp:_Zp+3
    \ 000c a914                 lda     #20
    \ 000e 85..                 sta     zp:_Zp+2
    \ 0010 a94b                 lda     #75
    \ 0012 85..                 sta     zp:_Zp+1
    \ 0014 a904                 lda     #4
    \ 0016 85..                 sta     zp:_Zp
    \ 0018 20....               jsr     mcbox
0591
0592                  revers(1);
    \ 001b a901                 lda     #1
    \ 001d 20....               jsr     revers
0593                  mcputsxy(6, 4, " Midnight Mega ");
    \ 0020 a9..                 lda     #.byte0 `_StringLiteral_ Midnight Mega `
    \ 0022 85..                 sta     zp:_Zp+2
    \ 0024 a9..                 lda     #.byte1 `_StringLiteral_ Midnight Mega `
    \ 0026 85..                 sta     zp:_Zp+3
    \ 0028 a904                 lda     #4
    \ 002a 85..                 sta     zp:_Zp
    \ 002c a906                 lda     #6
    \ 002e 20....               jsr     mcputsxy
0594                  mcputsxy(25, 4, " List of ROM files ");
    \ 0031 a9..                 lda     #.byte0 `_StringLiteral_ List of ROM files `
    \ 0033 85..                 sta     zp:_Zp+2
    \ 0035 a9..                 lda     #.byte1 `_StringLiteral_ List of ROM files `
    \ 0037 85..                 sta     zp:_Zp+3
    \ 0039 a904                 lda     #4
    \ 003b 85..                 sta     zp:_Zp
    \ 003d a919                 lda     #25
    \ 003f 20....               jsr     `?L1956`
0595                  mcputsxy(47, 4, " The MEGA65 file commander ");
    \ 0042 a92f                 lda     #47
    \ 0044 20....               jsr     `?L1972`
0596                  revers(0);
0597
0598                  mcputsxy(7, 20, " ");
    \ 0047 a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 0049 85..                 sta     zp:_Zp+2
    \ 004b a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 004d 85..                 sta     zp:_Zp+3
    \ 004f a914                 lda     #20
    \ 0051 85..                 sta     zp:_Zp
    \ 0053 a907                 lda     #7
    \ 0055 20....               jsr     mcputsxy
0599                  msprintf(VERSION);
    \ 0058 20....               jsr     `?L2073`
    \ 005b 20....               jsr     msprintf
0600                  msprintf(" ");
    \ 005e 20....               jsr     `?L2032`
    \ 0061 20....               jsr     msprintf
0601                  mcputsxy(52, 20, " github.com/nobruinfo ");
    \ 0064 a9..                 lda     #.byte0 `_StringLiteral_ github.com/nobruinfo `
    \ 0066 85..                 sta     zp:_Zp+2
    \ 0068 a9..                 lda     #.byte1 `_StringLiteral_ github.com/nobruinfo `
    \ 006a 85..                 sta     zp:_Zp+3
    \ 006c a914                 lda     #20
    \ 006e 85..                 sta     zp:_Zp
    \ 0070 a934                 lda     #52
    \ 0072 20....               jsr     mcputsxy
0602
0603                  romlist(6);
    \ 0075 a906                 lda     #6
    \ 0077 20....               jsr     romlist
    \ 007a          `?L233`:
0604
0605                  while(1)  {
0606                    c = cgetc();
    \ 007a 20....               jsr     cgetc
0607                    switch (c) {
    \ 007d a2..                 ldx     #.byte0 `?L679`
    \ 007f 86..                 stx     zp:_Zp+2
    \ 0081 a2..                 ldx     #.byte1 `?L679`
    \ 0083 86..                 stx     zp:_Zp+3
    \ 0085 85..                 sta     zp:_Zp
    \ 0087 20....               jsr     `?L1993`
    \ 008a          `?L239`:
0608                      case ' ':
0609                      case 13: // RETURN
0610                        return TRUE;
    \ 008a a901                 lda     #1
    \ 008c 60                   rts
    \ 008d          `?L237`:
0611                      break;
0612
0613                      case 3:  // STOP
0614                       case 27: // Esc
0615                        return FALSE;
    \ 008d a900                 lda     #0
    \ 008f 60                   rts
    \ 0090          `?L236`:
0616                      break;
0617
0618                      default:
0619                        sidbong();
    \ 0090 20....               jsr     sidbong
0620                //        mprintf("val=", c);
0621                //        cputc(' ');
0622                      break;
    \ 0093 80e5                 bra     `?L233`
0623                    }
0624                  }
0625                }
0626
0627                unsigned int cgetcalt(unsigned char side)
0628                {
    \ 0000                      .section code,text
    \ 0000                      .public cgetcalt
    \ 0000          cgetcalt:
    \ 0000 20....               jsr     `?L2069`
    \ 0003 85..                 sta     zp:_Zp+26
0629                    unsigned char k;
0630                    unsigned char m, mbefore;
0631                    
0632                    shortcuts(0, side);
    \ 0005 a5..                 lda     zp:_Zp+26
    \ 0007 85..                 sta     zp:_Zp
    \ 0009 8a                   txa
    \ 000a 20....               jsr     shortcuts
    \ 000d          `?L249`:
0633                    while ((k = PEEK(0xD610U)) == 0)  {
    \ 000d ad10d6               lda     0xd610
    \ 0010 85..                 sta     zp:_Zp
    \ 0012 d01a                 bne     `?L250`
0634                      m = getkeymodstate();
    \ 0014 20....               jsr     getkeymodstate
    \ 0017 85..                 sta     zp:_Zp+24
0635                      if (m != mbefore)  {
    \ 0019 a6..                 ldx     zp:_Zp+25
    \ 001b e4..                 cpx     zp:_Zp+24
    \ 001d f0ee                 beq     `?L249`
0636                        shortcuts(m, side);
    \ 001f a5..                 lda     zp:_Zp+26
    \ 0021 85..                 sta     zp:_Zp
    \ 0023 a5..                 lda     zp:_Zp+24
    \ 0025 20....               jsr     shortcuts
0637                        mbefore = m;
    \ 0028 a5..                 lda     zp:_Zp+24
    \ 002a 85..                 sta     zp:_Zp+25
    \ 002c 80df                 bra     `?L249`
    \ 002e          `?L250`:
0638                      }
0639                    }
0640                    POKE(0xD610U, 0);
    \ 002e a900                 lda     #0
    \ 0030 8d10d6               sta     0xd610
0641                    return (m << 8) + k;
    \ 0033 a5..                 lda     zp:_Zp+24
    \ 0035 a200                 ldx     #0
    \ 0037 86..                 stx     zp:_Zp+1
    \ 0039 18                   clc
    \ 003a 65..                 adc     zp:_Zp+1
    \ 003c 85..                 sta     zp:_Zp+1
0642                }
    \ 003e 4c....               jmp     `?L258`
0643
0644                #define SETHYPPOOFF       0
0645                #define SETHYPPOON        1
0646                #define SETHYPPOONBYERROR 2
0647                unsigned char legacyHDOSstate;
    \ 0000                      .section zdata,bss
    \ 0000                      .public legacyHDOSstate
    \ 0000          legacyHDOSstate:
    \ 0000                      .space  1
0648                void UpdateSectors(unsigned char drive, unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public UpdateSectors
    \ 0000          UpdateSectors:
    \ 0000 20....               jsr     `?L2069`
    \ 0003 85..                 sta     zp:_Zp+24
    \ 0005 a5..                 lda     zp:_Zp
    \ 0007 85..                 sta     zp:_Zp+25
0649                  unsigned char c;  // build up a string
0650                  unsigned char sethyppo;  // failures set "storage selection dirent mode"
0651
0652                  midnight[side]->flags &= (~MIDNIGHTFLAGdirsortactive);
    \ 0009 a5..                 lda     zp:_Zp+25
    \ 000b 0a                   asl     a
    \ 000c aa                   tax
    \ 000d 18                   clc
    \ 000e a946                 lda     #70
0653                  
0654                  if (midnight[side]->flags & MIDNIGHTFLAGismounted)  {
    \ 0010 20....               jsr     `?L1914`
    \ 0013 a9fd                 lda     #-3
    \ 0015 a300                 ldz     #0
    \ 0017 32..                 and     (_Zp),z
    \ 0019 92..                 sta     (_Zp),z
    \ 001b a5..                 lda     zp:_Zp+25
    \ 001d 20....               jsr     `?L1908`
    \ 0020 20....               jsr     `?L1942`
    \ 0023 f31001               lbeq    `?L259`
0655                    // This would actually only have to be done once for both drives:
0656                    hyppo_get_proc_desc();
    \ 0026 20....               jsr     hyppo_get_proc_desc
0657                    /*
0658                    // https://stackoverflow.com/questions/1258550/why-should-you-use-strncpy-instead-of-strcpy
0659                    strncpy((char *) midnight[side]->curfile,
0660                            (drive ? (char *) taskblock->d81filename1 : (char *) taskblock->d81filename0),
0661                            (drive ? taskblock->d81filenamelength1 : taskblock->d81filenamelength0));
0662                */
0663                    if (drive == 0)  {
    \ 0029 a5..                 lda     zp:_Zp+24
    \ 002b d02c                 bne     `?L262`
0664                /*
0665                      strncpy(midnight[side]->curfile,
0666                              taskblock->d81filename0,
0667                              taskblock->d81filenamelength0);
0668                      midnight[side]->curfile[taskblock->d81filenamelength0] = 0;
0669                * /
0670                      c = 0;
0671                      while (taskblock->d81filename0[c] != 0 && c < taskblock->d81filenamelength0)  {
0672                        midnight[side]->curfile[c] = taskblock->d81filename0[c];
0673                        c++;
0674                      }
0675                      midnight[side]->curfile[c] = 0;
0676                */
0677                      if (PEEK(0xd6a1) & D6A1_USEREAL0)  {
    \ 002d ada1d6               lda     0xd6a1
    \ 0030 8901                 bit     #1
    \ 0032 f010                 beq     `?L265`
0678                        strcopy("real drive", (char *) midnight[side]->curfile, DOSFILENAMELEN);
    \ 0034 a5..                 lda     zp:_Zp+25
    \ 0036 20....               jsr     `?L1923`
    \ 0039 e3..                 inw     zp:_Zp+2
    \ 003b e3..                 inw     zp:_Zp+2
    \ 003d a9..                 lda     #.byte0 `_StringLiteral_real drive`
    \ 003f 20....               jsr     `?L2070`
    \ 0042 803f                 bra     `?L1832`
    \ 0044          `?L265`:
0679                      } else {
0680                        strcopy((char *) taskblock->d81filename0,
    \ 0044 a5..                 lda     zp:_Zp+25
    \ 0046 20....               jsr     `?L1923`
    \ 0049 e3..                 inw     zp:_Zp+2
    \ 004b e3..                 inw     zp:_Zp+2
    \ 004d 18                   clc
    \ 004e a915                 lda     #21
    \ 0050 20....               jsr     `?L1974`
    \ 0053 a013                 ldy     #19
    \ 0055 b1..                 lda     (_Zp+4),y
    \ 0057 802a                 bra     `?L1832`
    \ 0059          `?L262`:
0681                                (char *) midnight[side]->curfile,
0682                                taskblock->d81filenamelength0);
0683                      }
0684                    } else {
0685                /*
0686                      strncpy(midnight[side]->curfile,
0687                              taskblock->d81filename1,
0688                              taskblock->d81filenamelength1);
0689                      midnight[side]->curfile[taskblock->d81filenamelength1] = 0;
0690                * /
0691                      c = 0;
0692                      while (taskblock->d81filename1[c] != 0 && c < taskblock->d81filenamelength1)  {
0693                        midnight[side]->curfile[c] = taskblock->d81filename1[c];
0694                        c++;
0695                      }
0696                      midnight[side]->curfile[c] = 0;
0697                */
0698                      if (PEEK(0xd6a1) & D6A1_USEREAL1)  {
    \ 0059 ada1d6               lda     0xd6a1
    \ 005c 8904                 bit     #4
    \ 005e f010                 beq     `?L268`
0699                        strcopy("real drive", (char *) midnight[side]->curfile, DOSFILENAMELEN);
    \ 0060 a5..                 lda     zp:_Zp+25
    \ 0062 20....               jsr     `?L1923`
    \ 0065 e3..                 inw     zp:_Zp+2
    \ 0067 e3..                 inw     zp:_Zp+2
    \ 0069 a9..                 lda     #.byte0 `_StringLiteral_real drive`
    \ 006b 20....               jsr     `?L2070`
    \ 006e 8013                 bra     `?L1832`
    \ 0070          `?L268`:
0700                      } else {
0701                        strcopy((char *) taskblock->d81filename1,
    \ 0070 a5..                 lda     zp:_Zp+25
    \ 0072 20....               jsr     `?L1923`
    \ 0075 e3..                 inw     zp:_Zp+2
    \ 0077 e3..                 inw     zp:_Zp+2
    \ 0079 18                   clc
    \ 007a a935                 lda     #53
    \ 007c 20....               jsr     `?L1974`
    \ 007f a014                 ldy     #20
    \ 0081 b1..                 lda     (_Zp+4),y
    \ 0083          `?L1832`:
    \ 0083 20....               jsr     strcopy
0702                                (char *) midnight[side]->curfile,
0703                                taskblock->d81filenamelength1);
0704                      }
0705                    }
0706
0707                    getDiskname(legacyHDOSstate,
    \ 0086 a6..                 ldx     zp:_Zp+25
    \ 0088 86..                 stx     zp:_Zp+2
    \ 008a a900                 lda     #0
    \ 008c 20....               jsr     `?L1924`
    \ 008f 18                   clc
    \ 0090 20....               jsr     `?L2041`
    \ 0093 a5..                 lda     zp:_Zp+25
    \ 0095 20....               jsr     `?L1908`
    \ 0098 a047                 ldy     #71
    \ 009a 20....               jsr     `?L2036`
    \ 009d 20....               jsr     `?L1921`
    \ 00a0 20....               jsr     getDiskname
0708                                drive, midnight[side]->dirtrack, (char *) disknames[side]);
0709                    c = BAM2Attic(legacyHDOSstate, drive, side, midnight[side]->dirtrack);
    \ 00a3 a5..                 lda     zp:_Zp+25
    \ 00a5 20....               jsr     `?L1908`
    \ 00a8 a047                 ldy     #71
    \ 00aa 20....               jsr     `?L2063`
    \ 00ad 20....               jsr     `?L2037`
    \ 00b0 20....               jsr     `?L1921`
    \ 00b3 20....               jsr     BAM2Attic
    \ 00b6 85..                 sta     zp:_Zp
0710                    if (c > 1)  {
    \ 00b8 a301                 ldz     #1
    \ 00ba d4..                 cpz     zp:_Zp
    \ 00bc b015                 bcs     `?L271`
0711                /*
0712                      messagebox(MBOXNUMBER, "Reading BAM error, probably unmounted",
0713                                             (drive ? "drive 1" : "drive 0"),
0714                                             "error=", (long) c);
0715                */
0716                      midnight[side]->flags &= (~MIDNIGHTFLAGismounted);
    \ 00be a5..                 lda     zp:_Zp+25
    \ 00c0 0a                   asl     a
    \ 00c1 aa                   tax
    \ 00c2 18                   clc
    \ 00c3 a946                 lda     #70
0717                      sethyppo = SETHYPPOONBYERROR;
    \ 00c5 20....               jsr     `?L1914`
    \ 00c8 a9fe                 lda     #-2
    \ 00ca 3b                   dez
    \ 00cb 32..                 and     (_Zp),z
    \ 00cd 92..                 sta     (_Zp),z
    \ 00cf a902                 lda     #2
    \ 00d1 8064                 bra     `?L1833`
    \ 00d3          `?L271`:
0718                    } else {
0719                      midnight[side]->blocksfree = FreeBlocks(legacyHDOSstate,
    \ 00d3 a5..                 lda     zp:_Zp+25
    \ 00d5 20....               jsr     `?L1908`
    \ 00d8 a049                 ldy     #73
    \ 00da b1..                 lda     (_Zp),y
    \ 00dc 85..                 sta     zp:_Zp+3
    \ 00de a5..                 lda     zp:_Zp+25
    \ 00e0 20....               jsr     `?L1908`
    \ 00e3 88                   dey
    \ 00e4 20....               jsr     `?L2063`
    \ 00e7 20....               jsr     `?L1908`
    \ 00ea 88                   dey
    \ 00eb b1..                 lda     (_Zp),y
    \ 00ed 85..                 sta     zp:_Zp+1
    \ 00ef a5..                 lda     zp:_Zp+25
    \ 00f1 20....               jsr     `?L1921`
    \ 00f4 20....               jsr     FreeBlocks
    \ 00f7 a5..                 lda     zp:_Zp+25
    \ 00f9 0a                   asl     a
    \ 00fa aa                   tax
    \ 00fb bd....               lda     midnight,x
    \ 00fe 85..                 sta     zp:_Zp+2
    \ 0100 bd....               lda     midnight+1,x
    \ 0103 85..                 sta     zp:_Zp+3
    \ 0105 a044                 ldy     #68
    \ 0107 a5..                 lda     zp:_Zp
    \ 0109 91..                 sta     (_Zp+2),y
    \ 010b c8                   iny
    \ 010c a5..                 lda     zp:_Zp+1
    \ 010e 91..                 sta     (_Zp+2),y
0720                                                              side, midnight[side]->dirtrack,
0721                                                              midnight[side]->firsttrack,
0722                                                              midnight[side]->lasttrack);
0723                      midnight[side]->entries = getdirent(legacyHDOSstate, drive, side,
    \ 0110 a5..                 lda     zp:_Zp+25
    \ 0112 20....               jsr     `?L1908`
    \ 0115 a047                 ldy     #71
    \ 0117 20....               jsr     `?L2063`
    \ 011a 20....               jsr     `?L2037`
    \ 011d 20....               jsr     `?L1921`
    \ 0120 20....               jsr     getdirent
    \ 0123 48                   pha
    \ 0124 a5..                 lda     zp:_Zp+25
0724                                                          midnight[side]->dirtrack);
0725                      sethyppo = SETHYPPOOFF;
    \ 0126 20....               jsr     `?L1925`
    \ 0129 e3..                 inw     zp:_Zp
    \ 012b e3..                 inw     zp:_Zp
    \ 012d 68                   pla
    \ 012e a000                 ldy     #0
    \ 0130 91..                 sta     (_Zp),y
    \ 0132 98                   tya
    \ 0133 8002                 bra     `?L1833`
    \ 0135          `?L259`:
0726                    }
0727                  } else {
0728                    sethyppo = SETHYPPOON;
    \ 0135 a901                 lda     #1
    \ 0137          `?L1833`:
    \ 0137 85..                 sta     zp:_Zp+26
0729                  }
0730                  
0731                  if (sethyppo != SETHYPPOOFF)  {
    \ 0139 a5..                 lda     zp:_Zp+26
    \ 013b f05d                 beq     `?L258`
0732                    strcopy("storage card", (char *) disknames[side], DOSFILENAMELEN);
    \ 013d a6..                 ldx     zp:_Zp+25
    \ 013f 86..                 stx     zp:_Zp+2
    \ 0141 a900                 lda     #0
    \ 0143 20....               jsr     `?L1924`
    \ 0146 18                   clc
    \ 0147 20....               jsr     `?L2041`
    \ 014a 20....               jsr     `?L2028`
0733                    strcopy("storage card", (char *) midnight[side]->curfile, DOSFILENAMELEN);
    \ 014d a5..                 lda     zp:_Zp+25
    \ 014f 20....               jsr     `?L1923`
    \ 0152 e3..                 inw     zp:_Zp+2
    \ 0154 e3..                 inw     zp:_Zp+2
    \ 0156 20....               jsr     `?L2028`
0734                    midnight[side]->entries = gethyppodirent(drive, side, LFNNBRENTRIES);
    \ 0159 a950                 lda     #80
    \ 015b 85..                 sta     zp:_Zp+1
    \ 015d a5..                 lda     zp:_Zp+25
    \ 015f 85..                 sta     zp:_Zp
    \ 0161 a5..                 lda     zp:_Zp+24
    \ 0163 20....               jsr     gethyppodirent
    \ 0166 48                   pha
    \ 0167 a5..                 lda     zp:_Zp+25
0735                    midnight[side]->blocksfree = UINT_MAX;
0736                    if (sethyppo == SETHYPPOONBYERROR)  midnight[side]->blocksfree = UINT_MAX - 1;
    \ 0169 20....               jsr     `?L1925`
    \ 016c e3..                 inw     zp:_Zp
    \ 016e e3..                 inw     zp:_Zp
    \ 0170 68                   pla
    \ 0171 a000                 ldy     #0
    \ 0173 91..                 sta     (_Zp),y
    \ 0175 a5..                 lda     zp:_Zp+25
    \ 0177 20....               jsr     `?L1908`
    \ 017a a044                 ldy     #68
    \ 017c a9ff                 lda     #255
    \ 017e 91..                 sta     (_Zp),y
    \ 0180 c8                   iny
    \ 0181 a9ff                 lda     #255
    \ 0183 91..                 sta     (_Zp),y
    \ 0185 a302                 ldz     #2
    \ 0187 d4..                 cpz     zp:_Zp+26
    \ 0189 d00f                 bne     `?L258`
    \ 018b a5..                 lda     zp:_Zp+25
    \ 018d 20....               jsr     `?L1908`
    \ 0190 88                   dey
    \ 0191 a9fe                 lda     #254
    \ 0193 91..                 sta     (_Zp),y
    \ 0195 c8                   iny
    \ 0196 a9ff                 lda     #255
    \ 0198 91..                 sta     (_Zp),y
    \ 019a          `?L258`:
0737                  }
0738                }
    \ 019a a002                 ldy     #2
    \ 019c 4c....               jmp     _RestoreRegisters
0739
0740                // overwrites the current file as selected if there's no other:
0741                unsigned int sizeselectcurrentifnone(unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public sizeselectcurrentifnone
    \ 0000          sizeselectcurrentifnone:
    \ 0000 a200                 ldx     #0
    \ 0002 a005                 ldy     #5
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+29
0742                  unsigned int i;
0743                  DIRENT* ds;
0744                  unsigned int size = 0;
    \ 0009 8a                   txa
    \ 000a 85..                 sta     zp:_Zp+24
    \ 000c 85..                 sta     zp:_Zp+25
0745                  unsigned char found = FALSE;
    \ 000e 85..                 sta     zp:_Zp+28
0746
0747                  for (i = 0; i < NBRENTRIES; i++)  {
    \ 0010 85..                 sta     zp:_Zp+26
    \ 0012 85..                 sta     zp:_Zp+27
    \ 0014          `?L284`:
    \ 0014 20....               jsr     `?L1986`
    \ 0017 905b                 bcc     `?L283`
0748                    if (direntflags[side][i].flags & DIRFLAGSisselected)  {
0749                      found = TRUE;
0750                      // add to size:
0751                      ds = getdirententry(side, i);
0752                      size += ds->size;
0753                      
0754                      // @@ momentary workaround:
0755                      if ((ds->type&0xf) == VAL_DOSFTYPE_CBM)  {
0756                        messagebox(MBOXNOCANCEL, "Copying subdirectories",
0757                                   "is not yet implemented.",
0758                                   " ", 0);
0759                        return UINT_MAX;
0760                      }
0761                    }
0762                  }
0763                  // no selection uses currently highlighted entry:
0764                  if (!found)  {
    \ 0019 a5..                 lda     zp:_Zp+28
    \ 001b d04f                 bne     `?L295`
0765                    direntflags[side][midnight[side]->pos].flags |= DIRFLAGSisselected;
    \ 001d a6..                 ldx     zp:_Zp+29
    \ 001f 20....               jsr     `?L1953`
    \ 0022 20....               jsr     `?L1912`
    \ 0025 f005                 beq     `?L1058`
    \ 0027          `?L1059`:
    \ 0027 20....               jsr     `?L1990`
    \ 002a d0fb                 bne     `?L1059`
    \ 002c          `?L1058`:
    \ 002c a5..                 lda     zp:_Zp+2
    \ 002e 38                   sec
    \ 002f e5..                 sbc     zp:_Zp
    \ 0031 85..                 sta     zp:_Zp
    \ 0033 a5..                 lda     zp:_Zp+3
    \ 0035 e5..                 sbc     zp:_Zp+1
    \ 0037 85..                 sta     zp:_Zp+1
    \ 0039 18                   clc
    \ 003a a5..                 lda     zp:_Zp
    \ 003c 69..                 adc     #.byte0 direntflags
    \ 003e 85..                 sta     zp:_Zp
    \ 0040 a5..                 lda     zp:_Zp+1
    \ 0042 69..                 adc     #.byte1 direntflags
    \ 0044 85..                 sta     zp:_Zp+1
    \ 0046 a5..                 lda     zp:_Zp+29
    \ 0048 20....               jsr     `?L1923`
    \ 004b a000                 ldy     #0
    \ 004d b1..                 lda     (_Zp+2),y
    \ 004f 85..                 sta     zp:_Zp+2
    \ 0051 18                   clc
    \ 0052 a5..                 lda     zp:_Zp
    \ 0054 65..                 adc     zp:_Zp+2
    \ 0056 85..                 sta     zp:_Zp
    \ 0058 9002                 bcc     `?L1061`
    \ 005a e6..                 inc     zp:_Zp+1
    \ 005c          `?L1061`:
0766                    ds = getdirententry(side, midnight[side]->pos);
    \ 005c 20....               jsr     `?L1955`
    \ 005f a5..                 lda     zp:_Zp+29
    \ 0061 20....               jsr     `?L1908`
    \ 0064 20....               jsr     `?L2002`
    \ 0067 a5..                 lda     zp:_Zp+29
    \ 0069 20....               jsr     `?L1978`
    \ 006c          `?L295`:
0767                    size += ds->size;
0768                  }
0769                  return size;
    \ 006c a5..                 lda     zp:_Zp+24
    \ 006e 85..                 sta     zp:_Zp
    \ 0070 a5..                 lda     zp:_Zp+25
    \ 0072 804e                 bra     `?L1834`
    \ 0074          `?L283`:
    \ 0074 a6..                 ldx     zp:_Zp+29
    \ 0076 20....               jsr     `?L1953`
    \ 0079 20....               jsr     `?L1912`
    \ 007c f005                 beq     `?L1064`
    \ 007e          `?L1065`:
    \ 007e 20....               jsr     `?L1990`
    \ 0081 d0fb                 bne     `?L1065`
    \ 0083          `?L1064`:
    \ 0083 20....               jsr     `?L1911`
    \ 0086 20....               jsr     `?L1958`
    \ 0089 f03e                 beq     `?L285`
    \ 008b a901                 lda     #1
    \ 008d 85..                 sta     zp:_Zp+28
    \ 008f 20....               jsr     `?L1944`
    \ 0092 a5..                 lda     zp:_Zp+29
    \ 0094 20....               jsr     `?L1978`
    \ 0097 a90f                 lda     #15
    \ 0099 a302                 ldz     #2
    \ 009b 32..                 and     (_Zp),z
    \ 009d c905                 cmp     #5
    \ 009f d028                 bne     `?L285`
    \ 00a1 20....               jsr     `?L1909`
    \ 00a4 20....               jsr     `?L1922`
    \ 00a7 a9..                 lda     #.byte0 `_StringLiteral_is not yet implemented.`
    \ 00a9 85..                 sta     zp:_Zp+2
    \ 00ab a9..                 lda     #.byte1 `_StringLiteral_is not yet implemented.`
    \ 00ad 85..                 sta     zp:_Zp+3
    \ 00af a9..                 lda     #.byte0 `_StringLiteral_Copying subdirectories`
    \ 00b1 85..                 sta     zp:_Zp
    \ 00b3 a9..                 lda     #.byte1 `_StringLiteral_Copying subdirectories`
    \ 00b5 85..                 sta     zp:_Zp+1
    \ 00b7 a904                 lda     #4
    \ 00b9 20....               jsr     `?L1915`
    \ 00bc a9ff                 lda     #255
    \ 00be 85..                 sta     zp:_Zp
    \ 00c0 a9ff                 lda     #255
    \ 00c2          `?L1834`:
    \ 00c2 85..                 sta     zp:_Zp+1
0770                }
    \ 00c4 a005                 ldy     #5
    \ 00c6 4c....               jmp     _RestoreRegisters
    \ 00c9          `?L285`:
    \ 00c9 e3..                 inw     zp:_Zp+26
    \ 00cb 4c....               jmp     `?L284`
0771
0772                // unsigned char testtrack;
0773                // unsigned char testsector;
0774                void navi(unsigned char side)  {
    \ 0000                      .section code,text
    \ 0000                      .public navi
    \ 0000 a2fd     navi:       ldx     #253
    \ 0002 a008                 ldy     #8
    \ 0004 20....               jsr     _AllocStackSave
    \ 0007 85..                 sta     zp:_Zp+24
0775                  unsigned int c;  // keyboard input
0776                  unsigned char leftx;
0777                  unsigned char starttrack;
0778                  unsigned char startsector;
0779                  unsigned char endtrack;
0780                  unsigned char attachresult;
0781                  unsigned int i;
0782                  unsigned char fd;
0783                  unsigned char number;
0784                  DIRENT* ds;
0785                  unsigned char alive = TRUE;
    \ 0009 a901                 lda     #1
    \ 000b 85..                 sta     zp:_Zp
0786
0787                  option.option = OPTIONshowALO | OPTIONshowDRV;
    \ 000d a906                 lda     #6
    \ 000f 8d....               sta     option
0788                  legacyHDOSstate = legacyHDOS(); // clobbers $1703
    \ 0012 20....               jsr     legacyHDOS
    \ 0015 8d....               sta     legacyHDOSstate
0789                /*
0790                messagebox(MBOXNUMBER, "after legacy()",
0791                                       " ", // (midnight[side]->drive ? "drive 1" : "drive 0"),
0792                                       "BASEPAGERESERVED=", *(long*) BASEPAGERESERVED);
0793                */
0794                  // initialising:
0795                  for (i = 0; i < 2; i++)  {
    \ 0018 20....               jsr     `?L2060`
    \ 001b          `?L302`:
    \ 001b a5..                 lda     zp:_Zp+28
    \ 001d c902                 cmp     #2
    \ 001f a5..                 lda     zp:_Zp+29
    \ 0021 e900                 sbc     #0
    \ 0023 93d915               lbcc    `?L301`
0796                    // @@ to be made variable maybe?
0797                    midnight[i]->drive = i;
0798
0799                    // title of mcbox is .d81 file name, cannot be read at startup:
0800                    strcpy((char *) midnight[i]->curfile, (char *) "already mounted");
0801                    midnight[i]->dirtrack = HEADERTRACK;
0802                    midnight[i]->firsttrack = FIRSTTRACK;
0803                    midnight[i]->lasttrack = LASTTRACK;
0804                    midnight[i]->pos = 0;
0805                    midnight[i]->flags |= MIDNIGHTFLAGismounted;
0806
0807                    // Momentary fix for Deft's no .d81 in drv 1 must show no error:
0808                    if ((i == 1) && !legacyHDOSstate &&
0809                        (midnight[i]->flags & MIDNIGHTFLAGismounted) &&
0810                        (PEEK(0xd68b) & D68B_IMG1) == 0)  {
0811                      midnight[i]->flags &= (~MIDNIGHTFLAGismounted);
0812                    }
0813
0814                    messagebox(MBOXFALLTHROUGH, " ", " ", " ", 0);
0815                    progress("Initialising...", "reading disk drives", i * 40 + 40);
0816                    UpdateSectors(midnight[i]->drive, i);
0817                    Deselect(i);
0818                  }
0819
0820                  // find dirent with text file:
0821                  alive = FALSE;
    \ 0026 a900                 lda     #0
    \ 0028 85..                 sta     zp:_Zp+25
0822                  for (i = 0; i < NBRENTRIES; i++)  {
    \ 002a 85..                 sta     zp:_Zp+28
    \ 002c 85..                 sta     zp:_Zp+29
    \ 002e          `?L309`:
    \ 002e a5..                 lda     zp:_Zp+25
    \ 0030 85..                 sta     zp:_Zp+30
    \ 0032 a5..                 lda     zp:_Zp+28
    \ 0034 c9f8                 cmp     #248
    \ 0036 a5..                 lda     zp:_Zp+29
    \ 0038 e900                 sbc     #0
    \ 003a b021                 bcs     `?L311`
0823                    ds = getdirententry(side, i);
    \ 003c a5..                 lda     zp:_Zp+28
    \ 003e 85..                 sta     zp:_Zp
    \ 0040 a5..                 lda     zp:_Zp+29
    \ 0042 20....               jsr     `?L1960`
0824
0825                    if (mstrcmp(ds->name, "MIDNIGHTMEGATEXT", 17) == 0)  {
    \ 0045 a9..                 lda     #.byte0 _StringLiteral_MIDNIGHTMEGATEXT
    \ 0047 85..                 sta     zp:_Zp+2
    \ 0049 a9..                 lda     #.byte1 _StringLiteral_MIDNIGHTMEGATEXT
    \ 004b 85..                 sta     zp:_Zp+3
    \ 004d 20....               jsr     `?L2031`
    \ 0050 a911                 lda     #17
    \ 0052 20....               jsr     mstrcmp
    \ 0055 aa                   tax
    \ 0056 d3a115               lbne    `?L310`
0826                      // valuesbox(0, "mstrcmp", "i=", i, "last=", ds->name[15]);
0827                      alive = TRUE;
    \ 0059 a901                 lda     #1
    \ 005b 85..                 sta     zp:_Zp+30
    \ 005d          `?L311`:
0828                      break;
0829                    }
0830                  }
0831
0832                  // read complete text file into Attic:
0833                  if (alive)  {
    \ 005d a5..                 lda     zp:_Zp+30
    \ 005f f064                 beq     `?L316`
0834                    if (readblockchain(legacyHDOSstate, ATTICTEXTBUFFER, TEXTBLOCKS,
0835                                       midnight[side]->drive, ds->track, ds->sector) > 0)  {
    \ 0061 a9ff                 lda     #-1
    \ 0063 20....               jsr     _DecVsp
    \ 0066 a004                 ldy     #4
    \ 0068 b1..                 lda     (_Zp+26),y
    \ 006a a000                 ldy     #0
    \ 006c 91..                 sta     (_Vsp),y
    \ 006e a003                 ldy     #3
    \ 0070 b1..                 lda     (_Zp+26),y
    \ 0072 85..                 sta     zp:_Zp+7
    \ 0074 a5..                 lda     zp:_Zp+24
    \ 0076 20....               jsr     `?L1908`
    \ 0079 a000                 ldy     #0
    \ 007b b1..                 lda     (_Zp),y
    \ 007d 85..                 sta     zp:_Zp+6
    \ 007f a932                 lda     #50
    \ 0081 85..                 sta     zp:_Zp+4
    \ 0083 a900                 lda     #0
    \ 0085 85..                 sta     zp:_Zp+5
    \ 0087 a2ea                 ldx     #234
    \ 0089 a00c                 ldy     #12
    \ 008b a308                 ldz     #8
    \ 008d 424285..             stq     zp:_Zp
    \ 0091 ad....               lda     legacyHDOSstate
    \ 0094 20....               jsr     `?L2054`
    \ 0097 aa                   tax
    \ 0098 f017                 beq     `?L319`
0836                      // valuesbox(0, "readblockchain", "t=", ds->track, "s=", ds->sector);
0837                      pcputs("ERROR too much text data for available blocks!");
    \ 009a a9..                 lda     #.byte0 `_StringLiteral_ERROR too much text data for available blocks!`
    \ 009c 85..                 sta     zp:_Zp
    \ 009e a9..                 lda     #.byte1 `_StringLiteral_ERROR too much text data for available blocks!`
    \ 00a0 85..                 sta     zp:_Zp+1
    \ 00a2 20....               jsr     petsciitoscreencode_s
    \ 00a5 20....               jsr     cputs
0838                      cgetc();
    \ 00a8 20....               jsr     cgetc
0839                      alive = FALSE;
    \ 00ab a900                 lda     #0
    \ 00ad 85..                 sta     zp:_Zp+30
    \ 00af 802f                 bra     `?L317`
    \ 00b1          `?L319`:
0840                    } else {
0841                      // Info above keybar:
0842                      text(INFOFOOTER1, FALSE);
    \ 00b1 98                   tya
    \ 00b2 85..                 sta     zp:_Zp
    \ 00b4 20....               jsr     text
0843                      text(INFOFOOTER2, FALSE);
    \ 00b7 a900                 lda     #0
    \ 00b9 85..                 sta     zp:_Zp
    \ 00bb a901                 lda     #1
    \ 00bd 20....               jsr     text
0844                      shortcuts(20, 0);
    \ 00c0 20....               jsr     `?L1992`
    \ 00c3 801b                 bra     `?L317`
    \ 00c5          `?L316`:
0845                    }
0846                  } else {
0847                    // pcputs("ERROR text data file not found!");
0848                    // cgetc();
0849                    messagebox(MBOXNOCANCEL, "ERROR text data file not found!",
    \ 00c5 20....               jsr     `?L1909`
    \ 00c8 20....               jsr     `?L1922`
    \ 00cb a9..                 lda     #.byte0 `_StringLiteral_Programme terminating.`
    \ 00cd 85..                 sta     zp:_Zp+2
    \ 00cf a9..                 lda     #.byte1 `_StringLiteral_Programme terminating.`
    \ 00d1 85..                 sta     zp:_Zp+3
    \ 00d3 a9..                 lda     #.byte0 `_StringLiteral_ERROR text data file not found!`
    \ 00d5 85..                 sta     zp:_Zp
    \ 00d7 a9..                 lda     #.byte1 `_StringLiteral_ERROR text data file not found!`
    \ 00d9 85..                 sta     zp:_Zp+1
    \ 00db a904                 lda     #4
    \ 00dd 20....               jsr     `?L1915`
    \ 00e0          `?L317`:
0850                                             "Programme terminating.",
0851                                             " ", 0);
0852                  }
0853
0854                  _miniInit();  // Pause the floppy drive while waiting for the user
    \ 00e0 20....               jsr     _miniInit
0855                  // @@@@ legacy timing:
0856                  if (legacyHDOSstate &&
0857                      !messagebox(MBOXVERSION,
0858                                     "A HICKUP.M65 v1.2 or older is active on your storage card",
0859                                     "or an old core containing it. Falling back to slow mode.",
0860                                     "Press RETURN to continue, STOP to halt.", 0))  {
    \ 00e3 ad....               lda     legacyHDOSstate
    \ 00e6 f027                 beq     `?L322`
    \ 00e8 20....               jsr     `?L1909`
    \ 00eb a9..                 lda     #.byte0 `_StringLiteral_Press RETURN to continue, STOP to halt.`
    \ 00ed 85..                 sta     zp:_Zp+4
    \ 00ef a9..                 lda     #.byte1 `_StringLiteral_Press RETURN to continue, STOP to halt.`
    \ 00f1 85..                 sta     zp:_Zp+5
    \ 00f3 a9..                 lda     #.byte0 `_StringLiteral_or an old core containing it. Falling back to slow mode.`
    \ 00f5 85..                 sta     zp:_Zp+2
    \ 00f7 a9..                 lda     #.byte1 `_StringLiteral_or an old core containing it. Falling back to slow mode.`
    \ 00f9 85..                 sta     zp:_Zp+3
    \ 00fb a9..                 lda     #.byte0 `_StringLiteral_A HICKUP.M65 v1.2 or older is active on your storage card`
    \ 00fd 85..                 sta     zp:_Zp
    \ 00ff a9..                 lda     #.byte1 `_StringLiteral_A HICKUP.M65 v1.2 or older is active on your storage card`
    \ 0101 85..                 sta     zp:_Zp+1
    \ 0103 a901                 lda     #1
    \ 0105 20....               jsr     `?L1915`
    \ 0108 aa                   tax
    \ 0109 d004                 bne     `?L322`
0861                    alive = FALSE;
    \ 010b a900                 lda     #0
    \ 010d 8002                 bra     `?L1889`
    \ 010f          `?L322`:
    \ 010f a5..                 lda     zp:_Zp+30
    \ 0111          `?L1889`:
    \ 0111 85..                 sta     zp:_Zp+25
    \ 0113          `?L325`:
0862                  }
0863
0864                /* @@@@
0865                  if (!messagebox(MBOXVERSION,
0866                                     "is currently beta and may destroy data structures on",
0867                                     ".d81 and real disks! Please work on backed up media.",
0868                                     "Press RETURN to continue, STOP to halt.", 0))  {
0869                    alive = FALSE;
0870                  }
0871                @@@@ */
0872
0873                  // main navigation loop:
0874                  while (alive)  {
    \ 0113 a5..                 lda     zp:_Zp+25
    \ 0115 f3db14               lbeq    `?L300`
0875                    // end running drive access:
0876                    _miniInit();
    \ 0118 20....               jsr     _miniInit
0877                    for (i = 0; i < 2; i++)  {
    \ 011b a900                 lda     #0
    \ 011d 85..                 sta     zp:_Zp+30
    \ 011f 85..                 sta     zp:_Zp+31
    \ 0121          `?L329`:
    \ 0121 a5..                 lda     zp:_Zp+30
    \ 0123 c902                 cmp     #2
    \ 0125 a5..                 lda     zp:_Zp+31
    \ 0127 e900                 sbc     #0
    \ 0129 93f312               lbcc    `?L328`
0878                      if (midnight[i]->pos > midnight[i]->entries)  {
0879                        midnight[i]->pos = midnight[i]->entries;
0880                      }
0881                      if (midnight[i]->entries == 0xff)  {
0882                        midnight[i]->pos = 0;  // @@@@ empty list is not handled below :(
0883                      }
0884                      leftx = i * 40;
0885                      mcbox(leftx, 0, leftx + 39, 0 + 23, COLOUR_CYAN, BOX_STYLE_INNER, 1, 0);
0886                      revers(1);
0887                      mcputsxy(leftx + 2, 0, " ");  // @@ to be string optimised as in listbox()
0888                      msprintf((char *) disknames[i]); // @@@@ maybe simply call GetDisknames here
0889                      cputc(' ');
0890                      if (midnight[i]->flags & MIDNIGHTFLAGismounted)  {
0891                        mcputsxy(wherex() + 1, 0, " ");
0892                        msprintf((char *) midnight[i]->curfile);
0893                        cputc(' ');
0894                      }
0895                      mcputsxy(leftx + 2, 23, " drv:");
0896                      csputdec(midnight[i]->drive, 0, 0);
0897                      cputc(' ');
0898                      if (midnight[i]->entries == 0xff)  {
0899                        // can also indicate more than the allowed number of dirents:
0900                        mcputsxy(leftx + 17, 3, " empty ");
0901                //        if (side == i)  mcputsxy(leftx + 12, 5, " > F2 to mount < ");
0902                //        valuesbox(0, "empty list", "entries=", midnight[i]->entries, " ", 0);
0903                      } else {
0904                        listbox((side == i), i, leftx + 1, 1,
0905                                midnight[i]->pos, midnight[i]->entries);
0906                      }
0907                      if (midnight[i]->blocksfree == (UINT_MAX - 1))  {
0908                        blink(TRUE);
0909                        textcolor(COLOUR_ORANGE);
0910                        mcputsxy(leftx + 12, 23, " disk access error ");
0911                        blink(FALSE);
0912                        sidbong();
0913                        midnight[i]->blocksfree = UINT_MAX;
0914                      }
0915                      else if (midnight[i]->blocksfree != UINT_MAX)  {
0916                        mcputsxy(leftx + 12, 23, " ");
0917                        csputdec(midnight[i]->blocksfree, 0, 0);
0918                        msprintf(" blocks free ");
0919                      }
0920                      else {
0921                        mcputsxy(leftx + 12, 23, " F11 to mount real drive ");
0922                      }
0923                      revers(0);
0924                    }
0925
0926                    c = cgetcalt(side);
    \ 012c a5..                 lda     zp:_Zp+24
    \ 012e 20....               jsr     cgetcalt
    \ 0131 a5..                 lda     zp:_Zp
    \ 0133 85..                 sta     zp:_Zp+28
    \ 0135 a5..                 lda     zp:_Zp+1
    \ 0137 85..                 sta     zp:_Zp+29
0927                    bordercolor (COLOUR_BLACK); // to unset red error borders
    \ 0139 a900                 lda     #0
    \ 013b 20....               jsr     bordercolor
0928                    
0929                    // Drop all keys not used in dir sort mode:
0930                    if (midnight[side]->flags & MIDNIGHTFLAGdirsortactive)  {
    \ 013e a5..                 lda     zp:_Zp+24
    \ 0140 20....               jsr     `?L1908`
    \ 0143 20....               jsr     `?L1987`
    \ 0146 f04c                 beq     `?L351`
0931                      switch (c) { // mega65-book.pdf#229
    \ 0148 a9..                 lda     #.byte0 `?L688`
    \ 014a 85..                 sta     zp:_Zp+2
    \ 014c a9..                 lda     #.byte1 `?L688`
    \ 014e 20....               jsr     `?L2027`
    \ 0151          `?L358`:
0932                        case 0x91: // Crsrup
0933                        case 0x191: // Shift Crsrup
0934                        case 0x291:
0935                        case 0x11: // Crsrdown
0936                        case 0x412: // Ctrl-r
0937                        case 0x20: // Space to toggle
0938                        case 0x194: // Shift-Inst
0939                        case 0x294:
0940                        case 0x1f: // HELP
0941                        case 0xf1: // unused F keys
0942                        case 0x1f1:
0943                        case 0x2f1:
0944                          // allowed keys in this mode
0945                        break;
0946
0947                        case 13: // return
0948                          rewritedirent(legacyHDOSstate, midnight[side]->drive, side,
    \ 0151 a5..                 lda     zp:_Zp+24
    \ 0153 20....               jsr     `?L1908`
    \ 0156 a049                 ldy     #73
    \ 0158 b1..                 lda     (_Zp),y
    \ 015a 85..                 sta     zp:_Zp+4
    \ 015c a5..                 lda     zp:_Zp+24
    \ 015e 20....               jsr     `?L1908`
    \ 0161 88                   dey
    \ 0162 b1..                 lda     (_Zp),y
    \ 0164 85..                 sta     zp:_Zp+3
    \ 0166 a5..                 lda     zp:_Zp+24
    \ 0168 20....               jsr     `?L1908`
    \ 016b 88                   dey
    \ 016c 20....               jsr     `?L1948`
    \ 016f a5..                 lda     zp:_Zp+24
    \ 0171 20....               jsr     `?L1929`
    \ 0174 a000                 ldy     #0
    \ 0176 b1..                 lda     (_Zp+6),y
    \ 0178 20....               jsr     `?L1921`
    \ 017b 20....               jsr     rewritedirent
    \ 017e          `?L356`:
0949                                        midnight[side]->dirtrack,
0950                                        midnight[side]->firsttrack, midnight[side]->lasttrack);
0951                        // ... falling through ... no break;
0952                        case 3:    // STOP
0953                        case 27:   // Esc
0954                          UpdateSectors(midnight[side]->drive, side);
    \ 017e a5..                 lda     zp:_Zp+24
    \ 0180 85..                 sta     zp:_Zp
    \ 0182 20....               jsr     `?L1913`
0955                          Deselect(side);
    \ 0185 20....               jsr     `?L1954`
0956                          c = 0xFF; // bong preventing
    \ 0188 a9ff                 lda     #255
0957                        break;
    \ 018a 8002                 bra     `?L1888`
    \ 018c          `?L355`:
0958
0959                        default:
0960                          c = 0;
    \ 018c a900                 lda     #0
    \ 018e          `?L1888`:
    \ 018e 85..                 sta     zp:_Zp+28
    \ 0190 a900                 lda     #0
    \ 0192 85..                 sta     zp:_Zp+29
    \ 0194          `?L351`:
0961                        break;
0962                      }
0963                    }
0964
0965                    switch (c) { // mega65-book.pdf#229
    \ 0194 a9..                 lda     #.byte0 `?L687`
    \ 0196 85..                 sta     zp:_Zp+2
    \ 0198 a9..                 lda     #.byte1 `?L687`
    \ 019a 20....               jsr     `?L2027`
    \ 019d          `?L402`:
0966                      case 0x91: // Crsrup
0967                      case 0x191: // Shift Crsrup
0968                      case 0x291:
0969                        if (midnight[side]->pos > 0)  {
0970                          if ((midnight[side]->flags & MIDNIGHTFLAGdirsortactive) &&
0971                              (direntflags[side][midnight[side]->pos].flags &
0972                                    DIRFLAGSisselected))  {
0973                            swapdirententry(side, midnight[side]->pos, midnight[side]->pos - 1);
0974                            Deselect(side);
0975                            direntflags[side][midnight[side]->pos - 1].flags |=
0976                                    DIRFLAGSisselected;
0977                          }
0978                          midnight[side]->pos--;
0979                        }
0980                      break;
0981                      case 0x11: // Crsrdown
0982                        if (midnight[side]->pos < midnight[side]->entries)  {
0983                          if ((midnight[side]->flags & MIDNIGHTFLAGdirsortactive) &&
0984                              (direntflags[side][midnight[side]->pos].flags &
0985                                    DIRFLAGSisselected))  {
0986                            swapdirententry(side, midnight[side]->pos, midnight[side]->pos + 1);
0987                            Deselect(side);
0988                            direntflags[side][midnight[side]->pos + 1].flags |=
0989                                    DIRFLAGSisselected;
0990                          }
0991                          midnight[side]->pos++;
0992                        }
0993                      break;
0994                      case 0x9d: // Left
0995                      case 0x19d:
0996                      case 0x29d:
0997                        if (midnight[side]->pos > 10)  midnight[side]->pos -= 10;
0998                        else                           midnight[side]->pos = 0;
0999                      break;
1000                      case 0x1d: // Right
1001                        midnight[side]->pos += 10;
1002                      break;
1003
1004                      case 0x9: // Tab
1005                      case 0x109:
1006                      case 0x209:
1007                        side = (side ? 0 : 1);
1008                      break;
1009
1010                      case 0xf2: // Modifiers and ASC_F1:
1011                      case 0x1f2:
1012                      case 0x2f2:
1013                        // Mount toggle and reset to root dirent:
1014                        midnight[side]->flags ^= MIDNIGHTFLAGismounted;
1015                        midnight[side]->dirtrack = HEADERTRACK;
1016                        midnight[side]->firsttrack = FIRSTTRACK;
1017                        midnight[side]->lasttrack = LASTTRACK;
1018                        UpdateSectors(midnight[side]->drive, side);
1019                        Deselect(side);
1020                      break;
1021                /*
1022                      case 0x8f2: // Mega-F1
1023                        if ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE)  {
1024                          messagebox(MBOXNOCANCEL, "Unmount",
1025                                                   "not supported in mount mode.", " ", 0);
1026                        } else {
1027                          if (messagebox(MBOXREGULAR, "Unmount",
1028                                         (side ? "right drive" : "left drive"), " ", 0))  {
1029                            hyppo_dos_attach(0b10000000 + side); // hyppo_d81detach();
1030                            UpdateSectors(midnight[side?0:1]->drive, side?0:1);
1031                          }
1032                        }
1033                      break;
1034                */
1035                      case 0x8f4: // Mega-F3
1036                        if (messagebox(MBOXREGULAR, "Freezer", "did you save your work?",
1037                                       " ", 0))  {
1038                          hyppo_freeze_self();
1039                          progress("Reading...", "BAM", 30);
1040                          usleep(2000000); // microseconds
1041                          midnight[side]->flags |= MIDNIGHTFLAGismounted; // try remount
1042                          midnight[side?0:1]->flags |= MIDNIGHTFLAGismounted;
1043                          midnight[side]->dirtrack = HEADERTRACK;
1044                          midnight[side]->firsttrack = FIRSTTRACK;
1045                          midnight[side]->lasttrack = LASTTRACK;
1046                          midnight[side?0:1]->dirtrack = HEADERTRACK;
1047                          midnight[side?0:1]->firsttrack = FIRSTTRACK;
1048                          midnight[side?0:1]->lasttrack = LASTTRACK;
1049                          UpdateSectors(midnight[side]->drive, side);
1050                          UpdateSectors(midnight[side?0:1]->drive, side?0:1);
1051                        }
1052                      break;
1053
1054                /* renaming not implemented on Hyppo side:
1055                          hyppo_setname(ds->name); // hyppofn->name);
1056                          fd = hyppo_findfirst();
1057                          if (fd >= 0x84)  {
1058                            messagebox(MBOXNOCANCEL, "File ", ds->name,
1059                                       "not found", 0);
1060                          } else {
1061                            input file name
1062                            hyppo_setname again
1063                            hyppo_rename(fd);
1064                          }
1065                          hyppo_closedir(fd);
1066                */
1067
1068                      case 0xf5: // ASC_F5 copy
1069                      case 0xf6: // Modifiers and ASC_F5 rename
1070                      case 0x1f6:
1071                      case 0x2f6:
1072                      case 0xf8: // Modifiers and ASC_F8 delete
1073                      case 0x1f8:
1074                      case 0x2f8:
1075                        // check for multiselect and disallow on Hyppo and multiple
1076                        // directory selections:
1077                        number = 0;
1078                        ds = getdirententry(side, midnight[side]->pos);
1079                        for (i = 0; i < NBRENTRIES; i++)  {
1080                          if (direntflags[side][i].flags & DIRFLAGSisselected)  {
1081                            // overwrite highlighted when a selection is active:
1082                            if (!(direntflags[side][midnight[side]->pos].flags &
1083                                  DIRFLAGSisselected))  {
1084                              midnight[side]->pos = i;
1085                            }
1086                            ds = getdirententry(side, i);
1087                            number++;
1088                          }
1089                        }
1090                        if (number == 0)  { // nothing selected, goes to highlighted
1091                          direntflags[side][midnight[side]->pos].flags ^= DIRFLAGSisselected;
1092                          number++;
1093                        }
1094                        // multiple selection abort criteria:
1095                        if (number > 1 &&
1096                            ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE))  {
1097                          messagebox(MBOXNOCANCEL, "Operation on mulitiple",
1098                                     "storage card files/folders",
1099                                     "is not supported.", 0);
1100                        } else if (number > 1 &&
1101                                 ((ds->type&0xf) == VAL_DOSFTYPE_CBM))  {
1102                          messagebox(MBOXNOCANCEL, "Directory operation on",
1103                                     "multiple selected entries",
1104                                     "is not supported", 0);
1105                        } else { // okay to start:
1106                          if (number > 1)  {
1107                            strcpy((char*) midnight[side]->inputstr,
1108                                   (char*) "multiple selected entries");
1109                          } else {
1110                            strcpy((char*) midnight[side]->inputstr, (char*) ds->name);
1111                          }
1112
1113                #ifdef DEBUG
1114                          msprintf("name: ");
1115                          msprintf(ds->name);
1116                          mprintf(" t=", ds->track);
1117                          mprintf(" s=", ds->sector);
1118                          mprintf(" type=", ds->type&0xf);
1119
1120                //  mh4printf("ATTICFILEBUFFER 32addr is: ", ATTICFILEBUFFER >> 16);
1121                //  mh4printf(" ", ATTICFILEBUFFER & 0xffff);
1122                          cputln();
1123                          mprintf("before copy/del type=", ds->type);
1124                          cputln();
1125                          cgetc();
1126                #endif
1127
1128                          if ((ds->type&0xf) == VAL_DOSFTYPE_DEL &&
1129                              ((midnight[side]->flags & MIDNIGHTFLAGismounted)))  {
1130                            messagebox(MBOXNOCANCEL, "File type for",
1131                                       (char *) midnight[side]->inputstr,
1132                                       "unsupported", 0);
1133                          } else if (c == 0xf5)  {  // copy
1134                            if ((ds->type&0xf) == VAL_DOSFTYPE_CBM)  {
1135                              messagebox(MBOXNOCANCEL, "Copying full directory structures",
1136                                         "is not supported.", " ", 0);
1137                            } else if (((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE) ||
1138                                       ((midnight[side?0:1]->flags & MIDNIGHTFLAGismounted) == FALSE))  {
1139                              messagebox(MBOXNOCANCEL, "Copying storage card files/folders",
1140                                         "is not supported.",
1141                                            " ", 0);
1142                //            } else if (midnight[side?0:1]->dirtrack != HEADERTRACK)  {
1143                //              messagebox(MBOXNOCANCEL, "File copy,",
1144                //                         "into subfolders currently unsupported.",
1145                //                         " ", 0);
1146                            // @@ these "if"s need to be swapped:
1147                            } else if (sizeselectcurrentifnone(side) > midnight[side?0:1]->blocksfree)  {
1148                              messagebox(MBOXNOCANCEL, "File copy,",
1149                                         "destination disk space insufficient", " ", 0);
1150                            } else if (messagebox(MBOXREGULAR, "File copy,",
1151                                       (char *) midnight[side]->inputstr,
1152                                       (side ? "from right to left" : "from left to right"),
1153                                       0)) {
1154                              for (i = 0; i < NBRENTRIES; i++)  {
1155                                if (direntflags[side][i].flags & DIRFLAGSisselected)  {
1156                                  ds = getdirententry(side, i);
1157
1158                                  progress("Reading...", "source file", 20);
1159                                  readblockchain(legacyHDOSstate, ATTICFILEBUFFER, DATABLOCKS,
1160                                                 midnight[side]->drive, ds->track, ds->sector);
1161                                  progress("Reading...", "BAM", 30);
1162                                  // write on opposing side disk:
1163                                  GetBAM(legacyHDOSstate, side?0:1);
1164                                  progress("Writing...", "destination file", 40);
1165                                  writeblockchain(legacyHDOSstate,
1166                                                  ATTICFILEBUFFER, DATABLOCKS,
1167                                                  midnight[side?0:1]->drive,
1168                                                  &starttrack, &startsector,
1169                                                  midnight[side?0:1]->dirtrack, FALSE,
1170                                                  midnight[side?0:1]->firsttrack,
1171                                                  midnight[side?0:1]->lasttrack);
1172                                  ds->track = starttrack;  // recycle src dirent for destination
1173                                  ds->sector = startsector;
1174
1175                #ifdef DEBUG
1176                                  mprintf("   before newds type=", ds->type);
1177                                  cputln();
1178                                  cgetc();
1179                #endif
1180                                  progress("Writing...", "directory", 60);
1181                                  // load opposing side dirent block into Attic:
1182                //                  midnight[side?0:1]->entries = getdirent(midnight[side?0:1]->drive, side?0:1);
1183                                  writenewdirententry(legacyHDOSstate,
1184                                                      midnight[side?0:1]->drive, side?0:1,
1185                                                      midnight[side?0:1]->dirtrack,
1186                                                      midnight[side?0:1]->firsttrack,
1187                                                      midnight[side?0:1]->lasttrack,
1188                                                      ds);
1189                                  // re-read altered dirent on opposing side after entry added:
1190                //                  midnight[side?0:1]->entries = getdirent(midnight[side?0:1]->drive, side?0:1);
1191                                  progress("Writing...", "BAM", 80);
1192                                  PutBAM(legacyHDOSstate, midnight[side?0:1]->drive, side?0:1,
1193                                         midnight[side?0:1]->dirtrack);
1194                                }
1195                              }
1196                              UpdateSectors(midnight[side?0:1]->drive, side?0:1);
1197                              Deselect(side);
1198                            }
1199                          } else if ((c == 0xf6) || (c == 0x1f6) || (c == 0x2f6))  {  // copy
1200                            for (i = 0; i < NBRENTRIES; i++)  {
1201                              if (direntflags[side][i].flags & DIRFLAGSisselected)  {
1202                                ds = getdirententry(side, i);
1203                                strcpy((char*) midnight[side]->inputstr,
1204                                       "Enter the new name, empty to skip:");
1205                                inputbox((char*) midnight[side]->inputstr,
1206                                         (char*) midnight[side]->inputstr);
1207                                if (midnight[side]->inputstr[0] != 0)  {
1208                                  strmakefilename((char*) midnight[side]->inputstr,
1209                                                  (char*) ds->name, DOSFILENAMELEN);
1210                                  lcopy((uint32_t) ds,
1211                                        ATTICDIRENTBUFFER + side * ATTICDIRENTSIZE + i * DIRENTSIZE,
1212                                        DIRENTSIZE);
1213                                  if ((ds->type&0xf) == VAL_DOSFTYPE_CBM)  {
1214                                    renamedisk(legacyHDOSstate,
1215                                               midnight[side]->drive, side,
1216                                               ds->track, // dirtrack of subpartition
1217                                               ds->name);
1218                                  }
1219                                  rewritedirent(legacyHDOSstate, midnight[side]->drive, side,
1220                                                midnight[side]->dirtrack,
1221                                                midnight[side]->firsttrack,
1222                                                midnight[side]->lasttrack);
1223                                }
1224                              }
1225                            }
1226                            UpdateSectors(midnight[side]->drive, side);
1227                            Deselect(side);
1228                          } else if ((ds->type&0xf) == VAL_DOSFTYPE_CBM &&
1229                                     (midnight[side]->entries != 0xff))  {
1230                            number = 0;
1231                            for (i = NBRENTRIES; i > 0; i--)  {
1232                              if (direntflags[side][i - 1].flags & DIRFLAGSisselected)  {
1233                                number++;
1234                              }
1235                            }
1236                            if (number > 1)  {
1237                              messagebox(MBOXNOCANCEL, "Directory delete,",
1238                                         "on multiple selected",
1239                                         "entries is not supported", 0);
1240                            // use file data buffer to peek the dir BAM:
1241                            } else if (ds->size !=
1242                                            BAMCheckSizeinFilebuffer(legacyHDOSstate,
1243                                              midnight[side]->drive, side,
1244                                              ds->track, // dirtrack
1245                                              ds->track, // firsttrack
1246                                              (ds->size / 40) + ds->track))  { // lasttrack
1247                              messagebox(MBOXNOCANCEL, "Directory delete,", ds->name,
1248                                         "directory is not empty", 0);
1249                #ifdef DEBUG
1250                              messagebox(MBOXNUMBER, "Directory delete,",
1251                                         " ",
1252                                         "ds-size=",
1253                                         ds->size);
1254                              messagebox(MBOXNUMBER, "Directory delete,",
1255                                         " ",
1256                                         "size in BAM=",
1257                                         BAMCheckSizeinFilebuffer(legacyHDOSstate,
1258                                                           midnight[side]->drive,
1259                                                           side,
1260                                                           ds->track, // dirtrack
1261                                                           ds->track, // firsttrack
1262                                                           (ds->size / 40) + ds->track));
1263                #endif
1264                            } else if (messagebox(MBOXREGULAR, "Directory delete,", ds->name,
1265                                                  (side ? "from right side" :
1266                                                          "from left side"), 0))  {
1267                              // restore BAM to finally delete:
1268                              GetBAM(legacyHDOSstate, side);
1269                //              ds->type = VAL_DOSFTYPE_DEL;
1270                              deletedirententry(legacyHDOSstate,
1271                                                midnight[side]->drive, side,
1272                                                midnight[side]->dirtrack,
1273                                                midnight[side]->pos);
1274                              PutBAM(legacyHDOSstate,
1275                                     midnight[side]->drive, side, midnight[side]->dirtrack);
1276                              UpdateSectors(midnight[side]->drive, side);
1277                              Deselect(side);
1278                            }
1279                          } else if (ds->type != VAL_DOSFTYPE_DEL &&  // file delete
1280                                     ds->size > 0)  {     // storage card dirs are size zero
1281                            if (messagebox(MBOXREGULAR, "File delete,",
1282                                           (char *) midnight[side]->inputstr,
1283                                           (side ? "from right side" : "from left side"),
1284                                           0))  {
1285                              if ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE)  {
1286                                hyppo_setname(ds->name); // hyppofn->name);  // @@@@ same
1287                                fd = hyppo_findfirst();                 // @@@@ block as below
1288                                if (fd >= 0x84)  {
1289                                  messagebox(MBOXNOCANCEL, "File ", ds->name,
1290                                             "not found", 0);
1291                                } else {
1292                                  hyppo_rmfile(fd);
1293                                }
1294                                hyppo_closedir(fd);
1295                              } else {
1296                                // size returned doesn't matter to delete:
1297                                if (sizeselectcurrentifnone(side) != UINT_MAX)  {
1298                                  for (i = NBRENTRIES; i > 0; i--)  {
1299                                    if (direntflags[side][i - 1].flags & DIRFLAGSisselected)  {
1300                                      ds = getdirententry(side, i - 1);
1301
1302                                      progress("Reading...", "BAM", 20);
1303                  //                    ds->type = VAL_DOSFTYPE_DEL;
1304                                      GetBAM(legacyHDOSstate, side);
1305                                      progress("Writing...", "removing BAM entries", 40);
1306                                      deletedirententry(legacyHDOSstate,
1307                                                        midnight[side]->drive, side,
1308                                                        midnight[side]->dirtrack, i - 1);
1309                                      progress("Writing...", "updating BAM", 80);
1310                                      PutBAM(legacyHDOSstate,
1311                                             midnight[side]->drive, side,
1312                                             midnight[side]->dirtrack);
1313                                    }
1314                                  }
1315                                }
1316                              }
1317                              UpdateSectors(midnight[side]->drive, side);
1318                              Deselect(side);
1319                            }
1320                          } else {
1321                /*
1322                            number = 0;
1323                            for (i = NBRENTRIES; i > 0; i--)  {
1324                              if (direntflags[side][i - 1].flags & DIRFLAGSisselected)  {
1325                                number++;
1326                              }
1327                            }
1328                            if (number > 1)  {
1329                              messagebox(MBOXNOCANCEL, "Directory delete,",
1330                                         "on multiple selected",
1331                                         "entries is not supported", 0);
1332                            } else 
1333                */
1334                            if (messagebox(MBOXREGULAR, "Directory structure delete,",
1335                                                  ds->name, (side ? "from right side" :
1336                                                                    "from left side"),
1337                                                  0))  {
1338                              hyppo_setname(ds->name); // hyppofn->name);  // @@@@ same
1339                              fd = hyppo_findfirst();                 // @@@@ block as below
1340                              if (fd >= 0x84)  {
1341                                messagebox(MBOXNOCANCEL, "Directory ", ds->name,
1342                                           "not found", 0);
1343                              } else {
1344                                hyppo_rmdir(fd);
1345                              }
1346                              hyppo_closedir(fd);
1347                            }
1348                            UpdateSectors(midnight[side]->drive, side);
1349                            Deselect(side);
1350                          }
1351                        }
1352                      break;
1353                #ifdef FULLFEATURES
1354                      case 0x8f6: // Mega-F5
1355                        if (((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE) ||
1356                            ((midnight[side?0:1]->flags & MIDNIGHTFLAGismounted) == FALSE))  {
1357                          messagebox(MBOXNOCANCEL, "Copying from/to storage cards",
1358                                     "is not supported.", " ", 0);
1359                        } else {
1360                          if ((midnight[side]->dirtrack == HEADERTRACK) &&
1361                               messagebox(MBOXREGULAR, "Disk copy,",
1362                                          "destination disk will be OVERWRITTEN",
1363                                          " ", 0))  {
1364                            GetBAM(legacyHDOSstate, side);
1365                            copywholedisk(legacyHDOSstate,
1366                                          midnight[side]->drive, midnight[side?0:1]->drive,
1367                                          side); // , midnight[side]->dirtrack);
1368                            UpdateSectors(midnight[side?0:1]->drive, side?0:1);
1369                          }
1370                        }
1371                      break;
1372
1373                      case 0xf7:  // F7
1374                      case 0x1f7:
1375                      case 0x2f7:
1376                        if ((midnight[side]->dirtrack != HEADERTRACK) ||
1377                            ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE))  {
1378                          messagebox(MBOXNOCANCEL, "To create a directory a disk has to",
1379                                     "be mounted and its root directory selected.",
1380                                     " ", 0);
1381                        } else {
1382                          // @@@@ to be replaced by asking name and ID:
1383                          FreeTracks(legacyHDOSstate, side,
1384                                     midnight[side]->firsttrack,
1385                                     midnight[side]->lasttrack,
1386                                     &starttrack, &endtrack, 2); // two tracks
1387                          if ((endtrack - starttrack) < 2)  {
1388                            messagebox(MBOXNOCANCEL, "Not enough tracks available",
1389                                       "to create a directory.",
1390                                       " ", 0);
1391                          } else {
1392                            number = endtrack - starttrack + 1;
1393                            strcpy((char*) midnight[side]->inputstr,
1394                                   "Enter amount of tracks 2..80, 0 to quit:");
1395                            midnight[side]->inputstr[26] = number / 10 + 0x30;
1396                            midnight[side]->inputstr[27] = number % 10 + 0x30;
1397                            inputbox((char*) midnight[side]->inputstr,
1398                                     (char*) midnight[side]->inputstr);
1399                            number = atoi((char*) midnight[side]->inputstr);
1400                            FreeTracks(legacyHDOSstate, side,
1401                                       midnight[side]->firsttrack,
1402                                       midnight[side]->lasttrack,
1403                                       &starttrack, &endtrack, number);
1404                            if (number >= 2 && (endtrack - starttrack) >= 2 &&
1405                                number <= (endtrack - starttrack + 1))  {
1406                              inputbox((char*) midnight[side]->inputstr,
1407                                       "Please enter name of the subdirectory");
1408                              endtrack = starttrack + number - 1;
1409                #ifdef DEBUG
1410                              messagebox(MBOXNUMBER, "Creating subdirectory",
1411                                         // (char *) disknames[side],
1412                                         (side ? "mounted on right side" : "mounted on left side"),
1413                                         // "number=", number))  {
1414                                         "start-/endtrack=",
1415                                         starttrack * 256 + endtrack);
1416                #endif
1417                              // First allocate BAM because the following format will use
1418                              // the BAM of the partition:
1419                              BAMAllocateTracks(legacyHDOSstate, side, starttrack, endtrack);
1420                              PutBAM(legacyHDOSstate,
1421                                     midnight[side]->drive, side, midnight[side]->dirtrack);
1422
1423                              ds->chntrack = 0;
1424                              ds->chnsector = 0;
1425                              ds->type = VAL_DOSFTYPE_CBM | 0x80;
1426                              ds->track = starttrack;  // recycle src dirent for destination
1427                              ds->sector = 0;
1428                              strmakefilename((char*) midnight[side]->inputstr,
1429                                              (char*) ds->name, DOSFILENAMELEN);
1430                              ds->size = (endtrack - starttrack) * 40; // omit dirtrack
1431                              writenewdirententry(legacyHDOSstate,
1432                                                  midnight[side]->drive, side,
1433                                                  midnight[side]->dirtrack,
1434                                                  midnight[side]->firsttrack,
1435                                                  midnight[side]->lasttrack,
1436                                                  ds);
1437                              FormatPartition(legacyHDOSstate, midnight[side]->drive, side,
1438                                              starttrack, // midnight[side]->dirtrack,
1439                                              starttrack, // midnight[side]->firsttrack,
1440                                              endtrack,   // midnight[side]->lasttrack);
1441                                              (char*) ds->name);
1442
1443                              UpdateSectors(midnight[side]->drive, side);
1444                              Deselect(side);
1445                            } else {
1446                              if (number > 0)  {
1447                                messagebox(MBOXNOCANCEL, "No space to create a",
1448                                           "subdirectory.",
1449                                           " ", 0);
1450                              }
1451                            }
1452                          }
1453                        }
1454                      break;
1455
1456                      case 0x8f8: // Mega-F7
1457                        if ((midnight[side]->dirtrack != HEADERTRACK) ||
1458                            ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE))  {
1459                          messagebox(MBOXNOCANCEL, "The to be formatted disk/image file has to",
1460                                     "be mounted and its root directory selected.",
1461                                     " ", 0);
1462                        } else {
1463                          // @@@@ to be replaced by asking name and ID:
1464                          if (messagebox(MBOXREGULAR, "Disk will be quickformatted",
1465                                         (char *) disknames[side],
1466                                         (side ? "mounted on right side" :
1467                                                 "mounted on left side"),
1468                                         0))  {
1469                            inputbox((char*) midnight[side]->inputstr,
1470                                     "Please enter the disk's name");
1471                            strmakefilename((char*) midnight[side]->inputstr,
1472                                            (char*) midnight[side]->inputstr, DOSFILENAMELEN);
1473                            FormatPartition(legacyHDOSstate, midnight[side]->drive, side,
1474                                            midnight[side]->dirtrack,
1475                                            midnight[side]->firsttrack,
1476                                            midnight[side]->lasttrack,
1477                                            (char*) midnight[side]->inputstr);
1478
1479                            UpdateSectors(midnight[side]->drive, side);
1480                            Deselect(side);
1481                          }
1482                        }
1483                      break;
1484
1485                      case 0x8fa: // Mega-F9
1486                        rombox();
    \ 019d 20....               jsr     rombox
1487                      break;
    \ 01a0 4c....               jmp     `?L325`
    \ 01a3          `?L403`:
    \ 01a3 a5..                 lda     zp:_Zp+24
    \ 01a5 20....               jsr     `?L1908`
    \ 01a8 a047                 ldy     #71
    \ 01aa b1..                 lda     (_Zp),y
    \ 01ac c928                 cmp     #40
    \ 01ae d3b600               lbne    `?L588`
    \ 01b1 a5..                 lda     zp:_Zp+24
    \ 01b3 20....               jsr     `?L1908`
    \ 01b6 20....               jsr     `?L1942`
    \ 01b9 f3ab00               lbeq    `?L588`
    \ 01bc a5..                 lda     zp:_Zp+24
    \ 01be d008                 bne     `?L803`
    \ 01c0 a9..                 lda     #.byte0 `_StringLiteral_mounted on left side`
    \ 01c2 85..                 sta     zp:_Zp+4
    \ 01c4 a9..                 lda     #.byte1 `_StringLiteral_mounted on left side`
    \ 01c6 8006                 bra     `?L1839`
    \ 01c8          `?L803`:
    \ 01c8 a9..                 lda     #.byte0 `_StringLiteral_mounted on right side`
    \ 01ca 85..                 sta     zp:_Zp+4
    \ 01cc a9..                 lda     #.byte1 `_StringLiteral_mounted on right side`
    \ 01ce          `?L1839`:
    \ 01ce 85..                 sta     zp:_Zp+5
    \ 01d0 a6..                 ldx     zp:_Zp+24
    \ 01d2 86..                 stx     zp:_Zp+2
    \ 01d4 a900                 lda     #0
    \ 01d6 20....               jsr     `?L1924`
    \ 01d9 85..                 sta     zp:_Zp
    \ 01db 20....               jsr     `?L1909`
    \ 01de a5..                 lda     zp:_Zp
    \ 01e0 18                   clc
    \ 01e1 69..                 adc     #.byte0 disknames
    \ 01e3 85..                 sta     zp:_Zp+2
    \ 01e5 98                   tya
    \ 01e6 69..                 adc     #.byte1 disknames
    \ 01e8 85..                 sta     zp:_Zp+3
    \ 01ea a9..                 lda     #.byte0 `_StringLiteral_Disk will be quickformatted`
    \ 01ec 85..                 sta     zp:_Zp
    \ 01ee a9..                 lda     #.byte1 `_StringLiteral_Disk will be quickformatted`
    \ 01f0 20....               jsr     `?L1934`
    \ 01f3 20....               jsr     `?L1915`
    \ 01f6 aa                   tax
    \ 01f7 f31aff               lbeq    `?L325`
    \ 01fa a9..                 lda     #.byte0 `_StringLiteral_Please enter the disk's name`
    \ 01fc 85..                 sta     zp:_Zp+2
    \ 01fe a9..                 lda     #.byte1 `_StringLiteral_Please enter the disk's name`
    \ 0200 20....               jsr     `?L1941`
    \ 0203 a94a                 lda     #74
    \ 0205 20....               jsr     `?L1914`
    \ 0208 20....               jsr     inputbox
    \ 020b 20....               jsr     `?L1933`
    \ 020e a900                 lda     #0
    \ 0210 7d....               adc     midnight+1,x
    \ 0213 20....               jsr     `?L1941`
    \ 0216 a94a                 lda     #74
    \ 0218 20....               jsr     `?L1914`
    \ 021b 20....               jsr     `?L2067`
    \ 021e a5..                 lda     zp:_Zp+24
    \ 0220 0a                   asl     a
    \ 0221 aa                   tax
    \ 0222 18                   clc
    \ 0223 a94a                 lda     #74
    \ 0225 7d....               adc     midnight,x
    \ 0228 85..                 sta     zp:_Zp+6
    \ 022a a900                 lda     #0
    \ 022c 7d....               adc     midnight+1,x
    \ 022f 85..                 sta     zp:_Zp+7
    \ 0231 a5..                 lda     zp:_Zp+24
    \ 0233 20....               jsr     `?L1908`
    \ 0236 a049                 ldy     #73
    \ 0238 b1..                 lda     (_Zp),y
    \ 023a 85..                 sta     zp:_Zp+4
    \ 023c a5..                 lda     zp:_Zp+24
    \ 023e 20....               jsr     `?L1908`
    \ 0241 88                   dey
    \ 0242 b1..                 lda     (_Zp),y
    \ 0244 85..                 sta     zp:_Zp+3
    \ 0246 a5..                 lda     zp:_Zp+24
    \ 0248 20....               jsr     `?L1908`
    \ 024b 88                   dey
    \ 024c b1..                 lda     (_Zp),y
    \ 024e 20....               jsr     `?L1939`
    \ 0251 b1..                 lda     (_Zp+8),y
    \ 0253 20....               jsr     `?L1921`
    \ 0256 20....               jsr     FormatPartition
    \ 0259 a5..                 lda     zp:_Zp+24
    \ 025b 85..                 sta     zp:_Zp
    \ 025d 20....               jsr     `?L1913`
    \ 0260 20....               jsr     `?L1954`
    \ 0263 4c....               jmp     `?L325`
    \ 0266          `?L588`:
    \ 0266 20....               jsr     `?L1909`
    \ 0269 20....               jsr     `?L1922`
    \ 026c a9..                 lda     #.byte0 `_StringLiteral_be mounted and its root directory selected.`
    \ 026e 85..                 sta     zp:_Zp+2
    \ 0270 a9..                 lda     #.byte1 `_StringLiteral_be mounted and its root directory selected.`
    \ 0272 85..                 sta     zp:_Zp+3
    \ 0274 a9..                 lda     #.byte0 `_StringLiteral_The to be formatted disk/image file has to`
    \ 0276 85..                 sta     zp:_Zp
    \ 0278 a9..                 lda     #.byte1 `_StringLiteral_The to be formatted disk/image file has to`
    \ 027a 85..                 sta     zp:_Zp+1
    \ 027c a904                 lda     #4
    \ 027e 20....               jsr     `?L1915`
    \ 0281 4c....               jmp     `?L325`
    \ 0284          `?L407`:
    \ 0284 a5..                 lda     zp:_Zp+24
    \ 0286 20....               jsr     `?L1908`
    \ 0289 20....               jsr     `?L1942`
    \ 028c f39900               lbeq    `?L568`
    \ 028f a5..                 lda     zp:_Zp+24
    \ 0291 d004                 bne     `?L694`
    \ 0293 a901                 lda     #1
    \ 0295 8002                 bra     `?L1871`
    \ 0297 a900     `?L694`:    lda     #0
    \ 0299          `?L1871`:
    \ 0299 85..                 sta     zp:_Zp
    \ 029b a5..                 lda     zp:_Zp
    \ 029d 20....               jsr     `?L1908`
    \ 02a0 a901                 lda     #1
    \ 02a2 32..                 and     (_Zp),z
    \ 02a4 f38100               lbeq    `?L568`
    \ 02a7 a5..                 lda     zp:_Zp+24
    \ 02a9 20....               jsr     `?L1908`
    \ 02ac a047                 ldy     #71
    \ 02ae b1..                 lda     (_Zp),y
    \ 02b0 c928                 cmp     #40
    \ 02b2 d35ffe               lbne    `?L325`
    \ 02b5 20....               jsr     `?L1909`
    \ 02b8 20....               jsr     `?L1922`
    \ 02bb a9..                 lda     #.byte0 `_StringLiteral_destination disk will be OVERWRITTEN`
    \ 02bd 85..                 sta     zp:_Zp+2
    \ 02bf a9..                 lda     #.byte1 `_StringLiteral_destination disk will be OVERWRITTEN`
    \ 02c1 85..                 sta     zp:_Zp+3
    \ 02c3 a9..                 lda     #.byte0 `_StringLiteral_Disk copy,`
    \ 02c5 85..                 sta     zp:_Zp
    \ 02c7 a9..                 lda     #.byte1 `_StringLiteral_Disk copy,`
    \ 02c9 20....               jsr     `?L1934`
    \ 02cc 20....               jsr     `?L1915`
    \ 02cf aa                   tax
    \ 02d0 f341fe               lbeq    `?L325`
    \ 02d3 a5..                 lda     zp:_Zp+24
    \ 02d5 20....               jsr     `?L1921`
    \ 02d8 20....               jsr     GetBAM
    \ 02db a5..                 lda     zp:_Zp+24
    \ 02dd d004                 bne     `?L792`
    \ 02df a901                 lda     #1
    \ 02e1 8002                 bra     `?L1842`
    \ 02e3 a900     `?L792`:    lda     #0
    \ 02e5          `?L1842`:
    \ 02e5 85..                 sta     zp:_Zp
    \ 02e7 a5..                 lda     zp:_Zp+24
    \ 02e9 85..                 sta     zp:_Zp+2
    \ 02eb a5..                 lda     zp:_Zp
    \ 02ed 20....               jsr     `?L1908`
    \ 02f0 a000                 ldy     #0
    \ 02f2 20....               jsr     `?L2036`
    \ 02f5 0a                   asl     a
    \ 02f6 aa                   tax
    \ 02f7 bd....               lda     midnight,x
    \ 02fa 85..                 sta     zp:_Zp+4
    \ 02fc bd....               lda     midnight+1,x
    \ 02ff 85..                 sta     zp:_Zp+5
    \ 0301 20....               jsr     `?L1920`
    \ 0304 20....               jsr     copywholedisk
    \ 0307 a5..                 lda     zp:_Zp+24
    \ 0309 d004                 bne     `?L795`
    \ 030b a901                 lda     #1
    \ 030d 8002                 bra     `?L1841`
    \ 030f a900     `?L795`:    lda     #0
    \ 0311          `?L1841`:
    \ 0311 85..                 sta     zp:_Zp+2
    \ 0313 a5..                 lda     zp:_Zp+24
    \ 0315 d004                 bne     `?L798`
    \ 0317 a901                 lda     #1
    \ 0319 8002                 bra     `?L1840`
    \ 031b a900     `?L798`:    lda     #0
    \ 031d          `?L1840`:
    \ 031d 85..                 sta     zp:_Zp
    \ 031f a5..                 lda     zp:_Zp+2
    \ 0321 20....               jsr     `?L1913`
    \ 0324 4c....               jmp     `?L325`
    \ 0327          `?L568`:
    \ 0327 20....               jsr     `?L1909`
    \ 032a 20....               jsr     `?L1922`
    \ 032d a9..                 lda     #.byte0 `_StringLiteral_is not supported.`
    \ 032f 20....               jsr     `?L2062`
    \ 0332 a9..                 lda     #.byte0 `_StringLiteral_Copying from/to storage cards`
    \ 0334 85..                 sta     zp:_Zp
    \ 0336 a9..                 lda     #.byte1 `_StringLiteral_Copying from/to storage cards`
    \ 0338 85..                 sta     zp:_Zp+1
    \ 033a a904                 lda     #4
    \ 033c 20....               jsr     `?L1915`
    \ 033f 4c....               jmp     `?L325`
    \ 0342          `?L415`:
    \ 0342 20....               jsr     `?L1909`
    \ 0345 20....               jsr     `?L1922`
    \ 0348 a9..                 lda     #.byte0 `_StringLiteral_did you save your work?`
    \ 034a 85..                 sta     zp:_Zp+2
    \ 034c a9..                 lda     #.byte1 `_StringLiteral_did you save your work?`
    \ 034e 85..                 sta     zp:_Zp+3
    \ 0350 a9..                 lda     #.byte0 _StringLiteral_Freezer
    \ 0352 85..                 sta     zp:_Zp
    \ 0354 a9..                 lda     #.byte1 _StringLiteral_Freezer
    \ 0356 20....               jsr     `?L1934`
    \ 0359 20....               jsr     `?L1915`
    \ 035c aa                   tax
    \ 035d f3b4fd               lbeq    `?L325`
    \ 0360 20....               jsr     hyppo_freeze_self
    \ 0363 20....               jsr     `?L1937`
    \ 0366 a91e                 lda     #30
    \ 0368 20....               jsr     progress
    \ 036b a980                 lda     #128
    \ 036d a284                 ldx     #132
    \ 036f a01e                 ldy     #30
    \ 0371 a300                 ldz     #0
    \ 0373 424285..             stq     zp:_Zp
    \ 0377 20....               jsr     usleep
    \ 037a a5..                 lda     zp:_Zp+24
    \ 037c 0a                   asl     a
    \ 037d aa                   tax
    \ 037e 18                   clc
    \ 037f a946                 lda     #70
    \ 0381 20....               jsr     `?L1914`
    \ 0384 20....               jsr     `?L1955`
    \ 0387 a5..                 lda     zp:_Zp+24
    \ 0389 d004                 bne     `?L702`
    \ 038b a901                 lda     #1
    \ 038d 8001                 bra     `?L1869`
    \ 038f 6b       `?L702`:    tza
    \ 0390          `?L1869`:
    \ 0390 85..                 sta     zp:_Zp
    \ 0392 a5..                 lda     zp:_Zp
    \ 0394 0a                   asl     a
    \ 0395 aa                   tax
    \ 0396 18                   clc
    \ 0397 a946                 lda     #70
    \ 0399 7d....               adc     midnight,x
    \ 039c 85..                 sta     zp:_Zp
    \ 039e 6b                   tza
    \ 039f 7d....               adc     midnight+1,x
    \ 03a2 85..                 sta     zp:_Zp+1
    \ 03a4 a901                 lda     #1
    \ 03a6 12..                 ora     (_Zp),z
    \ 03a8 92..                 sta     (_Zp),z
    \ 03aa a5..                 lda     zp:_Zp+24
    \ 03ac 20....               jsr     `?L1908`
    \ 03af a928                 lda     #40
    \ 03b1 20....               jsr     `?L1988`
    \ 03b4 20....               jsr     `?L1908`
    \ 03b7 a901                 lda     #1
    \ 03b9 c8                   iny
    \ 03ba 20....               jsr     `?L1989`
    \ 03bd 20....               jsr     `?L1908`
    \ 03c0 a950                 lda     #80
    \ 03c2 c8                   iny
    \ 03c3 91..                 sta     (_Zp),y
    \ 03c5 a5..                 lda     zp:_Zp+24
    \ 03c7 d004                 bne     `?L705`
    \ 03c9 a901                 lda     #1
    \ 03cb 8001                 bra     `?L1868`
    \ 03cd 6b       `?L705`:    tza
    \ 03ce          `?L1868`:
    \ 03ce 85..                 sta     zp:_Zp
    \ 03d0 a5..                 lda     zp:_Zp
    \ 03d2 20....               jsr     `?L1908`
    \ 03d5 a928                 lda     #40
    \ 03d7 a047                 ldy     #71
    \ 03d9 91..                 sta     (_Zp),y
    \ 03db a5..                 lda     zp:_Zp+24
    \ 03dd d004                 bne     `?L708`
    \ 03df a901                 lda     #1
    \ 03e1 8001                 bra     `?L1867`
    \ 03e3 6b       `?L708`:    tza
    \ 03e4          `?L1867`:
    \ 03e4 85..                 sta     zp:_Zp
    \ 03e6 a5..                 lda     zp:_Zp
    \ 03e8 20....               jsr     `?L1908`
    \ 03eb a901                 lda     #1
    \ 03ed c8                   iny
    \ 03ee 91..                 sta     (_Zp),y
    \ 03f0 a5..                 lda     zp:_Zp+24
    \ 03f2 d004                 bne     `?L711`
    \ 03f4 a901                 lda     #1
    \ 03f6 8001                 bra     `?L1866`
    \ 03f8 6b       `?L711`:    tza
    \ 03f9          `?L1866`:
    \ 03f9 85..                 sta     zp:_Zp
    \ 03fb a5..                 lda     zp:_Zp
    \ 03fd 20....               jsr     `?L1908`
    \ 0400 a950                 lda     #80
    \ 0402 c8                   iny
    \ 0403 20....               jsr     `?L1989`
    \ 0406 85..                 sta     zp:_Zp
    \ 0408 20....               jsr     `?L1913`
    \ 040b a5..                 lda     zp:_Zp+24
    \ 040d d004                 bne     `?L714`
    \ 040f a901                 lda     #1
    \ 0411 8002                 bra     `?L1865`
    \ 0413 a900     `?L714`:    lda     #0
    \ 0415          `?L1865`:
    \ 0415 85..                 sta     zp:_Zp+2
    \ 0417 a5..                 lda     zp:_Zp+24
    \ 0419 d004                 bne     `?L717`
    \ 041b a901                 lda     #1
    \ 041d 8002                 bra     `?L1864`
    \ 041f a900     `?L717`:    lda     #0
    \ 0421          `?L1864`:
    \ 0421 85..                 sta     zp:_Zp
    \ 0423 a5..                 lda     zp:_Zp+2
    \ 0425 20....               jsr     `?L1913`
    \ 0428 4c....               jmp     `?L325`
    \ 042b          `?L399`:
1488                #endif
1489                      case 0xf9:
1490                        shortcuts(20, 0);
1491                        if (menubox(side))  {
1492                          messagebox(MBOXFALLTHROUGH, " ", " ", " ", 0);
1493                          progress("Reading...", "BAM", 20);
1494                          UpdateSectors(midnight[side]->drive, side);
1495                          Deselect(side);
1496                          UpdateSectors(midnight[side?0:1]->drive, side?0:1);
1497                          Deselect(side?0:1);
1498                        }
1499                      break;
1500
1501                      case 0xfb: // F11
1502                        if (legacyHDOSstate)  {
1503                /*
1504                  unsigned char majorhyppo;
1505                  unsigned char minorhyppo;
1506                  unsigned char majorHDOS;
1507                  unsigned char minorHDOS;
1508                  hyppo_getversion(&majorhyppo, &minorhyppo, &majorHDOS, &minorHDOS);
1509                          unsigned char clear = 1;
1510                          unsigned char shadow = 1;
1511
1512                          mcbox(20, 15, 70, 19, COLOUR_CYAN, BOX_STYLE_INNER, clear, shadow);
1513                          gotoxy(24, 17);
1514                          mprintf(" Hyppo v", majorhyppo);
1515                          mprintf(".", minorhyppo);
1516                          mprintf(" HDOS v", majorHDOS);
1517                          mprintf(".", minorHDOS);
1518                */
1519                          messagebox(MBOXNOCANCEL,
1520                                     "Your version of the Hyppo/HDOS is too old",
1521                                     "to unmount drives.",
1522                                     "Press RETURN or STOP to continue.", 0);
1523                        } else {
1524                          if (messagebox(MBOXREGULAR, "Unmount",
1525                                         (side ? "right drive?" : "left drive?"), " ", 0))  {
1526                            hyppo_dos_attach(0b10000000 + midnight[side]->drive); // hyppo_d81detach();
1527                            midnight[side]->flags |= MIDNIGHTFLAGismounted;
1528                            midnight[side]->dirtrack = HEADERTRACK;
1529                            midnight[side]->firsttrack = FIRSTTRACK;
1530                            midnight[side]->lasttrack = LASTTRACK;
1531                            UpdateSectors(midnight[side]->drive, side);
1532                            Deselect(side);
1533                          }
1534                        }
1535                      break;
1536
1537                      case 0x412: // Ctrl-r
1538                        midnight[side]->flags |= MIDNIGHTFLAGismounted;
    \ 042b a5..                 lda     zp:_Zp+24
    \ 042d 0a                   asl     a
    \ 042e aa                   tax
    \ 042f 18                   clc
    \ 0430 a946                 lda     #70
1539                        midnight[side]->dirtrack = HEADERTRACK;
1540                        midnight[side]->firsttrack = FIRSTTRACK;
1541                        midnight[side]->lasttrack = LASTTRACK;
1542                        UpdateSectors(midnight[side]->drive, side);
    \ 0432 20....               jsr     `?L1914`
    \ 0435 20....               jsr     `?L1955`
    \ 0438 a5..                 lda     zp:_Zp+24
    \ 043a 20....               jsr     `?L1908`
    \ 043d a928                 lda     #40
    \ 043f 20....               jsr     `?L1988`
    \ 0442 20....               jsr     `?L1908`
    \ 0445 a901                 lda     #1
    \ 0447 c8                   iny
    \ 0448 20....               jsr     `?L1989`
    \ 044b 20....               jsr     `?L1908`
    \ 044e a950                 lda     #80
    \ 0450 c8                   iny
    \ 0451 20....               jsr     `?L1989`
    \ 0454 85..                 sta     zp:_Zp
    \ 0456 20....               jsr     `?L1913`
1543                        Deselect(side);
    \ 0459 20....               jsr     `?L1954`
1544                      break;
    \ 045c 4c....               jmp     `?L325`
    \ 045f          `?L400`:
    \ 045f ad....               lda     legacyHDOSstate
    \ 0462 f01c                 beq     `?L598`
    \ 0464 20....               jsr     `?L1909`
    \ 0467 a9..                 lda     #.byte0 `_StringLiteral_Press RETURN or STOP to continue.`
    \ 0469 85..                 sta     zp:_Zp+4
    \ 046b a9..                 lda     #.byte1 `_StringLiteral_Press RETURN or STOP to continue.`
    \ 046d 85..                 sta     zp:_Zp+5
    \ 046f a9..                 lda     #.byte0 `_StringLiteral_to unmount drives.`
    \ 0471 85..                 sta     zp:_Zp+2
    \ 0473 a9..                 lda     #.byte1 `_StringLiteral_to unmount drives.`
    \ 0475 85..                 sta     zp:_Zp+3
    \ 0477 a9..                 lda     #.byte0 `_StringLiteral_Your version of the Hyppo/HDOS is too old`
    \ 0479 85..                 sta     zp:_Zp
    \ 047b a9..                 lda     #.byte1 `_StringLiteral_Your version of the Hyppo/HDOS is too old`
    \ 047d 4c....               jmp     `?L1904`
    \ 0480          `?L598`:
    \ 0480 a5..                 lda     zp:_Zp+24
    \ 0482 d008                 bne     `?L815`
    \ 0484 a9..                 lda     #.byte0 `_StringLiteral_left drive?`
    \ 0486 85..                 sta     zp:_Zp+2
    \ 0488 a9..                 lda     #.byte1 `_StringLiteral_left drive?`
    \ 048a 8006                 bra     `?L1835`
    \ 048c          `?L815`:
    \ 048c a9..                 lda     #.byte0 `_StringLiteral_right drive?`
    \ 048e 85..                 sta     zp:_Zp+2
    \ 0490 a9..                 lda     #.byte1 `_StringLiteral_right drive?`
    \ 0492          `?L1835`:
    \ 0492 85..                 sta     zp:_Zp+3
    \ 0494 20....               jsr     `?L1909`
    \ 0497 20....               jsr     `?L1922`
    \ 049a a9..                 lda     #.byte0 _StringLiteral_Unmount
    \ 049c 85..                 sta     zp:_Zp
    \ 049e a9..                 lda     #.byte1 _StringLiteral_Unmount
    \ 04a0 20....               jsr     `?L1934`
    \ 04a3 20....               jsr     `?L1915`
    \ 04a6 aa                   tax
    \ 04a7 f36afc               lbeq    `?L325`
    \ 04aa a5..                 lda     zp:_Zp+24
    \ 04ac 20....               jsr     `?L1908`
    \ 04af a980                 lda     #-128
    \ 04b1 a300                 ldz     #0
    \ 04b3 18                   clc
    \ 04b4 72..                 adc     (_Zp),z
    \ 04b6 20....               jsr     hyppo_dos_attach
    \ 04b9 a5..                 lda     zp:_Zp+24
    \ 04bb 0a                   asl     a
    \ 04bc aa                   tax
    \ 04bd 18                   clc
    \ 04be a946                 lda     #70
    \ 04c0 20....               jsr     `?L1914`
    \ 04c3 20....               jsr     `?L1955`
    \ 04c6 a5..                 lda     zp:_Zp+24
    \ 04c8 20....               jsr     `?L1908`
    \ 04cb a928                 lda     #40
    \ 04cd 20....               jsr     `?L1988`
    \ 04d0 20....               jsr     `?L1908`
    \ 04d3 a901                 lda     #1
    \ 04d5 c8                   iny
    \ 04d6 20....               jsr     `?L1989`
    \ 04d9 20....               jsr     `?L1908`
    \ 04dc a950                 lda     #80
    \ 04de c8                   iny
    \ 04df 20....               jsr     `?L1989`
    \ 04e2 85..                 sta     zp:_Zp
    \ 04e4 20....               jsr     `?L1913`
    \ 04e7 a5..                 lda     zp:_Zp+24
    \ 04e9 806f                 bra     `?L1892`
    \ 04eb          `?L378`:
1545
1546                      case 0x5f: // left (for updir)
1547                      case 3:    // STOP
1548                      case 27:   // Esc
1549                        if ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE)  {
1550                          for (i = 0; i <= midnight[side]->entries; i++)  {
1551                            ds = getdirententry(side, i);
1552                            
1553                            if ((ds->type & HYPPODIRENTATTRDIR) &&
1554                                (ds->name[0] == '.' && ds->name[1] == '.'))  {
1555                              hyppo_setname((char *) ds->name);
1556                              attachresult = hyppo_chdir();
1557
1558                              if (attachresult > 0xf)  {  // @@ better error handling in Hyppo reqd
1559                                messagebox(MBOXNOCANCEL, "Storage card parent directory,",
1560                                           "open failed for", (char *) ds->name, 0);
1561                              } else {
1562                                UpdateSectors(midnight[side]->drive, side);
1563                                Deselect(side);
1564                              }
1565                            }
1566                          }
1567                        } else {
1568                          midnight[side]->dirtrack = HEADERTRACK;
1569                          midnight[side]->firsttrack = FIRSTTRACK;
1570                          midnight[side]->lasttrack = LASTTRACK;
1571                          UpdateSectors(midnight[side]->drive, side);
1572                          Deselect(side);
1573                        }
1574                      break;
1575
1576                      case 0x20: // Space to toggle
1577                      case 0x194: // Shift-Inst
1578                      case 0x294:
1579                        if ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE)  {
1580                          sidbong();
1581                        } else {
1582                          direntflags[side][midnight[side]->pos].flags ^= DIRFLAGSisselected;
1583                          if (!(midnight[side]->flags & MIDNIGHTFLAGdirsortactive))  {
1584                            midnight[side]->pos++;
1585                          }
1586                        }
1587                      break;
1588
1589                      case 13: // return
1590                        ds = getdirententry(side, midnight[side]->pos);
1591                        lcopy(ATTICLFNBUFFER + side * ATTICLFNBUFFERSIZE + midnight[side]->pos * LFNFILENAMELEN,
1592                             (uint32_t) lfnname,
1593                             LFNFILENAMELEN);
1594
1595                        if ((midnight[side]->flags & MIDNIGHTFLAGismounted) == FALSE)  {
1596                          if (ds->type & HYPPODIRENTATTRDIR)  {
1597                            hyppo_setname((char*) lfnname);  // ds->name);
1598                            attachresult = hyppo_chdir();
1599
1600                            if (attachresult > 0xf)  {  // @@ better error handling in Hyppo reqd
1601                              messagebox(MBOXNOCANCEL, "Storage card change directory,",
1602                                         "open failed for", (char *) ds->name, 0);
1603                            } else {
1604                              UpdateSectors(midnight[side]->drive, side);
1605                              Deselect(side);
1606                            }        
1607                          } else {
1608                            // @@@@ currently trying to mount everything that is not a dir:
1609                            if (midnight[side]->drive)  {
1610                              hyppo_setname((char *) lfnname); // (char *) ds->name);
1611                              attachresult = (legacyHDOSstate ? hyppo_d81attach1() : hyppo_dos_attach(1));
1612                            } else {
1613                              hyppo_setname((char *) lfnname); // (char *) ds->name);
1614                              attachresult = (legacyHDOSstate ? hyppo_d81attach0() : hyppo_dos_attach(0));
1615                            }
1616
1617                            if (attachresult > 0x4a)  { // @@@@ to be reviewed
1618                              messagebox(MBOXNOCANCEL, "Storage card mounting,",
1619                                         "mount failed for",
1620                                         (char *) lfnname, 0); // ds->name, 0);
1621                            } else {
1622                              midnight[side]->flags |= MIDNIGHTFLAGismounted;
1623                              UpdateSectors(midnight[side]->drive, side);
1624                              Deselect(side);
1625                            }
1626                          }
1627                        } else {
1628                          if ((ds->type&0xf) == VAL_DOSFTYPE_CBM &&
1629                              (midnight[side]->entries != 0xff))  {
1630                            midnight[side]->dirtrack = ds->track;
1631                            midnight[side]->firsttrack = ds->track;
1632                            midnight[side]->lasttrack = (ds->size / 40) + ds->track;
1633                            UpdateSectors(midnight[side]->drive, side);
1634                            Deselect(side);
1635                          } else {
1636                            sidbong();
1637                            if (midnight[side]->entries != 0xff)  {
1638                              messagebox(MBOXNOCANCEL, "This file type/directory",
1639                                         "is not yet implemented.", " ", 0);
1640                            }
1641                          }
1642                        }
1643                      break;
1644                #ifdef FULLFEATURES
1645                      case 0x1f: // HELP
1646                      case 0xf1: // unused F keys
1647                      case 0x1f1:
1648                      case 0x2f1:
1649                        shortcuts(20, 0);
1650                        helpbox();
1651                      break;
1652                #endif
1653                      case 0xf3:
1654                      case 0x1f3:
1655                      case 0x2f3:
1656                      case 0xf4:
1657                      case 0x1f4:
1658                      case 0x2f4:
1659                      case 0x415: // Ctrl-u
1660                        sidbong();
1661                //        messagebox(MBOXNOCANCEL, "Some function keys,",
1662                //                   "are not yet implemented.", " ");
1663                      break;
1664
1665                      // case 0xF9: // ASC_F9:
1666                      case 0xFA: // Modifiers and ASC_F9:
1667                      case 0x1FA:
1668                      case 0x2FA:
1669                        if (getkeymodstate() == KEYMOD_RSHIFT || getkeymodstate() == KEYMOD_LSHIFT)  {
    \ 04eb 20....               jsr     getkeymodstate
    \ 04ee 3a                   dec     a
    \ 04ef f30111               lbeq    `?L300`
    \ 04f2 20....               jsr     getkeymodstate
    \ 04f5 c902                 cmp     #2
    \ 04f7 d31afc               lbne    `?L325`
1670                          return;
    \ 04fa 4c....               jmp     `?L300`
    \ 04fd          `?L401`:
    \ 04fd 20....               jsr     `?L1992`
    \ 0500 a5..                 lda     zp:_Zp+24
    \ 0502 20....               jsr     menubox
    \ 0505 aa                   tax
    \ 0506 f30bfc               lbeq    `?L325`
    \ 0509 20....               jsr     `?L1909`
    \ 050c 20....               jsr     `?L1922`
    \ 050f a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 0511 85..                 sta     zp:_Zp+2
    \ 0513 a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 0515 85..                 sta     zp:_Zp+3
    \ 0517 20....               jsr     `?L2032`
    \ 051a a902                 lda     #2
    \ 051c 20....               jsr     `?L1915`
    \ 051f 20....               jsr     `?L1937`
    \ 0522 20....               jsr     `?L2068`
    \ 0525 a5..                 lda     zp:_Zp+24
    \ 0527 85..                 sta     zp:_Zp
    \ 0529 20....               jsr     `?L1913`
    \ 052c 20....               jsr     `?L1954`
    \ 052f a5..                 lda     zp:_Zp+24
    \ 0531 d004                 bne     `?L806`
    \ 0533 a901                 lda     #1
    \ 0535 8002                 bra     `?L1838`
    \ 0537 a900     `?L806`:    lda     #0
    \ 0539          `?L1838`:
    \ 0539 85..                 sta     zp:_Zp+2
    \ 053b a5..                 lda     zp:_Zp+24
    \ 053d d004                 bne     `?L809`
    \ 053f a901                 lda     #1
    \ 0541 8002                 bra     `?L1837`
    \ 0543 a900     `?L809`:    lda     #0
    \ 0545          `?L1837`:
    \ 0545 85..                 sta     zp:_Zp
    \ 0547 a5..                 lda     zp:_Zp+2
    \ 0549 20....               jsr     `?L1913`
    \ 054c a5..                 lda     zp:_Zp+24
    \ 054e d004                 bne     `?L812`
    \ 0550 a901                 lda     #1
    \ 0552 8002                 bra     `?L1836`
    \ 0554 a900     `?L812`:    lda     #0
    \ 0556          `?L1836`:
    \ 0556 85..                 sta     zp:_Zp
    \ 0558 a5..                 lda     zp:_Zp
    \ 055a          `?L1892`:
1671                        }
1672                      break;
1673                      
1674                      case 0xFF: // bong preventing
1675                      break;
1676
1677                      default:
1678                        sidbong();
1679                        /*
1680                        gotoxy(0, 0); // @@ To get debug output from top left
1681                        mh4printf("val=", c);
1682                        cputc('  ');
1683                        usleep(2000000); // microseconds
1684                        */
1685                      break;
    \ 055a 20....               jsr     Deselect
    \ 055d 4c....               jmp     `?L325`
    \ 0560          `?L404`:
    \ 0560 a5..                 lda     zp:_Zp+24
    \ 0562 20....               jsr     `?L1908`
    \ 0565 a047                 ldy     #71
    \ 0567 b1..                 lda     (_Zp),y
    \ 0569 c928                 cmp     #40
    \ 056b d35302               lbne    `?L575`
    \ 056e a5..                 lda     zp:_Zp+24
    \ 0570 20....               jsr     `?L1908`
    \ 0573 20....               jsr     `?L1942`
    \ 0576 f34802               lbeq    `?L575`
    \ 0579 20....               jsr     `?L2004`
    \ 057c a902                 lda     #2
    \ 057e 85..                 sta     zp:_Zp+3
    \ 0580 a5..                 lda     zp:_Zp+24
    \ 0582 20....               jsr     `?L1908`
    \ 0585 a049                 ldy     #73
    \ 0587 b1..                 lda     (_Zp),y
    \ 0589 85..                 sta     zp:_Zp+2
    \ 058b a5..                 lda     zp:_Zp+24
    \ 058d 20....               jsr     `?L1908`
    \ 0590 88                   dey
    \ 0591 20....               jsr     `?L2036`
    \ 0594 20....               jsr     `?L1921`
    \ 0597 20....               jsr     FreeTracks
    \ 059a a001                 ldy     #1
    \ 059c 20....               jsr     `?L1945`
    \ 059f 85..                 sta     zp:_Zp
    \ 05a1 b002                 bcs     `?L1521`
    \ 05a3 c6..                 dec     zp:_Zp+1
    \ 05a5          `?L1521`:
    \ 05a5 20....               jsr     `?L2065`
    \ 05a8 5002                 bvc     `?L1523`
    \ 05aa 4980                 eor     #-128
    \ 05ac 101e     `?L1523`:   bpl     `?L576`
    \ 05ae 20....               jsr     `?L1909`
    \ 05b1 20....               jsr     `?L1922`
    \ 05b4 a9..                 lda     #.byte0 `_StringLiteral_to create a directory.`
    \ 05b6 85..                 sta     zp:_Zp+2
    \ 05b8 a9..                 lda     #.byte1 `_StringLiteral_to create a directory.`
    \ 05ba 85..                 sta     zp:_Zp+3
    \ 05bc a9..                 lda     #.byte0 `_StringLiteral_Not enough tracks available`
    \ 05be 85..                 sta     zp:_Zp
    \ 05c0 a9..                 lda     #.byte1 `_StringLiteral_Not enough tracks available`
    \ 05c2          `?L1904`:
    \ 05c2 85..                 sta     zp:_Zp+1
    \ 05c4 a904                 lda     #4
    \ 05c6 20....               jsr     `?L1915`
    \ 05c9 4c....               jmp     `?L325`
    \ 05cc 88       `?L576`:    dey
    \ 05cd b1..                 lda     (_Vsp),y
    \ 05cf a302                 ldz     #2
    \ 05d1 38                   sec
    \ 05d2 f2..                 sbc     (_Vsp),z
    \ 05d4 1a                   inc     a
    \ 05d5 85..                 sta     zp:_Zp+28
    \ 05d7 a9..                 lda     #.byte0 `_StringLiteral_Enter amount of tracks 2..80, 0 to quit:`
    \ 05d9 85..                 sta     zp:_Zp+2
    \ 05db a9..                 lda     #.byte1 `_StringLiteral_Enter amount of tracks 2..80, 0 to quit:`
    \ 05dd 20....               jsr     `?L1941`
    \ 05e0 a94a                 lda     #74
    \ 05e2 20....               jsr     `?L1914`
    \ 05e5 20....               jsr     strcpy
    \ 05e8 a6..                 ldx     zp:_Zp+28
    \ 05ea 20....               jsr     `?L1953`
    \ 05ed 20....               jsr     `?L1997`
    \ 05f0 65..                 adc     zp:_Zp
    \ 05f2 48                   pha
    \ 05f3 20....               jsr     `?L2034`
    \ 05f6 20....               jsr     `?L1925`
    \ 05f9 68                   pla
    \ 05fa a064                 ldy     #100
    \ 05fc 91..                 sta     (_Zp),y
    \ 05fe a6..                 ldx     zp:_Zp+28
    \ 0600 20....               jsr     `?L1953`
    \ 0603 20....               jsr     `?L1997`
    \ 0606 65..                 adc     zp:_Zp+2
    \ 0608 48                   pha
    \ 0609 20....               jsr     `?L2034`
    \ 060c 20....               jsr     `?L1925`
    \ 060f 68                   pla
    \ 0610 a065                 ldy     #101
    \ 0612 91..                 sta     (_Zp),y
    \ 0614 20....               jsr     `?L1933`
    \ 0617 a900                 lda     #0
    \ 0619 7d....               adc     midnight+1,x
    \ 061c 20....               jsr     `?L1941`
    \ 061f a94a                 lda     #74
    \ 0621 20....               jsr     `?L1914`
    \ 0624 20....               jsr     inputbox
    \ 0627 a5..                 lda     zp:_Zp+24
    \ 0629 0a                   asl     a
    \ 062a aa                   tax
    \ 062b 18                   clc
    \ 062c a94a                 lda     #74
    \ 062e 20....               jsr     `?L1914`
    \ 0631 20....               jsr     atoi
    \ 0634 a5..                 lda     zp:_Zp
    \ 0636 85..                 sta     zp:_Zp+28
    \ 0638 20....               jsr     `?L2004`
    \ 063b a5..                 lda     zp:_Zp+28
    \ 063d 85..                 sta     zp:_Zp+3
    \ 063f a5..                 lda     zp:_Zp+24
    \ 0641 20....               jsr     `?L1908`
    \ 0644 a049                 ldy     #73
    \ 0646 b1..                 lda     (_Zp),y
    \ 0648 85..                 sta     zp:_Zp+2
    \ 064a a5..                 lda     zp:_Zp+24
    \ 064c 20....               jsr     `?L1908`
    \ 064f 88                   dey
    \ 0650 20....               jsr     `?L2036`
    \ 0653 20....               jsr     `?L1921`
    \ 0656 20....               jsr     FreeTracks
    \ 0659 ab....               ldz     _Zp+28
    \ 065c c202                 cpz     #2
    \ 065e 934501               lbcc    `?L579`
    \ 0661 a001                 ldy     #1
    \ 0663 20....               jsr     `?L1945`
    \ 0666 85..                 sta     zp:_Zp
    \ 0668 b002                 bcs     `?L1536`
    \ 066a c6..                 dec     zp:_Zp+1
    \ 066c          `?L1536`:
    \ 066c 20....               jsr     `?L2065`
    \ 066f 5002                 bvc     `?L1538`
    \ 0671 4980                 eor     #-128
    \ 0673 333001   `?L1538`:   lbmi    `?L579`
    \ 0676 88                   dey
    \ 0677 20....               jsr     `?L1945`
    \ 067a 85..                 sta     zp:_Zp
    \ 067c b002                 bcs     `?L1540`
    \ 067e c6..                 dec     zp:_Zp+1
    \ 0680          `?L1540`:
    \ 0680 e3..                 inw     zp:_Zp
    \ 0682 a6..                 ldx     zp:_Zp+28
    \ 0684 86..                 stx     zp:_Zp+2
    \ 0686 a900                 lda     #0
    \ 0688 20....               jsr     `?L2042`
    \ 068b 5002                 bvc     `?L1542`
    \ 068d 4980                 eor     #-128
    \ 068f 331401   `?L1542`:   lbmi    `?L579`
    \ 0692 a9..                 lda     #.byte0 `_StringLiteral_Please enter name of the subdirectory`
    \ 0694 85..                 sta     zp:_Zp+2
    \ 0696 a9..                 lda     #.byte1 `_StringLiteral_Please enter name of the subdirectory`
    \ 0698 20....               jsr     `?L1941`
    \ 069b a94a                 lda     #74
    \ 069d 20....               jsr     `?L1914`
    \ 06a0 20....               jsr     inputbox
    \ 06a3 a5..                 lda     zp:_Zp+28
    \ 06a5 a302                 ldz     #2
    \ 06a7 18                   clc
    \ 06a8 72..                 adc     (_Vsp),z
    \ 06aa 3a                   dec     a
    \ 06ab a001                 ldy     #1
    \ 06ad 91..                 sta     (_Vsp),y
    \ 06af 85..                 sta     zp:_Zp+2
    \ 06b1 c8                   iny
    \ 06b2 b1..                 lda     (_Vsp),y
    \ 06b4 20....               jsr     `?L2037`
    \ 06b7 20....               jsr     `?L1921`
    \ 06ba 20....               jsr     BAMAllocateTracks
    \ 06bd a5..                 lda     zp:_Zp+24
    \ 06bf 20....               jsr     `?L1908`
    \ 06c2 20....               jsr     `?L1947`
    \ 06c5 a5..                 lda     zp:_Zp+24
    \ 06c7 20....               jsr     `?L1919`
    \ 06ca 20....               jsr     PutBAM
    \ 06cd a900                 lda     #0
    \ 06cf a8                   tay
    \ 06d0 91..                 sta     (_Zp+26),y
    \ 06d2 c8                   iny
    \ 06d3 91..                 sta     (_Zp+26),y
    \ 06d5 a985                 lda     #-123
    \ 06d7 c8                   iny
    \ 06d8 91..                 sta     (_Zp+26),y
    \ 06da b1..                 lda     (_Vsp),y
    \ 06dc c8                   iny
    \ 06dd 91..                 sta     (_Zp+26),y
    \ 06df a900                 lda     #0
    \ 06e1 c8                   iny
    \ 06e2 91..                 sta     (_Zp+26),y
    \ 06e4 a5..                 lda     zp:_Zp+26
    \ 06e6 18                   clc
    \ 06e7 6905                 adc     #5
    \ 06e9 85..                 sta     zp:_Zp+2
    \ 06eb a5..                 lda     zp:_Zp+27
    \ 06ed 6900                 adc     #0
    \ 06ef 20....               jsr     `?L1941`
    \ 06f2 a94a                 lda     #74
    \ 06f4 20....               jsr     `?L1914`
    \ 06f7 20....               jsr     `?L2067`
    \ 06fa a001                 ldy     #1
    \ 06fc b1..                 lda     (_Vsp),y
    \ 06fe 85..                 sta     zp:_Zp+2
    \ 0700 a900                 lda     #0
    \ 0702 85..                 sta     zp:_Zp+3
    \ 0704 c8                   iny
    \ 0705 b1..                 lda     (_Vsp),y
    \ 0707 85..                 sta     zp:_Zp
    \ 0709 38                   sec
    \ 070a a5..                 lda     zp:_Zp+2
    \ 070c e5..                 sbc     zp:_Zp
    \ 070e 85..                 sta     zp:_Zp+2
    \ 0710 b002                 bcs     `?L1548`
    \ 0712 c6..                 dec     zp:_Zp+3
    \ 0714          `?L1548`:
    \ 0714 cb....               asw     _Zp+2
    \ 0717 cb....               asw     _Zp+2
    \ 071a cb....               asw     _Zp+2
    \ 071d a5..                 lda     zp:_Zp+2
    \ 071f 85..                 sta     zp:_Zp
    \ 0721 a5..                 lda     zp:_Zp+3
    \ 0723 85..                 sta     zp:_Zp+1
    \ 0725 cb....               asw     _Zp+2
    \ 0728 cb....               asw     _Zp+2
    \ 072b a5..                 lda     zp:_Zp+2
    \ 072d 18                   clc
    \ 072e 65..                 adc     zp:_Zp
    \ 0730 85..                 sta     zp:_Zp
    \ 0732 a5..                 lda     zp:_Zp+3
    \ 0734 65..                 adc     zp:_Zp+1
    \ 0736 85..                 sta     zp:_Zp+1
    \ 0738 a01e                 ldy     #30
    \ 073a a5..                 lda     zp:_Zp
    \ 073c 91..                 sta     (_Zp+26),y
    \ 073e c8                   iny
    \ 073f a5..                 lda     zp:_Zp+1
    \ 0741 91..                 sta     (_Zp+26),y
    \ 0743 a5..                 lda     zp:_Zp+26
    \ 0745 85..                 sta     zp:_Zp+6
    \ 0747 a5..                 lda     zp:_Zp+27
    \ 0749 85..                 sta     zp:_Zp+7
    \ 074b a5..                 lda     zp:_Zp+24
    \ 074d 20....               jsr     `?L1908`
    \ 0750 a049                 ldy     #73
    \ 0752 b1..                 lda     (_Zp),y
    \ 0754 85..                 sta     zp:_Zp+4
    \ 0756 a5..                 lda     zp:_Zp+24
    \ 0758 20....               jsr     `?L1908`
    \ 075b 88                   dey
    \ 075c b1..                 lda     (_Zp),y
    \ 075e 85..                 sta     zp:_Zp+3
    \ 0760 a5..                 lda     zp:_Zp+24
    \ 0762 20....               jsr     `?L1908`
    \ 0765 88                   dey
    \ 0766 b1..                 lda     (_Zp),y
    \ 0768 20....               jsr     `?L1939`
    \ 076b b1..                 lda     (_Zp+8),y
    \ 076d 20....               jsr     `?L1921`
    \ 0770 20....               jsr     writenewdirententry
    \ 0773 a5..                 lda     zp:_Zp+26
    \ 0775 18                   clc
    \ 0776 6905                 adc     #5
    \ 0778 85..                 sta     zp:_Zp+6
    \ 077a a5..                 lda     zp:_Zp+27
    \ 077c 6900                 adc     #0
    \ 077e 85..                 sta     zp:_Zp+7
    \ 0780 a001                 ldy     #1
    \ 0782 b1..                 lda     (_Vsp),y
    \ 0784 85..                 sta     zp:_Zp+4
    \ 0786 c8                   iny
    \ 0787 b1..                 lda     (_Vsp),y
    \ 0789 85..                 sta     zp:_Zp+3
    \ 078b b1..                 lda     (_Vsp),y
    \ 078d 20....               jsr     `?L1939`
    \ 0790 b1..                 lda     (_Zp+8),y
    \ 0792 20....               jsr     `?L1921`
    \ 0795 20....               jsr     FormatPartition
    \ 0798 a5..                 lda     zp:_Zp+24
    \ 079a 85..                 sta     zp:_Zp
    \ 079c 20....               jsr     `?L1913`
    \ 079f 20....               jsr     `?L1954`
    \ 07a2 4c....               jmp     `?L325`
    \ 07a5          `?L579`:
    \ 07a5 a5..                 lda     zp:_Zp+28
    \ 07a7 f36af9               lbeq    `?L325`
    \ 07aa 20....               jsr     `?L1909`
    \ 07ad 20....               jsr     `?L1922`
    \ 07b0 a9..                 lda     #.byte0 `_StringLiteral_subdirectory.`
    \ 07b2 85..                 sta     zp:_Zp+2
    \ 07b4 a9..                 lda     #.byte1 `_StringLiteral_subdirectory.`
    \ 07b6 85..                 sta     zp:_Zp+3
    \ 07b8 a9..                 lda     #.byte0 `_StringLiteral_No space to create a`
    \ 07ba 85..                 sta     zp:_Zp
    \ 07bc a9..                 lda     #.byte1 `_StringLiteral_No space to create a`
    \ 07be 8014                 bra     `?L1895`
    \ 07c0          `?L575`:
    \ 07c0 20....               jsr     `?L1909`
    \ 07c3 20....               jsr     `?L1922`
    \ 07c6 a9..                 lda     #.byte0 `_StringLiteral_be mounted and its root directory selected.`
    \ 07c8 85..                 sta     zp:_Zp+2
    \ 07ca a9..                 lda     #.byte1 `_StringLiteral_be mounted and its root directory selected.`
    \ 07cc 85..                 sta     zp:_Zp+3
    \ 07ce a9..                 lda     #.byte0 `_StringLiteral_To create a directory a disk has to`
    \ 07d0 85..                 sta     zp:_Zp
    \ 07d2 a9..                 lda     #.byte1 `_StringLiteral_To create a directory a disk has to`
    \ 07d4          `?L1895`:
    \ 07d4 85..                 sta     zp:_Zp+1
    \ 07d6 a904                 lda     #4
    \ 07d8 20....               jsr     `?L1915`
    \ 07db 4c....               jmp     `?L325`
    \ 07de a900     `?L408`:    lda     #0
    \ 07e0 85..                 sta     zp:_Zp+32
    \ 07e2 a5..                 lda     zp:_Zp+24
    \ 07e4 20....               jsr     `?L1908`
    \ 07e7 20....               jsr     `?L1927`
    \ 07ea 85..                 sta     zp:_Zp
    \ 07ec 98                   tya
    \ 07ed 85..                 sta     zp:_Zp+1
    \ 07ef 20....               jsr     `?L1935`
    \ 07f2 20....               jsr     `?L2059`
    \ 07f5          `?L456`:
    \ 07f5 20....               jsr     `?L1986`
    \ 07f8 938b07               lbcc    `?L455`
    \ 07fb a5..                 lda     zp:_Zp+32
    \ 07fd d024                 bne     `?L466`
    \ 07ff 20....               jsr     `?L1952`
    \ 0802 20....               jsr     `?L1912`
    \ 0805 f005                 beq     `?L1561`
    \ 0807          `?L1562`:
    \ 0807 20....               jsr     `?L1990`
    \ 080a d0fb                 bne     `?L1562`
    \ 080c          `?L1561`:
    \ 080c 20....               jsr     `?L1911`
    \ 080f a5..                 lda     zp:_Zp+24
    \ 0811 20....               jsr     `?L1908`
    \ 0814 20....               jsr     `?L1927`
    \ 0817 20....               jsr     `?L1976`
    \ 081a 9002                 bcc     `?L1564`
    \ 081c e6..                 inc     zp:_Zp+3
    \ 081e          `?L1564`:
    \ 081e 20....               jsr     `?L2066`
    \ 0821 e6..                 inc     zp:_Zp+32
    \ 0823 a301     `?L466`:    ldz     #1
    \ 0825 d4..                 cpz     zp:_Zp+32
    \ 0827 b028                 bcs     `?L468`
    \ 0829 a5..                 lda     zp:_Zp+24
    \ 082b 20....               jsr     `?L1908`
    \ 082e 6b                   tza
    \ 082f a346                 ldz     #70
    \ 0831 32..                 and     (_Zp),z
    \ 0833 d01c                 bne     `?L468`
    \ 0835 20....               jsr     `?L1909`
    \ 0838 a9..                 lda     #.byte0 `_StringLiteral_is not supported.`
    \ 083a 85..                 sta     zp:_Zp+4
    \ 083c a9..                 lda     #.byte1 `_StringLiteral_is not supported.`
    \ 083e 85..                 sta     zp:_Zp+5
    \ 0840 a9..                 lda     #.byte0 `_StringLiteral_storage card files/folders`
    \ 0842 85..                 sta     zp:_Zp+2
    \ 0844 a9..                 lda     #.byte1 `_StringLiteral_storage card files/folders`
    \ 0846 85..                 sta     zp:_Zp+3
    \ 0848 a9..                 lda     #.byte0 `_StringLiteral_Operation on mulitiple`
    \ 084a 85..                 sta     zp:_Zp
    \ 084c a9..                 lda     #.byte1 `_StringLiteral_Operation on mulitiple`
    \ 084e 4c....               jmp     `?L1885`
    \ 0851 a301     `?L468`:    ldz     #1
    \ 0853 d4..                 cpz     zp:_Zp+32
    \ 0855 b025                 bcs     `?L471`
    \ 0857 a90f                 lda     #15
    \ 0859 1b                   inz
    \ 085a 32..                 and     (_Zp+30),z
    \ 085c c905                 cmp     #5
    \ 085e d01c                 bne     `?L471`
    \ 0860 20....               jsr     `?L1909`
    \ 0863 a9..                 lda     #.byte0 `_StringLiteral_is not supported`
    \ 0865 85..                 sta     zp:_Zp+4
    \ 0867 a9..                 lda     #.byte1 `_StringLiteral_is not supported`
    \ 0869 85..                 sta     zp:_Zp+5
    \ 086b a9..                 lda     #.byte0 `_StringLiteral_multiple selected entries`
    \ 086d 85..                 sta     zp:_Zp+2
    \ 086f a9..                 lda     #.byte1 `_StringLiteral_multiple selected entries`
    \ 0871 85..                 sta     zp:_Zp+3
    \ 0873 a9..                 lda     #.byte0 `_StringLiteral_Directory operation on`
    \ 0875 85..                 sta     zp:_Zp
    \ 0877 a9..                 lda     #.byte1 `_StringLiteral_Directory operation on`
    \ 0879 4c....               jmp     `?L1885`
    \ 087c a301     `?L471`:    ldz     #1
    \ 087e d4..                 cpz     zp:_Zp+32
    \ 0880 b008                 bcs     `?L474`
    \ 0882 a9..                 lda     #.byte0 `_StringLiteral_multiple selected entries`
    \ 0884 85..                 sta     zp:_Zp+2
    \ 0886 a9..                 lda     #.byte1 `_StringLiteral_multiple selected entries`
    \ 0888 8003                 bra     `?L1879`
    \ 088a          `?L474`:
    \ 088a 20....               jsr     `?L1928`
    \ 088d          `?L1879`:
    \ 088d 20....               jsr     `?L1941`
    \ 0890 a94a                 lda     #74
    \ 0892 20....               jsr     `?L1914`
    \ 0895 20....               jsr     strcpy
    \ 0898 a90f                 lda     #15
    \ 089a a302                 ldz     #2
    \ 089c 32..                 and     (_Zp+30),z
    \ 089e d024                 bne     `?L477`
    \ 08a0 a5..                 lda     zp:_Zp+24
    \ 08a2 20....               jsr     `?L1908`
    \ 08a5 20....               jsr     `?L1942`
    \ 08a8 f01a                 beq     `?L477`
    \ 08aa 20....               jsr     `?L1909`
    \ 08ad a9..                 lda     #.byte0 _StringLiteral_unsupported
    \ 08af 85..                 sta     zp:_Zp+4
    \ 08b1 a9..                 lda     #.byte1 _StringLiteral_unsupported
    \ 08b3 85..                 sta     zp:_Zp+5
    \ 08b5 20....               jsr     `?L1933`
    \ 08b8 20....               jsr     `?L2056`
    \ 08bb a9..                 lda     #.byte0 `_StringLiteral_File type for`
    \ 08bd 85..                 sta     zp:_Zp
    \ 08bf a9..                 lda     #.byte1 `_StringLiteral_File type for`
    \ 08c1 4c....               jmp     `?L1885`
    \ 08c4 a9f5     `?L477`:    lda     #-11
    \ 08c6 45..                 eor     zp:_Zp+28
    \ 08c8 05..                 ora     zp:_Zp+29
    \ 08ca d3b302               lbne    `?L480`
    \ 08cd 20....               jsr     `?L2033`
    \ 08d0 d014                 bne     `?L483`
    \ 08d2 20....               jsr     `?L1909`
    \ 08d5 20....               jsr     `?L1922`
    \ 08d8 a9..                 lda     #.byte0 `_StringLiteral_is not supported.`
    \ 08da 20....               jsr     `?L2062`
    \ 08dd a9..                 lda     #.byte0 `_StringLiteral_Copying full directory structures`
    \ 08df 85..                 sta     zp:_Zp
    \ 08e1 a9..                 lda     #.byte1 `_StringLiteral_Copying full directory structures`
    \ 08e3 4c....               jmp     `?L1885`
    \ 08e6          `?L483`:
    \ 08e6 a5..                 lda     zp:_Zp+24
    \ 08e8 20....               jsr     `?L1908`
    \ 08eb 20....               jsr     `?L1942`
    \ 08ee f37b02               lbeq    `?L488`
    \ 08f1 a5..                 lda     zp:_Zp+24
    \ 08f3 d004                 bne     `?L726`
    \ 08f5 a901                 lda     #1
    \ 08f7 8002                 bra     `?L1863`
    \ 08f9 a900     `?L726`:    lda     #0
    \ 08fb          `?L1863`:
    \ 08fb 85..                 sta     zp:_Zp
    \ 08fd a5..                 lda     zp:_Zp
    \ 08ff 20....               jsr     `?L1908`
    \ 0902 a901                 lda     #1
    \ 0904 32..                 and     (_Zp),z
    \ 0906 f36302               lbeq    `?L488`
    \ 0909 a5..                 lda     zp:_Zp+24
    \ 090b d004                 bne     `?L729`
    \ 090d a901                 lda     #1
    \ 090f 8002                 bra     `?L1862`
    \ 0911 a900     `?L729`:    lda     #0
    \ 0913          `?L1862`:
    \ 0913 85..                 sta     zp:_Zp
    \ 0915 a5..                 lda     zp:_Zp
    \ 0917 20....               jsr     `?L1908`
    \ 091a a044                 ldy     #68
    \ 091c b1..                 lda     (_Zp),y
    \ 091e 85..                 sta     zp:_Zp+26
    \ 0920 c8                   iny
    \ 0921 b1..                 lda     (_Zp),y
    \ 0923 85..                 sta     zp:_Zp+27
    \ 0925 a5..                 lda     zp:_Zp+24
    \ 0927 20....               jsr     sizeselectcurrentifnone
    \ 092a a5..                 lda     zp:_Zp+26
    \ 092c c5..                 cmp     zp:_Zp
    \ 092e a5..                 lda     zp:_Zp+27
    \ 0930 e5..                 sbc     zp:_Zp+1
    \ 0932 b017                 bcs     `?L489`
    \ 0934 20....               jsr     `?L1909`
    \ 0937 20....               jsr     `?L1922`
    \ 093a a9..                 lda     #.byte0 `_StringLiteral_destination disk space insufficient`
    \ 093c 85..                 sta     zp:_Zp+2
    \ 093e a9..                 lda     #.byte1 `_StringLiteral_destination disk space insufficient`
    \ 0940 85..                 sta     zp:_Zp+3
    \ 0942 a9..                 lda     #.byte0 `_StringLiteral_File copy,`
    \ 0944 85..                 sta     zp:_Zp
    \ 0946 a9..                 lda     #.byte1 `_StringLiteral_File copy,`
    \ 0948 4c....               jmp     `?L1885`
    \ 094b          `?L489`:
    \ 094b a5..                 lda     zp:_Zp+24
    \ 094d d008                 bne     `?L732`
    \ 094f a9..                 lda     #.byte0 `_StringLiteral_from left to right`
    \ 0951 85..                 sta     zp:_Zp+4
    \ 0953 a9..                 lda     #.byte1 `_StringLiteral_from left to right`
    \ 0955 8006                 bra     `?L1861`
    \ 0957          `?L732`:
    \ 0957 a9..                 lda     #.byte0 `_StringLiteral_from right to left`
    \ 0959 85..                 sta     zp:_Zp+4
    \ 095b a9..                 lda     #.byte1 `_StringLiteral_from right to left`
    \ 095d          `?L1861`:
    \ 095d 85..                 sta     zp:_Zp+5
    \ 095f 20....               jsr     `?L1909`
    \ 0962 20....               jsr     `?L1933`
    \ 0965 20....               jsr     `?L2056`
    \ 0968 a9..                 lda     #.byte0 `_StringLiteral_File copy,`
    \ 096a 85..                 sta     zp:_Zp
    \ 096c a9..                 lda     #.byte1 `_StringLiteral_File copy,`
    \ 096e 20....               jsr     `?L1934`
    \ 0971 20....               jsr     `?L1915`
    \ 0974 aa                   tax
    \ 0975 f3db04               lbeq    `?L469`
    \ 0978 20....               jsr     `?L2059`
    \ 097b          `?L496`:
    \ 097b 20....               jsr     `?L1986`
    \ 097e 901d                 bcc     `?L495`
    \ 0980 a5..                 lda     zp:_Zp+24
    \ 0982 d004                 bne     `?L735`
    \ 0984 a901                 lda     #1
    \ 0986 8002                 bra     `?L1860`
    \ 0988 a900     `?L735`:    lda     #0
    \ 098a          `?L1860`:
    \ 098a 85..                 sta     zp:_Zp+2
    \ 098c a5..                 lda     zp:_Zp+24
    \ 098e d004                 bne     `?L738`
    \ 0990 a901                 lda     #1
    \ 0992 8002                 bra     `?L1859`
    \ 0994 a900     `?L738`:    lda     #0
    \ 0996          `?L1859`:
    \ 0996 85..                 sta     zp:_Zp
    \ 0998 a5..                 lda     zp:_Zp+2
    \ 099a 4c....               jmp     `?L1901`
    \ 099d          `?L495`:
    \ 099d 20....               jsr     `?L1952`
    \ 09a0 20....               jsr     `?L1912`
    \ 09a3 f005                 beq     `?L1589`
    \ 09a5          `?L1590`:
    \ 09a5 20....               jsr     `?L1990`
    \ 09a8 d0fb                 bne     `?L1590`
    \ 09aa          `?L1589`:
    \ 09aa 20....               jsr     `?L1911`
    \ 09ad 20....               jsr     `?L1958`
    \ 09b0 f3b401               lbeq    `?L497`
    \ 09b3 20....               jsr     `?L1944`
    \ 09b6 20....               jsr     `?L1935`
    \ 09b9 a9..                 lda     #.byte0 `_StringLiteral_source file`
    \ 09bb 85..                 sta     zp:_Zp+2
    \ 09bd a9..                 lda     #.byte1 `_StringLiteral_source file`
    \ 09bf 20....               jsr     `?L1938`
    \ 09c2 20....               jsr     `?L2068`
    \ 09c5 a9ff                 lda     #-1
    \ 09c7 20....               jsr     _DecVsp
    \ 09ca a004                 ldy     #4
    \ 09cc b1..                 lda     (_Zp+30),y
    \ 09ce a000                 ldy     #0
    \ 09d0 91..                 sta     (_Vsp),y
    \ 09d2 a003                 ldy     #3
    \ 09d4 b1..                 lda     (_Zp+30),y
    \ 09d6 85..                 sta     zp:_Zp+7
    \ 09d8 a5..                 lda     zp:_Zp+24
    \ 09da 20....               jsr     `?L1908`
    \ 09dd 20....               jsr     `?L1959`
    \ 09e0 20....               jsr     `?L2054`
    \ 09e3 20....               jsr     `?L1937`
    \ 09e6 a91e                 lda     #30
    \ 09e8 20....               jsr     `?L2052`
    \ 09eb d004                 bne     `?L741`
    \ 09ed a901                 lda     #1
    \ 09ef 8002                 bra     `?L1858`
    \ 09f1 a900     `?L741`:    lda     #0
    \ 09f3          `?L1858`:
    \ 09f3 85..                 sta     zp:_Zp
    \ 09f5 ad....               lda     legacyHDOSstate
    \ 09f8 20....               jsr     GetBAM
    \ 09fb a9..                 lda     #.byte0 `_StringLiteral_destination file`
    \ 09fd 85..                 sta     zp:_Zp+2
    \ 09ff a9..                 lda     #.byte1 `_StringLiteral_destination file`
    \ 0a01 20....               jsr     `?L1946`
    \ 0a04 a928                 lda     #40
    \ 0a06 20....               jsr     `?L2052`
    \ 0a09 d004                 bne     `?L744`
    \ 0a0b a901                 lda     #1
    \ 0a0d 8002                 bra     `?L1857`
    \ 0a0f a900     `?L744`:    lda     #0
    \ 0a11          `?L1857`:
    \ 0a11 85..                 sta     zp:_Zp
    \ 0a13 a5..                 lda     zp:_Zp+24
    \ 0a15 d004                 bne     `?L747`
    \ 0a17 a901                 lda     #1
    \ 0a19 8002                 bra     `?L1856`
    \ 0a1b a900     `?L747`:    lda     #0
    \ 0a1d          `?L1856`:
    \ 0a1d 85..                 sta     zp:_Zp+2
    \ 0a1f a5..                 lda     zp:_Zp+24
    \ 0a21 d004                 bne     `?L750`
    \ 0a23 a901                 lda     #1
    \ 0a25 8002                 bra     `?L1855`
    \ 0a27 a900     `?L750`:    lda     #0
    \ 0a29          `?L1855`:
    \ 0a29 85..                 sta     zp:_Zp+4
    \ 0a2b a5..                 lda     zp:_Zp+24
    \ 0a2d d004                 bne     `?L753`
    \ 0a2f a901                 lda     #1
    \ 0a31 8002                 bra     `?L1854`
    \ 0a33 a900     `?L753`:    lda     #0
    \ 0a35          `?L1854`:
    \ 0a35 85..                 sta     zp:_Zp+6
    \ 0a37 a9f9                 lda     #-7
    \ 0a39 20....               jsr     _DecVsp
    \ 0a3c a5..                 lda     zp:_Zp+6
    \ 0a3e 20....               jsr     `?L1929`
    \ 0a41 a049                 ldy     #73
    \ 0a43 b1..                 lda     (_Zp+6),y
    \ 0a45 a006                 ldy     #6
    \ 0a47 91..                 sta     (_Vsp),y
    \ 0a49 20....               jsr     `?L2026`
    \ 0a4c a048                 ldy     #72
    \ 0a4e b1..                 lda     (_Zp+4),y
    \ 0a50 a005                 ldy     #5
    \ 0a52 91..                 sta     (_Vsp),y
    \ 0a54 a900                 lda     #0
    \ 0a56 88                   dey
    \ 0a57 91..                 sta     (_Vsp),y
    \ 0a59 a2..                 ldx     #_Zp+4
    \ 0a5b a907                 lda     #7
    \ 0a5d 20....               jsr     `?L2029`
    \ 0a60 a909                 lda     #9
    \ 0a62 20....               jsr     `?L2029`
    \ 0a65 a5..                 lda     zp:_Zp+2
    \ 0a67 0a                   asl     a
    \ 0a68 aa                   tax
    \ 0a69 bd....               lda     midnight,x
    \ 0a6c 85..                 sta     zp:_Zp+2
    \ 0a6e bd....               lda     midnight+1,x
    \ 0a71 85..                 sta     zp:_Zp+3
    \ 0a73 a047                 ldy     #71
    \ 0a75 b1..                 lda     (_Zp+2),y
    \ 0a77 85..                 sta     zp:_Zp+7
    \ 0a79 a5..                 lda     zp:_Zp
    \ 0a7b 20....               jsr     `?L1908`
    \ 0a7e 20....               jsr     `?L1959`
    \ 0a81 20....               jsr     writeblockchain
    \ 0a84 a006                 ldy     #6
    \ 0a86 20....               jsr     _IncVsp
    \ 0a89 a002                 ldy     #2
    \ 0a8b b1..                 lda     (_Vsp),y
    \ 0a8d c8                   iny
    \ 0a8e 91..                 sta     (_Zp+30),y
    \ 0a90 a000                 ldy     #0
    \ 0a92 b1..                 lda     (_Vsp),y
    \ 0a94 a004                 ldy     #4
    \ 0a96 91..                 sta     (_Zp+30),y
    \ 0a98 a9..                 lda     #.byte0 _StringLiteral_directory
    \ 0a9a 85..                 sta     zp:_Zp+2
    \ 0a9c a9..                 lda     #.byte1 _StringLiteral_directory
    \ 0a9e 20....               jsr     `?L1946`
    \ 0aa1 a93c                 lda     #60
    \ 0aa3 20....               jsr     `?L2052`
    \ 0aa6 d004                 bne     `?L756`
    \ 0aa8 a901                 lda     #1
    \ 0aaa 8002                 bra     `?L1853`
    \ 0aac a900     `?L756`:    lda     #0
    \ 0aae          `?L1853`:
    \ 0aae 85..                 sta     zp:_Zp+10
    \ 0ab0 a5..                 lda     zp:_Zp+24
    \ 0ab2 d004                 bne     `?L759`
    \ 0ab4 a901                 lda     #1
    \ 0ab6 8002                 bra     `?L1852`
    \ 0ab8 a900     `?L759`:    lda     #0
    \ 0aba          `?L1852`:
    \ 0aba 85..                 sta     zp:_Zp+8
    \ 0abc a5..                 lda     zp:_Zp+24
    \ 0abe d004                 bne     `?L762`
    \ 0ac0 a901                 lda     #1
    \ 0ac2 8002                 bra     `?L1851`
    \ 0ac4 a900     `?L762`:    lda     #0
    \ 0ac6          `?L1851`:
    \ 0ac6 85..                 sta     zp:_Zp
    \ 0ac8 a5..                 lda     zp:_Zp+24
    \ 0aca d004                 bne     `?L765`
    \ 0acc a901                 lda     #1
    \ 0ace 8002                 bra     `?L1850`
    \ 0ad0 a900     `?L765`:    lda     #0
    \ 0ad2          `?L1850`:
    \ 0ad2 85..                 sta     zp:_Zp+2
    \ 0ad4 a5..                 lda     zp:_Zp+24
    \ 0ad6 d004                 bne     `?L768`
    \ 0ad8 a901                 lda     #1
    \ 0ada 8002                 bra     `?L1849`
    \ 0adc a900     `?L768`:    lda     #0
    \ 0ade          `?L1849`:
    \ 0ade 85..                 sta     zp:_Zp+4
    \ 0ae0 a5..                 lda     zp:_Zp+30
    \ 0ae2 85..                 sta     zp:_Zp+6
    \ 0ae4 a5..                 lda     zp:_Zp+31
    \ 0ae6 85..                 sta     zp:_Zp+7
    \ 0ae8 20....               jsr     `?L2026`
    \ 0aeb a049                 ldy     #73
    \ 0aed b1..                 lda     (_Zp+4),y
    \ 0aef 85..                 sta     zp:_Zp+4
    \ 0af1 a5..                 lda     zp:_Zp+2
    \ 0af3 0a                   asl     a
    \ 0af4 aa                   tax
    \ 0af5 bd....               lda     midnight,x
    \ 0af8 85..                 sta     zp:_Zp+2
    \ 0afa bd....               lda     midnight+1,x
    \ 0afd 85..                 sta     zp:_Zp+3
    \ 0aff 88                   dey
    \ 0b00 b1..                 lda     (_Zp+2),y
    \ 0b02 85..                 sta     zp:_Zp+3
    \ 0b04 a5..                 lda     zp:_Zp
    \ 0b06 20....               jsr     `?L1908`
    \ 0b09 88                   dey
    \ 0b0a b1..                 lda     (_Zp),y
    \ 0b0c 85..                 sta     zp:_Zp+2
    \ 0b0e a5..                 lda     zp:_Zp+8
    \ 0b10 85..                 sta     zp:_Zp+1
    \ 0b12 a5..                 lda     zp:_Zp+10
    \ 0b14 20....               jsr     `?L1940`
    \ 0b17 b1..                 lda     (_Zp+8),y
    \ 0b19 20....               jsr     `?L1921`
    \ 0b1c 20....               jsr     writenewdirententry
    \ 0b1f a9..                 lda     #.byte0 _StringLiteral_BAM
    \ 0b21 85..                 sta     zp:_Zp+2
    \ 0b23 a9..                 lda     #.byte1 _StringLiteral_BAM
    \ 0b25 20....               jsr     `?L1946`
    \ 0b28 a950                 lda     #80
    \ 0b2a 20....               jsr     `?L2052`
    \ 0b2d d004                 bne     `?L771`
    \ 0b2f a901                 lda     #1
    \ 0b31 8002                 bra     `?L1848`
    \ 0b33 a900     `?L771`:    lda     #0
    \ 0b35          `?L1848`:
    \ 0b35 85..                 sta     zp:_Zp+6
    \ 0b37 a5..                 lda     zp:_Zp+24
    \ 0b39 d004                 bne     `?L774`
    \ 0b3b a901                 lda     #1
    \ 0b3d 8002                 bra     `?L1847`
    \ 0b3f a900     `?L774`:    lda     #0
    \ 0b41          `?L1847`:
    \ 0b41 85..                 sta     zp:_Zp+4
    \ 0b43 a5..                 lda     zp:_Zp+24
    \ 0b45 d004                 bne     `?L777`
    \ 0b47 a901                 lda     #1
    \ 0b49 8002                 bra     `?L1846`
    \ 0b4b a900     `?L777`:    lda     #0
    \ 0b4d          `?L1846`:
    \ 0b4d 85..                 sta     zp:_Zp
    \ 0b4f a5..                 lda     zp:_Zp
    \ 0b51 20....               jsr     `?L1908`
    \ 0b54 a047                 ldy     #71
    \ 0b56 b1..                 lda     (_Zp),y
    \ 0b58 85..                 sta     zp:_Zp+2
    \ 0b5a a5..                 lda     zp:_Zp+4
    \ 0b5c 85..                 sta     zp:_Zp+1
    \ 0b5e a5..                 lda     zp:_Zp+6
    \ 0b60 20....               jsr     `?L1919`
    \ 0b63 20....               jsr     PutBAM
    \ 0b66          `?L497`:
    \ 0b66 e3..                 inw     zp:_Zp+26
    \ 0b68 4c....               jmp     `?L496`
    \ 0b6b          `?L488`:
    \ 0b6b 20....               jsr     `?L1909`
    \ 0b6e 20....               jsr     `?L1922`
    \ 0b71 a9..                 lda     #.byte0 `_StringLiteral_is not supported.`
    \ 0b73 20....               jsr     `?L2062`
    \ 0b76 a9..                 lda     #.byte0 `_StringLiteral_Copying storage card files/folders`
    \ 0b78 85..                 sta     zp:_Zp
    \ 0b7a a9..                 lda     #.byte1 `_StringLiteral_Copying storage card files/folders`
    \ 0b7c 4c....               jmp     `?L1885`
    \ 0b7f a9f6     `?L480`:    lda     #-10
    \ 0b81 45..                 eor     zp:_Zp+28
    \ 0b83 05..                 ora     zp:_Zp+29
    \ 0b85 f3b902               lbeq    `?L504`
    \ 0b88 a9f6                 lda     #246
    \ 0b8a c5..                 cmp     zp:_Zp+28
    \ 0b8c d007                 bne     `?L722`
    \ 0b8e a901                 lda     #1
    \ 0b90 c5..                 cmp     zp:_Zp+29
    \ 0b92 f3ac02               lbeq    `?L504`
    \ 0b95 a9f6     `?L722`:    lda     #246
    \ 0b97 c5..                 cmp     zp:_Zp+28
    \ 0b99 d007                 bne     `?L502`
    \ 0b9b a902                 lda     #2
    \ 0b9d c5..                 cmp     zp:_Zp+29
    \ 0b9f f39f02               lbeq    `?L504`
    \ 0ba2          `?L502`:
    \ 0ba2 20....               jsr     `?L2033`
    \ 0ba5 d33d01               lbne    `?L518`
    \ 0ba8 a5..                 lda     zp:_Zp+24
    \ 0baa 20....               jsr     `?L1908`
    \ 0bad e3..                 inw     zp:_Zp
    \ 0baf 20....               jsr     `?L1927`
    \ 0bb2 1a                   inc     a
    \ 0bb3 f32f01               lbeq    `?L518`
    \ 0bb6 98                   tya
    \ 0bb7 85..                 sta     zp:_Zp+3
    \ 0bb9 a9f8                 lda     #248
    \ 0bbb 85..                 sta     zp:_Zp
    \ 0bbd a900                 lda     #0
    \ 0bbf 85..                 sta     zp:_Zp+1
    \ 0bc1          `?L522`:
    \ 0bc1 a5..                 lda     zp:_Zp
    \ 0bc3 05..                 ora     zp:_Zp+1
    \ 0bc5 d3cf00               lbne    `?L521`
    \ 0bc8 a301                 ldz     #1
    \ 0bca d4..                 cpz     zp:_Zp+3
    \ 0bcc b014                 bcs     `?L528`
    \ 0bce 20....               jsr     `?L1909`
    \ 0bd1 a9..                 lda     #.byte0 `_StringLiteral_entries is not supported`
    \ 0bd3 85..                 sta     zp:_Zp+4
    \ 0bd5 a9..                 lda     #.byte1 `_StringLiteral_entries is not supported`
    \ 0bd7 85..                 sta     zp:_Zp+5
    \ 0bd9 a9..                 lda     #.byte0 `_StringLiteral_on multiple selected`
    \ 0bdb 85..                 sta     zp:_Zp+2
    \ 0bdd a9..                 lda     #.byte1 `_StringLiteral_on multiple selected`
    \ 0bdf 4c....               jmp     `?L1886`
    \ 0be2 a01e     `?L528`:    ldy     #30
    \ 0be4 b1..                 lda     (_Zp+30),y
    \ 0be6 85..                 sta     zp:_Zp+26
    \ 0be8 c8                   iny
    \ 0be9 b1..                 lda     (_Zp+30),y
    \ 0beb 85..                 sta     zp:_Zp+27
    \ 0bed 88                   dey
    \ 0bee b1..                 lda     (_Zp+30),y
    \ 0bf0 85..                 sta     zp:_Zp
    \ 0bf2 c8                   iny
    \ 0bf3 b1..                 lda     (_Zp+30),y
    \ 0bf5 20....               jsr     `?L2006`
    \ 0bf8 a303                 ldz     #3
    \ 0bfa 18                   clc
    \ 0bfb 72..                 adc     (_Zp+30),z
    \ 0bfd 85..                 sta     zp:_Zp+4
    \ 0bff a003                 ldy     #3
    \ 0c01 b1..                 lda     (_Zp+30),y
    \ 0c03 85..                 sta     zp:_Zp+3
    \ 0c05 b1..                 lda     (_Zp+30),y
    \ 0c07 20....               jsr     `?L1949`
    \ 0c0a a5..                 lda     zp:_Zp+24
    \ 0c0c 20....               jsr     `?L1929`
    \ 0c0f a000                 ldy     #0
    \ 0c11 b1..                 lda     (_Zp+6),y
    \ 0c13 20....               jsr     `?L1921`
    \ 0c16 20....               jsr     BAMCheckSizeinFilebuffer
    \ 0c19 a5..                 lda     zp:_Zp
    \ 0c1b c5..                 cmp     zp:_Zp+26
    \ 0c1d d05c                 bne     `?L533`
    \ 0c1f a5..                 lda     zp:_Zp+1
    \ 0c21 c5..                 cmp     zp:_Zp+27
    \ 0c23 d056                 bne     `?L533`
    \ 0c25 a5..                 lda     zp:_Zp+24
    \ 0c27 d005                 bne     `?L782`
    \ 0c29 20....               jsr     `?L2057`
    \ 0c2c 8003                 bra     `?L1845`
    \ 0c2e          `?L782`:
    \ 0c2e 20....               jsr     `?L2058`
    \ 0c31          `?L1845`:
    \ 0c31 85..                 sta     zp:_Zp+5
    \ 0c33 20....               jsr     `?L1909`
    \ 0c36 20....               jsr     `?L1928`
    \ 0c39 20....               jsr     `?L2072`
    \ 0c3c 20....               jsr     `?L1934`
    \ 0c3f 20....               jsr     `?L1915`
    \ 0c42 aa                   tax
    \ 0c43 f30d02               lbeq    `?L469`
    \ 0c46 a5..                 lda     zp:_Zp+24
    \ 0c48 20....               jsr     `?L1921`
    \ 0c4b 20....               jsr     GetBAM
    \ 0c4e a5..                 lda     zp:_Zp+24
    \ 0c50 20....               jsr     `?L1908`
    \ 0c53 20....               jsr     `?L1927`
    \ 0c56 85..                 sta     zp:_Zp+3
    \ 0c58 a5..                 lda     zp:_Zp+24
    \ 0c5a 20....               jsr     `?L1908`
    \ 0c5d 20....               jsr     `?L1947`
    \ 0c60 a5..                 lda     zp:_Zp+24
    \ 0c62 20....               jsr     `?L1919`
    \ 0c65 20....               jsr     deletedirententry
    \ 0c68 a5..                 lda     zp:_Zp+24
    \ 0c6a 20....               jsr     `?L1908`
    \ 0c6d 20....               jsr     `?L1947`
    \ 0c70 a5..                 lda     zp:_Zp+24
    \ 0c72 20....               jsr     `?L1919`
    \ 0c75 20....               jsr     PutBAM
    \ 0c78 4c....               jmp     `?L508`
    \ 0c7b          `?L533`:
    \ 0c7b 20....               jsr     `?L1909`
    \ 0c7e a9..                 lda     #.byte0 `_StringLiteral_directory is not empty`
    \ 0c80 85..                 sta     zp:_Zp+4
    \ 0c82 a9..                 lda     #.byte1 `_StringLiteral_directory is not empty`
    \ 0c84 85..                 sta     zp:_Zp+5
    \ 0c86 20....               jsr     `?L1928`
    \ 0c89          `?L1886`:
    \ 0c89 20....               jsr     `?L2072`
    \ 0c8c          `?L1885`:
    \ 0c8c 85..                 sta     zp:_Zp+1
    \ 0c8e a904                 lda     #4
    \ 0c90 20....               jsr     `?L1915`
    \ 0c93 4c....               jmp     `?L469`
    \ 0c96          `?L521`:
    \ 0c96 a6..                 ldx     zp:_Zp+24
    \ 0c98 86..                 stx     zp:_Zp+4
    \ 0c9a 98                   tya
    \ 0c9b 85..                 sta     zp:_Zp+5
    \ 0c9d cb....               asw     _Zp+4
    \ 0ca0 cb....               asw     _Zp+4
    \ 0ca3 cb....               asw     _Zp+4
    \ 0ca6 a5..                 lda     zp:_Zp+4
    \ 0ca8 85..                 sta     zp:_Zp+6
    \ 0caa a5..                 lda     zp:_Zp+5
    \ 0cac 85..                 sta     zp:_Zp+7
    \ 0cae a905                 lda     #5
    \ 0cb0 aa                   tax
    \ 0cb1 f006                 beq     `?L1631`
    \ 0cb3          `?L1632`:
    \ 0cb3 cb....               asw     _Zp+6
    \ 0cb6 ca                   dex
    \ 0cb7 d0fa                 bne     `?L1632`
    \ 0cb9          `?L1631`:
    \ 0cb9 a5..                 lda     zp:_Zp+6
    \ 0cbb 38                   sec
    \ 0cbc e5..                 sbc     zp:_Zp+4
    \ 0cbe 85..                 sta     zp:_Zp+4
    \ 0cc0 a5..                 lda     zp:_Zp+7
    \ 0cc2 e5..                 sbc     zp:_Zp+5
    \ 0cc4 85..                 sta     zp:_Zp+5
    \ 0cc6 18                   clc
    \ 0cc7 a5..                 lda     zp:_Zp+4
    \ 0cc9 69..                 adc     #.byte0 direntflags
    \ 0ccb 85..                 sta     zp:_Zp+4
    \ 0ccd a5..                 lda     zp:_Zp+5
    \ 0ccf 20....               jsr     `?L2064`
    \ 0cd2 c6..                 dec     zp:_Zp+2
    \ 0cd4 ab....               ldz     _Zp+2
    \ 0cd7 a901                 lda     #1
    \ 0cd9 32..                 and     (_Zp+4),z
    \ 0cdb f002                 beq     `?L523`
    \ 0cdd e6..                 inc     zp:_Zp+3
    \ 0cdf          `?L523`:
    \ 0cdf c3..                 dew     zp:_Zp
    \ 0ce1 4c....               jmp     `?L522`
    \ 0ce4 a002     `?L518`:    ldy     #2
    \ 0ce6 b1..                 lda     (_Zp+30),y
    \ 0ce8 f30101               lbeq    `?L537`
    \ 0ceb a31e                 ldz     #30
    \ 0ced b2..                 lda     (_Zp+30),z
    \ 0cef 1b                   inz
    \ 0cf0 12..                 ora     (_Zp+30),z
    \ 0cf2 f3f700               lbeq    `?L537`
    \ 0cf5 a5..                 lda     zp:_Zp+24
    \ 0cf7 d005                 bne     `?L788`
    \ 0cf9 20....               jsr     `?L2057`
    \ 0cfc 8003                 bra     `?L1843`
    \ 0cfe          `?L788`:
    \ 0cfe 20....               jsr     `?L2058`
    \ 0d01          `?L1843`:
    \ 0d01 85..                 sta     zp:_Zp+5
    \ 0d03 20....               jsr     `?L1909`
    \ 0d06 20....               jsr     `?L1933`
    \ 0d09 20....               jsr     `?L2056`
    \ 0d0c a9..                 lda     #.byte0 `_StringLiteral_File delete,`
    \ 0d0e 85..                 sta     zp:_Zp
    \ 0d10 a9..                 lda     #.byte1 `_StringLiteral_File delete,`
    \ 0d12 20....               jsr     `?L1934`
    \ 0d15 20....               jsr     `?L1915`
    \ 0d18 aa                   tax
    \ 0d19 f33701               lbeq    `?L469`
    \ 0d1c a5..                 lda     zp:_Zp+24
    \ 0d1e 20....               jsr     `?L1908`
    \ 0d21 20....               jsr     `?L1942`
    \ 0d24 d02d                 bne     `?L543`
    \ 0d26 20....               jsr     `?L1962`
    \ 0d29 9020                 bcc     `?L546`
    \ 0d2b 20....               jsr     `?L1909`
    \ 0d2e a9..                 lda     #.byte0 `_StringLiteral_not found`
    \ 0d30 85..                 sta     zp:_Zp+4
    \ 0d32 a9..                 lda     #.byte1 `_StringLiteral_not found`
    \ 0d34 85..                 sta     zp:_Zp+5
    \ 0d36 20....               jsr     `?L1928`
    \ 0d39 85..                 sta     zp:_Zp+3
    \ 0d3b a9..                 lda     #.byte0 `_StringLiteral_File `
    \ 0d3d 85..                 sta     zp:_Zp
    \ 0d3f a9..                 lda     #.byte1 `_StringLiteral_File `
    \ 0d41 85..                 sta     zp:_Zp+1
    \ 0d43 a904                 lda     #4
    \ 0d45 20....               jsr     `?L1915`
    \ 0d48 4c....               jmp     `?L563`
    \ 0d4b          `?L546`:
    \ 0d4b a5..                 lda     zp:_Zp+26
    \ 0d4d 20....               jsr     hyppo_rmfile
    \ 0d50 4c....               jmp     `?L563`
    \ 0d53          `?L543`:
    \ 0d53 a5..                 lda     zp:_Zp+24
    \ 0d55 20....               jsr     sizeselectcurrentifnone
    \ 0d58 a5..                 lda     zp:_Zp
    \ 0d5a 25..                 and     zp:_Zp+1
    \ 0d5c 1a                   inc     a
    \ 0d5d f3e900               lbeq    `?L508`
    \ 0d60 a9f8                 lda     #248
    \ 0d62 85..                 sta     zp:_Zp+26
    \ 0d64 a900                 lda     #0
    \ 0d66 85..                 sta     zp:_Zp+27
    \ 0d68          `?L553`:
    \ 0d68 a5..                 lda     zp:_Zp+26
    \ 0d6a 05..                 ora     zp:_Zp+27
    \ 0d6c f3da00               lbeq    `?L508`
    \ 0d6f 20....               jsr     `?L1952`
    \ 0d72 20....               jsr     `?L1912`
    \ 0d75 f005                 beq     `?L1645`
    \ 0d77          `?L1646`:
    \ 0d77 20....               jsr     `?L1990`
    \ 0d7a d0fb                 bne     `?L1646`
    \ 0d7c          `?L1645`:
    \ 0d7c 20....               jsr     `?L1911`
    \ 0d7f a5..                 lda     zp:_Zp+26
    \ 0d81 85..                 sta     zp:_Zp
    \ 0d83 c6..                 dec     zp:_Zp
    \ 0d85 ab....               ldz     _Zp
    \ 0d88 a901                 lda     #1
    \ 0d8a 32..                 and     (_Zp+2),z
    \ 0d8c f058                 beq     `?L554`
    \ 0d8e 20....               jsr     `?L1944`
    \ 0d91 c3..                 dew     zp:_Zp
    \ 0d93 20....               jsr     `?L1935`
    \ 0d96 20....               jsr     `?L1937`
    \ 0d99 20....               jsr     `?L2068`
    \ 0d9c a5..                 lda     zp:_Zp+24
    \ 0d9e 20....               jsr     `?L1921`
    \ 0da1 20....               jsr     GetBAM
    \ 0da4 a9..                 lda     #.byte0 `_StringLiteral_removing BAM entries`
    \ 0da6 85..                 sta     zp:_Zp+2
    \ 0da8 a9..                 lda     #.byte1 `_StringLiteral_removing BAM entries`
    \ 0daa 20....               jsr     `?L1946`
    \ 0dad a928                 lda     #40
    \ 0daf 20....               jsr     progress
    \ 0db2 a5..                 lda     zp:_Zp+26
    \ 0db4 85..                 sta     zp:_Zp+3
    \ 0db6 c6..                 dec     zp:_Zp+3
    \ 0db8 a5..                 lda     zp:_Zp+24
    \ 0dba 20....               jsr     `?L1908`
    \ 0dbd 20....               jsr     `?L1947`
    \ 0dc0 a5..                 lda     zp:_Zp+24
    \ 0dc2 20....               jsr     `?L1919`
    \ 0dc5 20....               jsr     deletedirententry
    \ 0dc8 a9..                 lda     #.byte0 `_StringLiteral_updating BAM`
    \ 0dca 85..                 sta     zp:_Zp+2
    \ 0dcc a9..                 lda     #.byte1 `_StringLiteral_updating BAM`
    \ 0dce 20....               jsr     `?L1946`
    \ 0dd1 a950                 lda     #80
    \ 0dd3 20....               jsr     progress
    \ 0dd6 a5..                 lda     zp:_Zp+24
    \ 0dd8 20....               jsr     `?L1908`
    \ 0ddb 20....               jsr     `?L1947`
    \ 0dde a5..                 lda     zp:_Zp+24
    \ 0de0 20....               jsr     `?L1919`
    \ 0de3 20....               jsr     PutBAM
    \ 0de6          `?L554`:
    \ 0de6 c3..                 dew     zp:_Zp+26
    \ 0de8 4c....               jmp     `?L553`
    \ 0deb          `?L537`:
    \ 0deb a5..                 lda     zp:_Zp+24
    \ 0ded d005                 bne     `?L785`
    \ 0def 20....               jsr     `?L2057`
    \ 0df2 8003                 bra     `?L1844`
    \ 0df4          `?L785`:
    \ 0df4 20....               jsr     `?L2058`
    \ 0df7          `?L1844`:
    \ 0df7 85..                 sta     zp:_Zp+5
    \ 0df9 20....               jsr     `?L1909`
    \ 0dfc 20....               jsr     `?L1928`
    \ 0dff 85..                 sta     zp:_Zp+3
    \ 0e01 a9..                 lda     #.byte0 `_StringLiteral_Directory structure delete,`
    \ 0e03 85..                 sta     zp:_Zp
    \ 0e05 a9..                 lda     #.byte1 `_StringLiteral_Directory structure delete,`
    \ 0e07 20....               jsr     `?L1934`
    \ 0e0a 20....               jsr     `?L1915`
    \ 0e0d aa                   tax
    \ 0e0e f038                 beq     `?L508`
    \ 0e10 20....               jsr     `?L1962`
    \ 0e13 901f                 bcc     `?L562`
    \ 0e15 20....               jsr     `?L1909`
    \ 0e18 a9..                 lda     #.byte0 `_StringLiteral_not found`
    \ 0e1a 85..                 sta     zp:_Zp+4
    \ 0e1c a9..                 lda     #.byte1 `_StringLiteral_not found`
    \ 0e1e 85..                 sta     zp:_Zp+5
    \ 0e20 20....               jsr     `?L1928`
    \ 0e23 85..                 sta     zp:_Zp+3
    \ 0e25 a9..                 lda     #.byte0 `_StringLiteral_Directory `
    \ 0e27 85..                 sta     zp:_Zp
    \ 0e29 a9..                 lda     #.byte1 `_StringLiteral_Directory `
    \ 0e2b 85..                 sta     zp:_Zp+1
    \ 0e2d a904                 lda     #4
    \ 0e2f 20....               jsr     `?L1915`
    \ 0e32 8005                 bra     `?L563`
    \ 0e34          `?L562`:
    \ 0e34 a5..                 lda     zp:_Zp+26
    \ 0e36 20....               jsr     hyppo_rmdir
    \ 0e39          `?L563`:
    \ 0e39 a5..                 lda     zp:_Zp+26
    \ 0e3b 20....               jsr     hyppo_closedir
    \ 0e3e 8008                 bra     `?L508`
    \ 0e40          `?L504`:
    \ 0e40 20....               jsr     `?L2059`
    \ 0e43          `?L506`:
    \ 0e43 20....               jsr     `?L1986`
    \ 0e46 9015                 bcc     `?L505`
    \ 0e48          `?L508`:
    \ 0e48 a5..                 lda     zp:_Zp+24
    \ 0e4a 85..                 sta     zp:_Zp
    \ 0e4c          `?L1901`:
    \ 0e4c 20....               jsr     `?L1913`
    \ 0e4f 20....               jsr     `?L1954`
    \ 0e52          `?L469`:
    \ 0e52 a5..                 lda     zp:_Zp+30
    \ 0e54 85..                 sta     zp:_Zp+26
    \ 0e56 a5..                 lda     zp:_Zp+31
    \ 0e58 85..                 sta     zp:_Zp+27
    \ 0e5a 4c....               jmp     `?L325`
    \ 0e5d          `?L505`:
    \ 0e5d 20....               jsr     `?L1952`
    \ 0e60 20....               jsr     `?L1912`
    \ 0e63 f005                 beq     `?L1671`
    \ 0e65          `?L1672`:
    \ 0e65 20....               jsr     `?L1990`
    \ 0e68 d0fb                 bne     `?L1672`
    \ 0e6a          `?L1671`:
    \ 0e6a 20....               jsr     `?L1911`
    \ 0e6d 20....               jsr     `?L1958`
    \ 0e70 f30e01               lbeq    `?L507`
    \ 0e73 20....               jsr     `?L1944`
    \ 0e76 20....               jsr     `?L1935`
    \ 0e79 a9..                 lda     #.byte0 `_StringLiteral_Enter the new name, empty to skip:`
    \ 0e7b 85..                 sta     zp:_Zp+2
    \ 0e7d a9..                 lda     #.byte1 `_StringLiteral_Enter the new name, empty to skip:`
    \ 0e7f 20....               jsr     `?L1941`
    \ 0e82 a94a                 lda     #74
    \ 0e84 20....               jsr     `?L1914`
    \ 0e87 20....               jsr     strcpy
    \ 0e8a 20....               jsr     `?L1933`
    \ 0e8d a900                 lda     #0
    \ 0e8f 7d....               adc     midnight+1,x
    \ 0e92 20....               jsr     `?L1941`
    \ 0e95 a94a                 lda     #74
    \ 0e97 20....               jsr     `?L1914`
    \ 0e9a 20....               jsr     inputbox
    \ 0e9d a5..                 lda     zp:_Zp+24
    \ 0e9f 20....               jsr     `?L1908`
    \ 0ea2 a04a                 ldy     #74
    \ 0ea4 b1..                 lda     (_Zp),y
    \ 0ea6 f3d800               lbeq    `?L507`
    \ 0ea9 20....               jsr     `?L1928`
    \ 0eac 20....               jsr     `?L1941`
    \ 0eaf 98                   tya
    \ 0eb0 20....               jsr     `?L1914`
    \ 0eb3 20....               jsr     `?L2067`
    \ 0eb6 20....               jsr     `?L1952`
    \ 0eb9 85..                 sta     zp:_Zp+1
    \ 0ebb 85..                 sta     zp:_Zp+3
    \ 0ebd a5..                 lda     zp:_Zp+1
    \ 0ebf 85..                 sta     zp:_Zp+2
    \ 0ec1 a5..                 lda     zp:_Zp
    \ 0ec3 20....               jsr     `?L1934`
    \ 0ec6 85..                 sta     zp:_Zp
    \ 0ec8 4242a5..             ldq     zp:_Zp
    \ 0ecc 424285..             stq     zp:_Zp+4
    \ 0ed0 a905                 lda     #5
    \ 0ed2 aa                   tax
    \ 0ed3 f007                 beq     `?L1678`
    \ 0ed5          `?L1679`:
    \ 0ed5 424206..             aslq    zp:_Zp+4
    \ 0ed9 ca                   dex
    \ 0eda d0f9                 bne     `?L1679`
    \ 0edc          `?L1678`:
    \ 0edc 20....               jsr     _SpillZP
    \ 0edf 04..                 .byte   4,_Zp+4
    \ 0ee1 20....               jsr     _FillQ
    \ 0ee4 38                   sec
    \ 0ee5 4242e5..             sbcq    zp:_Zp
    \ 0ee9 20....               jsr     `?L2000`
    \ 0eec a920                 lda     #32
    \ 0eee 91..                 sta     (_Vsp),y
    \ 0ef0 a900                 lda     #0
    \ 0ef2 aa                   tax
    \ 0ef3 a308                 ldz     #8
    \ 0ef5 20....               jsr     `?L2008`
    \ 0ef8 48                   pha
    \ 0ef9 da                   phx
    \ 0efa 5a                   phy
    \ 0efb db                   phz
    \ 0efc 20....               jsr     `?L1944`
    \ 0eff a905                 lda     #5
    \ 0f01 aa                   tax
    \ 0f02 f006                 beq     `?L1682`
    \ 0f04          `?L1683`:
    \ 0f04 cb....               asw     _Zp
    \ 0f07 ca                   dex
    \ 0f08 d0fa                 bne     `?L1683`
    \ 0f0a a900     `?L1682`:   lda     #0
    \ 0f0c 85..                 sta     zp:_Zp+2
    \ 0f0e 85..                 sta     zp:_Zp+3
    \ 0f10 fb                   plz
    \ 0f11 7a                   ply
    \ 0f12 fa                   plx
    \ 0f13 68                   pla
    \ 0f14 20....               jsr     `?L2008`
    \ 0f17 424285..             stq     zp:_Zp+4
    \ 0f1b a5..                 lda     zp:_Zp+30
    \ 0f1d 85..                 sta     zp:_Zp
    \ 0f1f a5..                 lda     zp:_Zp+31
    \ 0f21 20....               jsr     `?L1934`
    \ 0f24 85..                 sta     zp:_Zp+2
    \ 0f26 85..                 sta     zp:_Zp+3
    \ 0f28 20....               jsr     `?L2050`
    \ 0f2b 20....               jsr     `?L2033`
    \ 0f2e d023                 bne     `?L516`
    \ 0f30 a5..                 lda     zp:_Zp+30
    \ 0f32 18                   clc
    \ 0f33 6905                 adc     #5
    \ 0f35 85..                 sta     zp:_Zp+4
    \ 0f37 a5..                 lda     zp:_Zp+31
    \ 0f39 6900                 adc     #0
    \ 0f3b 85..                 sta     zp:_Zp+5
    \ 0f3d a003                 ldy     #3
    \ 0f3f b1..                 lda     (_Zp+30),y
    \ 0f41 20....               jsr     `?L1949`
    \ 0f44 a5..                 lda     zp:_Zp+24
    \ 0f46 20....               jsr     `?L1929`
    \ 0f49 a000                 ldy     #0
    \ 0f4b b1..                 lda     (_Zp+6),y
    \ 0f4d 20....               jsr     `?L1921`
    \ 0f50 20....               jsr     renamedisk
    \ 0f53          `?L516`:
    \ 0f53 a5..                 lda     zp:_Zp+24
    \ 0f55 20....               jsr     `?L1908`
    \ 0f58 a049                 ldy     #73
    \ 0f5a b1..                 lda     (_Zp),y
    \ 0f5c 85..                 sta     zp:_Zp+4
    \ 0f5e a5..                 lda     zp:_Zp+24
    \ 0f60 20....               jsr     `?L1908`
    \ 0f63 88                   dey
    \ 0f64 b1..                 lda     (_Zp),y
    \ 0f66 85..                 sta     zp:_Zp+3
    \ 0f68 a5..                 lda     zp:_Zp+24
    \ 0f6a 20....               jsr     `?L1908`
    \ 0f6d 88                   dey
    \ 0f6e 20....               jsr     `?L1948`
    \ 0f71 a5..                 lda     zp:_Zp+24
    \ 0f73 20....               jsr     `?L1929`
    \ 0f76 a000                 ldy     #0
    \ 0f78 b1..                 lda     (_Zp+6),y
    \ 0f7a 20....               jsr     `?L1921`
    \ 0f7d 20....               jsr     rewritedirent
    \ 0f80          `?L507`:
    \ 0f80 e3..                 inw     zp:_Zp+26
    \ 0f82 4c....               jmp     `?L506`
    \ 0f85          `?L455`:
    \ 0f85 20....               jsr     `?L1952`
    \ 0f88 20....               jsr     `?L1912`
    \ 0f8b f005                 beq     `?L1689`
    \ 0f8d          `?L1690`:
    \ 0f8d 20....               jsr     `?L1990`
    \ 0f90 d0fb                 bne     `?L1690`
    \ 0f92          `?L1689`:
    \ 0f92 20....               jsr     `?L1911`
    \ 0f95 20....               jsr     `?L1958`
    \ 0f98 f034                 beq     `?L457`
    \ 0f9a 20....               jsr     `?L1952`
    \ 0f9d 20....               jsr     `?L1912`
    \ 0fa0 f005                 beq     `?L1692`
    \ 0fa2          `?L1693`:
    \ 0fa2 20....               jsr     `?L1990`
    \ 0fa5 d0fb                 bne     `?L1693`
    \ 0fa7          `?L1692`:
    \ 0fa7 20....               jsr     `?L1911`
    \ 0faa a5..                 lda     zp:_Zp+24
    \ 0fac 20....               jsr     `?L1908`
    \ 0faf 20....               jsr     `?L1927`
    \ 0fb2 4b                   taz
    \ 0fb3 a901                 lda     #1
    \ 0fb5 32..                 and     (_Zp+2),z
    \ 0fb7 d00d                 bne     `?L463`
    \ 0fb9 a5..                 lda     zp:_Zp+26
    \ 0fbb 85..                 sta     zp:_Zp
    \ 0fbd a5..                 lda     zp:_Zp+24
    \ 0fbf 20....               jsr     `?L1923`
    \ 0fc2 a5..                 lda     zp:_Zp
    \ 0fc4 91..                 sta     (_Zp+2),y
    \ 0fc6          `?L463`:
    \ 0fc6 20....               jsr     `?L1944`
    \ 0fc9 20....               jsr     `?L1935`
    \ 0fcc e6..                 inc     zp:_Zp+32
    \ 0fce          `?L457`:
    \ 0fce e3..                 inw     zp:_Zp+26
    \ 0fd0 4c....               jmp     `?L456`
    \ 0fd3          `?L381`:
    \ 0fd3 20....               jsr     sidbong
    \ 0fd6 4c....               jmp     `?L325`
    \ 0fd9          `?L416`:
    \ 0fd9 a5..                 lda     zp:_Zp+24
    \ 0fdb 0a                   asl     a
    \ 0fdc aa                   tax
    \ 0fdd 18                   clc
    \ 0fde a946                 lda     #70
    \ 0fe0 20....               jsr     `?L1914`
    \ 0fe3 a901                 lda     #1
    \ 0fe5 a300                 ldz     #0
    \ 0fe7 52..                 eor     (_Zp),z
    \ 0fe9 92..                 sta     (_Zp),z
    \ 0feb a5..                 lda     zp:_Zp+24
    \ 0fed 20....               jsr     `?L1908`
    \ 0ff0 a928                 lda     #40
    \ 0ff2 20....               jsr     `?L1988`
    \ 0ff5 20....               jsr     `?L1908`
    \ 0ff8 a901                 lda     #1
    \ 0ffa c8                   iny
    \ 0ffb 20....               jsr     `?L1989`
    \ 0ffe 20....               jsr     `?L1908`
    \ 1001 a950                 lda     #80
    \ 1003 c8                   iny
    \ 1004 20....               jsr     `?L1989`
    \ 1007 85..                 sta     zp:_Zp
    \ 1009 20....               jsr     `?L1913`
    \ 100c 20....               jsr     `?L1954`
    \ 100f 4c....               jmp     `?L325`
    \ 1012 a30a     `?L423`:    ldz     #10
    \ 1014 a5..                 lda     zp:_Zp+24
    \ 1016 20....               jsr     `?L1908`
    \ 1019 20....               jsr     `?L1927`
    \ 101c 85..                 sta     zp:_Zp
    \ 101e d4..                 cpz     zp:_Zp
    \ 1020 b00e                 bcs     `?L444`
    \ 1022 a5..                 lda     zp:_Zp+24
    \ 1024 20....               jsr     `?L1908`
    \ 1027 e3..                 inw     zp:_Zp
    \ 1029 b1..                 lda     (_Zp),y
    \ 102b 38                   sec
    \ 102c e90a                 sbc     #10
    \ 102e 8008                 bra     `?L1890`
    \ 1030          `?L444`:
    \ 1030 a5..                 lda     zp:_Zp+24
    \ 1032 20....               jsr     `?L1908`
    \ 1035 e3..                 inw     zp:_Zp
    \ 1037 98                   tya
    \ 1038          `?L1890`:
    \ 1038 91..                 sta     (_Zp),y
    \ 103a 4c....               jmp     `?L325`
    \ 103d          `?L427`:
    \ 103d a5..                 lda     zp:_Zp+24
    \ 103f 20....               jsr     `?L1908`
    \ 1042 e3..                 inw     zp:_Zp
    \ 1044 a000                 ldy     #0
    \ 1046 b1..                 lda     (_Zp),y
    \ 1048 f3c9f0               lbeq    `?L325`
    \ 104b a5..                 lda     zp:_Zp+24
    \ 104d 20....               jsr     `?L1908`
    \ 1050 20....               jsr     `?L1987`
    \ 1053 f05e                 beq     `?L434`
    \ 1055 a6..                 ldx     zp:_Zp+24
    \ 1057 86..                 stx     zp:_Zp
    \ 1059 98                   tya
    \ 105a 20....               jsr     `?L1912`
    \ 105d f005                 beq     `?L1699`
    \ 105f          `?L1700`:
    \ 105f 20....               jsr     `?L1990`
    \ 1062 d0fb                 bne     `?L1700`
    \ 1064          `?L1699`:
    \ 1064 20....               jsr     `?L1911`
    \ 1067 a5..                 lda     zp:_Zp+24
    \ 1069 20....               jsr     `?L1908`
    \ 106c 20....               jsr     `?L2046`
    \ 106f f042                 beq     `?L434`
    \ 1071 a5..                 lda     zp:_Zp+24
    \ 1073 20....               jsr     `?L1908`
    \ 1076 20....               jsr     `?L2047`
    \ 1079 c3..                 dew     zp:_Zp+2
    \ 107b a5..                 lda     zp:_Zp+24
    \ 107d 20....               jsr     `?L1908`
    \ 1080 20....               jsr     `?L2002`
    \ 1083 a5..                 lda     zp:_Zp+24
    \ 1085 20....               jsr     swapdirententry
    \ 1088 20....               jsr     `?L1954`
    \ 108b 20....               jsr     `?L1952`
    \ 108e 20....               jsr     `?L1912`
    \ 1091 f005                 beq     `?L1704`
    \ 1093          `?L1705`:
    \ 1093 20....               jsr     `?L1990`
    \ 1096 d0fb                 bne     `?L1705`
    \ 1098          `?L1704`:
    \ 1098 20....               jsr     `?L1911`
    \ 109b a5..                 lda     zp:_Zp+24
    \ 109d 20....               jsr     `?L1908`
    \ 10a0 20....               jsr     `?L1927`
    \ 10a3 3a                   dec     a
    \ 10a4 20....               jsr     `?L1976`
    \ 10a7 9002                 bcc     `?L1707`
    \ 10a9 e6..                 inc     zp:_Zp+3
    \ 10ab a901     `?L1707`:   lda     #1
    \ 10ad a300                 ldz     #0
    \ 10af 12..                 ora     (_Zp+2),z
    \ 10b1 92..                 sta     (_Zp+2),z
    \ 10b3          `?L434`:
    \ 10b3 a5..                 lda     zp:_Zp+24
    \ 10b5 20....               jsr     `?L1908`
    \ 10b8 e3..                 inw     zp:_Zp
    \ 10ba b1..                 lda     (_Zp),y
    \ 10bc 3a                   dec     a
    \ 10bd 91..                 sta     (_Zp),y
    \ 10bf 4c....               jmp     `?L325`
    \ 10c2          `?L393`:
    \ 10c2 a5..                 lda     zp:_Zp+24
    \ 10c4 20....               jsr     `?L1908`
    \ 10c7 20....               jsr     `?L1942`
    \ 10ca d006                 bne     `?L620`
    \ 10cc 20....               jsr     sidbong
    \ 10cf 4c....               jmp     `?L325`
    \ 10d2          `?L620`:
    \ 10d2 20....               jsr     `?L1952`
    \ 10d5 20....               jsr     `?L1912`
    \ 10d8 f005                 beq     `?L1710`
    \ 10da          `?L1711`:
    \ 10da 20....               jsr     `?L1990`
    \ 10dd d0fb                 bne     `?L1711`
    \ 10df          `?L1710`:
    \ 10df 20....               jsr     `?L1911`
    \ 10e2 a5..                 lda     zp:_Zp+24
    \ 10e4 20....               jsr     `?L1908`
    \ 10e7 20....               jsr     `?L1927`
    \ 10ea 20....               jsr     `?L1976`
    \ 10ed 9002                 bcc     `?L1713`
    \ 10ef e6..                 inc     zp:_Zp+3
    \ 10f1          `?L1713`:
    \ 10f1 20....               jsr     `?L2066`
    \ 10f4 a5..                 lda     zp:_Zp+24
    \ 10f6 20....               jsr     `?L1908`
    \ 10f9 20....               jsr     `?L1987`
    \ 10fc d315f0               lbne    `?L325`
    \ 10ff a5..                 lda     zp:_Zp+24
    \ 1101 20....               jsr     `?L1908`
    \ 1104 20....               jsr     `?L2003`
    \ 1107 92..                 sta     (_Zp),z
    \ 1109 4c....               jmp     `?L325`
    \ 110c          `?L388`:
    \ 110c 20....               jsr     `?L1992`
    \ 110f 20....               jsr     helpbox
    \ 1112 4c....               jmp     `?L325`
    \ 1115          `?L422`:
    \ 1115 a5..                 lda     zp:_Zp+24
    \ 1117 20....               jsr     `?L1908`
    \ 111a e3..                 inw     zp:_Zp
    \ 111c a90a                 lda     #10
    \ 111e a300                 ldz     #0
    \ 1120 18                   clc
    \ 1121 72..                 adc     (_Zp),z
    \ 1123 92..                 sta     (_Zp),z
    \ 1125 4c....               jmp     `?L325`
    \ 1128          `?L426`:
    \ 1128 a5..                 lda     zp:_Zp+24
    \ 112a 20....               jsr     `?L1908`
    \ 112d 20....               jsr     `?L1927`
    \ 1130 48                   pha
    \ 1131 20....               jsr     `?L2034`
    \ 1134 20....               jsr     `?L1925`
    \ 1137 e3..                 inw     zp:_Zp
    \ 1139 20....               jsr     `?L1927`
    \ 113c 85..                 sta     zp:_Zp
    \ 113e 68                   pla
    \ 113f c5..                 cmp     zp:_Zp
    \ 1141 b3d0ef               lbcs    `?L325`
    \ 1144 a5..                 lda     zp:_Zp+24
    \ 1146 20....               jsr     `?L1908`
    \ 1149 20....               jsr     `?L1987`
    \ 114c f05b                 beq     `?L441`
    \ 114e a6..                 ldx     zp:_Zp+24
    \ 1150 86..                 stx     zp:_Zp
    \ 1152 98                   tya
    \ 1153 20....               jsr     `?L1912`
    \ 1156 f005                 beq     `?L1717`
    \ 1158          `?L1718`:
    \ 1158 20....               jsr     `?L1990`
    \ 115b d0fb                 bne     `?L1718`
    \ 115d          `?L1717`:
    \ 115d 20....               jsr     `?L1911`
    \ 1160 a5..                 lda     zp:_Zp+24
    \ 1162 20....               jsr     `?L1908`
    \ 1165 20....               jsr     `?L2046`
    \ 1168 f03f                 beq     `?L441`
    \ 116a a5..                 lda     zp:_Zp+24
    \ 116c 20....               jsr     `?L1908`
    \ 116f 20....               jsr     `?L2047`
    \ 1172 e3..                 inw     zp:_Zp+2
    \ 1174 a5..                 lda     zp:_Zp+24
    \ 1176 20....               jsr     `?L1908`
    \ 1179 20....               jsr     `?L2002`
    \ 117c a5..                 lda     zp:_Zp+24
    \ 117e 20....               jsr     swapdirententry
    \ 1181 20....               jsr     `?L1954`
    \ 1184 20....               jsr     `?L1952`
    \ 1187 20....               jsr     `?L1912`
    \ 118a f005                 beq     `?L1722`
    \ 118c          `?L1723`:
    \ 118c 20....               jsr     `?L1990`
    \ 118f d0fb                 bne     `?L1723`
    \ 1191          `?L1722`:
    \ 1191 20....               jsr     `?L1911`
    \ 1194 a5..                 lda     zp:_Zp+24
    \ 1196 20....               jsr     `?L1908`
    \ 1199 20....               jsr     `?L2003`
    \ 119c 20....               jsr     `?L1976`
    \ 119f 9002                 bcc     `?L1725`
    \ 11a1 e6..                 inc     zp:_Zp+3
    \ 11a3 a901     `?L1725`:   lda     #1
    \ 11a5 12..                 ora     (_Zp+2),z
    \ 11a7 92..                 sta     (_Zp+2),z
    \ 11a9          `?L441`:
    \ 11a9 a5..                 lda     zp:_Zp+24
    \ 11ab 20....               jsr     `?L1908`
    \ 11ae 20....               jsr     `?L2003`
    \ 11b1 92..                 sta     (_Zp),z
    \ 11b3 4c....               jmp     `?L325`
    \ 11b6          `?L392`:
    \ 11b6 a5..                 lda     zp:_Zp+24
    \ 11b8 20....               jsr     `?L1908`
    \ 11bb 20....               jsr     `?L1927`
    \ 11be 85..                 sta     zp:_Zp
    \ 11c0 98                   tya
    \ 11c1 20....               jsr     `?L1960`
    \ 11c4 a6..                 ldx     zp:_Zp+24
    \ 11c6 86..                 stx     zp:_Zp+4
    \ 11c8 a900                 lda     #0
    \ 11ca 85..                 sta     zp:_Zp+5
    \ 11cc 85..                 sta     zp:_Zp+6
    \ 11ce 85..                 sta     zp:_Zp+7
    \ 11d0 a90a                 lda     #10
    \ 11d2 aa                   tax
    \ 11d3 f007                 beq     `?L1728`
    \ 11d5          `?L1729`:
    \ 11d5 424206..             aslq    zp:_Zp+4
    \ 11d9 ca                   dex
    \ 11da d0f9                 bne     `?L1729`
    \ 11dc          `?L1728`:
    \ 11dc 4242a5..             ldq     zp:_Zp+4
    \ 11e0 424285..             stq     zp:_Zp
    \ 11e4 424206..             aslq    zp:_Zp+4
    \ 11e8 424206..             aslq    zp:_Zp+4
    \ 11ec 4242a5..             ldq     zp:_Zp+4
    \ 11f0 20....               jsr     `?L2008`
    \ 11f3 20....               jsr     `?L2000`
    \ 11f6 a940                 lda     #64
    \ 11f8 91..                 sta     (_Vsp),y
    \ 11fa a9..                 lda     #.byte0 lfnname
    \ 11fc a2..                 ldx     #.byte1 lfnname
    \ 11fe a300                 ldz     #0
    \ 1200 424285..             stq     zp:_Zp+4
    \ 1204 a900                 lda     #0
    \ 1206 a23e                 ldx     #62
    \ 1208 a308                 ldz     #8
    \ 120a 20....               jsr     `?L2008`
    \ 120d 48                   pha
    \ 120e da                   phx
    \ 120f 5a                   phy
    \ 1210 db                   phz
    \ 1211 a5..                 lda     zp:_Zp+24
    \ 1213 20....               jsr     `?L1908`
    \ 1216 20....               jsr     `?L1927`
    \ 1219 85..                 sta     zp:_Zp
    \ 121b 98                   tya
    \ 121c 85..                 sta     zp:_Zp+1
    \ 121e a906                 lda     #6
    \ 1220 aa                   tax
    \ 1221 f006                 beq     `?L1732`
    \ 1223          `?L1733`:
    \ 1223 cb....               asw     _Zp
    \ 1226 ca                   dex
    \ 1227 d0fa                 bne     `?L1733`
    \ 1229          `?L1732`:
    \ 1229 a5..                 lda     zp:_Zp+1
    \ 122b 097f                 ora     #127
    \ 122d 3001                 bmi     `?L1735`
    \ 122f 98                   tya
    \ 1230          `?L1735`:
    \ 1230 85..                 sta     zp:_Zp+2
    \ 1232 85..                 sta     zp:_Zp+3
    \ 1234 fb                   plz
    \ 1235 7a                   ply
    \ 1236 fa                   plx
    \ 1237 68                   pla
    \ 1238 20....               jsr     `?L2008`
    \ 123b 424285..             stq     zp:_Zp
    \ 123f 20....               jsr     `?L2050`
    \ 1242 a5..                 lda     zp:_Zp+24
    \ 1244 20....               jsr     `?L1908`
    \ 1247 98                   tya
    \ 1248 a346                 ldz     #70
    \ 124a 32..                 and     (_Zp),z
    \ 124c d39700               lbne    `?L627`
    \ 124f a910                 lda     #16
    \ 1251 a302                 ldz     #2
    \ 1253 32..                 and     (_Zp+26),z
    \ 1255 f02b                 beq     `?L630`
    \ 1257 20....               jsr     `?L1977`
    \ 125a 20....               jsr     `?L2048`
    \ 125d b016                 bcs     `?L633`
    \ 125f 20....               jsr     `?L1909`
    \ 1262 20....               jsr     `?L1975`
    \ 1265 a9..                 lda     #.byte0 `_StringLiteral_Storage card change directory,`
    \ 1267 85..                 sta     zp:_Zp
    \ 1269 a9..                 lda     #.byte1 `_StringLiteral_Storage card change directory,`
    \ 126b 85..                 sta     zp:_Zp+1
    \ 126d a904                 lda     #4
    \ 126f 20....               jsr     `?L1915`
    \ 1272 4c....               jmp     `?L325`
    \ 1275          `?L633`:
    \ 1275 a5..                 lda     zp:_Zp+24
    \ 1277 85..                 sta     zp:_Zp
    \ 1279 20....               jsr     `?L1913`
    \ 127c 20....               jsr     `?L1954`
    \ 127f 4c....               jmp     `?L325`
    \ 1282          `?L630`:
    \ 1282 a5..                 lda     zp:_Zp+24
    \ 1284 20....               jsr     `?L1908`
    \ 1287 88                   dey
    \ 1288 b1..                 lda     (_Zp),y
    \ 128a f014                 beq     `?L636`
    \ 128c 20....               jsr     `?L1977`
    \ 128f ad....               lda     legacyHDOSstate
    \ 1292 d007                 bne     `?L824`
    \ 1294 a901                 lda     #1
    \ 1296 20....               jsr     hyppo_dos_attach
    \ 1299 8017                 bra     `?L1873`
    \ 129b          `?L824`:
    \ 129b 20....               jsr     hyppo_d81attach1
    \ 129e 8012                 bra     `?L1873`
    \ 12a0          `?L636`:
    \ 12a0 20....               jsr     `?L1977`
    \ 12a3 ad....               lda     legacyHDOSstate
    \ 12a6 d007                 bne     `?L821`
    \ 12a8 a900                 lda     #0
    \ 12aa 20....               jsr     hyppo_dos_attach
    \ 12ad 8003                 bra     `?L1873`
    \ 12af          `?L821`:
    \ 12af 20....               jsr     hyppo_d81attach0
    \ 12b2          `?L1873`:
    \ 12b2 85..                 sta     zp:_Zp
    \ 12b4 a34a                 ldz     #74
    \ 12b6 d4..                 cpz     zp:_Zp
    \ 12b8 b01c                 bcs     `?L639`
    \ 12ba 20....               jsr     `?L1909`
    \ 12bd a9..                 lda     #.byte0 lfnname
    \ 12bf 85..                 sta     zp:_Zp+4
    \ 12c1 a9..                 lda     #.byte1 lfnname
    \ 12c3 85..                 sta     zp:_Zp+5
    \ 12c5 a9..                 lda     #.byte0 `_StringLiteral_mount failed for`
    \ 12c7 85..                 sta     zp:_Zp+2
    \ 12c9 a9..                 lda     #.byte1 `_StringLiteral_mount failed for`
    \ 12cb 85..                 sta     zp:_Zp+3
    \ 12cd a9..                 lda     #.byte0 `_StringLiteral_Storage card mounting,`
    \ 12cf 85..                 sta     zp:_Zp
    \ 12d1 a9..                 lda     #.byte1 `_StringLiteral_Storage card mounting,`
    \ 12d3 4c....               jmp     `?L1907`
    \ 12d6          `?L639`:
    \ 12d6 a5..                 lda     zp:_Zp+24
    \ 12d8 0a                   asl     a
    \ 12d9 aa                   tax
    \ 12da 18                   clc
    \ 12db a946                 lda     #70
    \ 12dd 20....               jsr     `?L1914`
    \ 12e0 20....               jsr     `?L1955`
    \ 12e3 804c                 bra     `?L1898`
    \ 12e5 a90f     `?L627`:    lda     #15
    \ 12e7 a302                 ldz     #2
    \ 12e9 32..                 and     (_Zp+26),z
    \ 12eb c905                 cmp     #5
    \ 12ed d04f                 bne     `?L642`
    \ 12ef a5..                 lda     zp:_Zp+24
    \ 12f1 20....               jsr     `?L1908`
    \ 12f4 e3..                 inw     zp:_Zp
    \ 12f6 e3..                 inw     zp:_Zp
    \ 12f8 88                   dey
    \ 12f9 b1..                 lda     (_Zp),y
    \ 12fb 1a                   inc     a
    \ 12fc f040                 beq     `?L642`
    \ 12fe a5..                 lda     zp:_Zp+24
    \ 1300 20....               jsr     `?L1908`
    \ 1303 a003                 ldy     #3
    \ 1305 b1..                 lda     (_Zp+26),y
    \ 1307 20....               jsr     `?L1988`
    \ 130a 20....               jsr     `?L1908`
    \ 130d a003                 ldy     #3
    \ 130f b1..                 lda     (_Zp+26),y
    \ 1311 a048                 ldy     #72
    \ 1313 91..                 sta     (_Zp),y
    \ 1315 a01e                 ldy     #30
    \ 1317 b1..                 lda     (_Zp+26),y
    \ 1319 85..                 sta     zp:_Zp
    \ 131b c8                   iny
    \ 131c b1..                 lda     (_Zp+26),y
    \ 131e 20....               jsr     `?L2006`
    \ 1321 1b                   inz
    \ 1322 18                   clc
    \ 1323 72..                 adc     (_Zp+26),z
    \ 1325 48                   pha
    \ 1326 20....               jsr     `?L2034`
    \ 1329 20....               jsr     `?L1925`
    \ 132c 68                   pla
    \ 132d a049                 ldy     #73
    \ 132f 91..                 sta     (_Zp),y
    \ 1331          `?L1898`:
    \ 1331 a5..                 lda     zp:_Zp+24
    \ 1333 85..                 sta     zp:_Zp
    \ 1335 20....               jsr     `?L1913`
    \ 1338 20....               jsr     `?L1954`
    \ 133b 4c....               jmp     `?L325`
    \ 133e          `?L642`:
    \ 133e 20....               jsr     sidbong
    \ 1341 a5..                 lda     zp:_Zp+24
    \ 1343 20....               jsr     `?L1908`
    \ 1346 e3..                 inw     zp:_Zp
    \ 1348 20....               jsr     `?L1927`
    \ 134b 1a                   inc     a
    \ 134c f3c5ed               lbeq    `?L325`
    \ 134f 20....               jsr     `?L1909`
    \ 1352 20....               jsr     `?L1922`
    \ 1355 a9..                 lda     #.byte0 `_StringLiteral_is not yet implemented.`
    \ 1357 85..                 sta     zp:_Zp+2
    \ 1359 a9..                 lda     #.byte1 `_StringLiteral_is not yet implemented.`
    \ 135b 85..                 sta     zp:_Zp+3
    \ 135d a9..                 lda     #.byte0 `_StringLiteral_This file type/directory`
    \ 135f 85..                 sta     zp:_Zp
    \ 1361 a9..                 lda     #.byte1 `_StringLiteral_This file type/directory`
    \ 1363          `?L1907`:
    \ 1363 85..                 sta     zp:_Zp+1
    \ 1365 a904                 lda     #4
    \ 1367 20....               jsr     `?L1915`
    \ 136a 4c....               jmp     `?L325`
    \ 136d          `?L419`:
    \ 136d a5..                 lda     zp:_Zp+24
    \ 136f d004                 bne     `?L697`
    \ 1371 a901                 lda     #1
    \ 1373 8002                 bra     `?L1870`
    \ 1375 a900     `?L697`:    lda     #0
    \ 1377          `?L1870`:
    \ 1377 85..                 sta     zp:_Zp
    \ 1379 a900                 lda     #0
    \ 137b 85..                 sta     zp:_Zp+1
    \ 137d a5..                 lda     zp:_Zp
    \ 137f 85..                 sta     zp:_Zp+24
    \ 1381 4c....               jmp     `?L325`
    \ 1384          `?L396`:
    \ 1384 a5..                 lda     zp:_Zp+24
    \ 1386 20....               jsr     `?L1908`
    \ 1389 20....               jsr     `?L1942`
    \ 138c d063                 bne     `?L606`
    \ 138e 20....               jsr     `?L2060`
    \ 1391          `?L610`:
    \ 1391 a5..                 lda     zp:_Zp+24
    \ 1393 20....               jsr     `?L1908`
    \ 1396 e3..                 inw     zp:_Zp
    \ 1398 20....               jsr     `?L1927`
    \ 139b c5..                 cmp     zp:_Zp+28
    \ 139d 98                   tya
    \ 139e e5..                 sbc     zp:_Zp+29
    \ 13a0 9371ed               lbcc    `?L325`
    \ 13a3 a5..                 lda     zp:_Zp+28
    \ 13a5 85..                 sta     zp:_Zp
    \ 13a7 a5..                 lda     zp:_Zp+29
    \ 13a9 20....               jsr     `?L1960`
    \ 13ac a910                 lda     #16
    \ 13ae a302                 ldz     #2
    \ 13b0 32..                 and     (_Zp+26),z
    \ 13b2 f039                 beq     `?L611`
    \ 13b4 a005                 ldy     #5
    \ 13b6 b1..                 lda     (_Zp+26),y
    \ 13b8 c92e                 cmp     #46
    \ 13ba d031                 bne     `?L611`
    \ 13bc c8                   iny
    \ 13bd b1..                 lda     (_Zp+26),y
    \ 13bf c92e                 cmp     #46
    \ 13c1 d02a                 bne     `?L611`
    \ 13c3 20....               jsr     `?L2031`
    \ 13c6 20....               jsr     hyppo_setname
    \ 13c9 20....               jsr     `?L2048`
    \ 13cc b015                 bcs     `?L616`
    \ 13ce 20....               jsr     `?L1909`
    \ 13d1 20....               jsr     `?L1975`
    \ 13d4 a9..                 lda     #.byte0 `_StringLiteral_Storage card parent directory,`
    \ 13d6 85..                 sta     zp:_Zp
    \ 13d8 a9..                 lda     #.byte1 `_StringLiteral_Storage card parent directory,`
    \ 13da 85..                 sta     zp:_Zp+1
    \ 13dc a904                 lda     #4
    \ 13de 20....               jsr     `?L1915`
    \ 13e1 800a                 bra     `?L611`
    \ 13e3          `?L616`:
    \ 13e3 a5..                 lda     zp:_Zp+24
    \ 13e5 85..                 sta     zp:_Zp
    \ 13e7 20....               jsr     `?L1913`
    \ 13ea 20....               jsr     `?L1954`
    \ 13ed          `?L611`:
    \ 13ed e3..                 inw     zp:_Zp+28
    \ 13ef 80a0                 bra     `?L610`
    \ 13f1          `?L606`:
    \ 13f1 a5..                 lda     zp:_Zp+24
    \ 13f3 20....               jsr     `?L1908`
    \ 13f6 a928                 lda     #40
    \ 13f8 20....               jsr     `?L1988`
    \ 13fb 20....               jsr     `?L1908`
    \ 13fe a901                 lda     #1
    \ 1400 c8                   iny
    \ 1401 20....               jsr     `?L1989`
    \ 1404 20....               jsr     `?L1908`
    \ 1407 a950                 lda     #80
    \ 1409 c8                   iny
    \ 140a 20....               jsr     `?L1989`
    \ 140d 85..                 sta     zp:_Zp
    \ 140f 20....               jsr     `?L1913`
    \ 1412 20....               jsr     `?L1954`
    \ 1415 4c....               jmp     `?L325`
    \ 1418          `?L376`:
    \ 1418 20....               jsr     sidbong
    \ 141b 4c....               jmp     `?L325`
    \ 141e          `?L328`:
    \ 141e a5..                 lda     zp:_Zp+30
    \ 1420 20....               jsr     `?L1908`
    \ 1423 e3..                 inw     zp:_Zp
    \ 1425 20....               jsr     `?L1927`
    \ 1428 48                   pha
    \ 1429 a6..                 ldx     zp:_Zp+30
    \ 142b 20....               jsr     `?L2035`
    \ 142e 20....               jsr     `?L1925`
    \ 1431 20....               jsr     `?L1927`
    \ 1434 85..                 sta     zp:_Zp
    \ 1436 68                   pla
    \ 1437 c5..                 cmp     zp:_Zp
    \ 1439 b012                 bcs     `?L333`
    \ 143b a5..                 lda     zp:_Zp+30
    \ 143d 20....               jsr     `?L1923`
    \ 1440 e3..                 inw     zp:_Zp+2
    \ 1442 a5..                 lda     zp:_Zp+30
    \ 1444 20....               jsr     `?L1908`
    \ 1447 e3..                 inw     zp:_Zp
    \ 1449 b1..                 lda     (_Zp+2),y
    \ 144b 91..                 sta     (_Zp),y
    \ 144d          `?L333`:
    \ 144d a5..                 lda     zp:_Zp+30
    \ 144f 20....               jsr     `?L1908`
    \ 1452 e3..                 inw     zp:_Zp
    \ 1454 e3..                 inw     zp:_Zp
    \ 1456 b1..                 lda     (_Zp),y
    \ 1458 1a                   inc     a
    \ 1459 d00a                 bne     `?L336`
    \ 145b a5..                 lda     zp:_Zp+30
    \ 145d 20....               jsr     `?L1908`
    \ 1460 e3..                 inw     zp:_Zp
    \ 1462 98                   tya
    \ 1463 91..                 sta     (_Zp),y
    \ 1465          `?L336`:
    \ 1465 a5..                 lda     zp:_Zp+30
    \ 1467 85..                 sta     zp:_Zp+2
    \ 1469 a5..                 lda     zp:_Zp+31
    \ 146b 20....               jsr     `?L1965`
    \ 146e 85..                 sta     zp:_Zp+28
    \ 1470 98                   tya
    \ 1471 85..                 sta     zp:_Zp+6
    \ 1473 a901                 lda     #1
    \ 1475 85..                 sta     zp:_Zp+5
    \ 1477 85..                 sta     zp:_Zp+4
    \ 1479 a903                 lda     #3
    \ 147b 85..                 sta     zp:_Zp+3
    \ 147d a917                 lda     #23
    \ 147f 85..                 sta     zp:_Zp+2
    \ 1481 a5..                 lda     zp:_Zp+28
    \ 1483 85..                 sta     zp:_Zp
    \ 1485 a927                 lda     #39
    \ 1487 18                   clc
    \ 1488 65..                 adc     zp:_Zp
    \ 148a 85..                 sta     zp:_Zp+1
    \ 148c 98                   tya
    \ 148d 85..                 sta     zp:_Zp
    \ 148f a5..                 lda     zp:_Zp+28
    \ 1491 20....               jsr     mcbox
    \ 1494 a901                 lda     #1
    \ 1496 20....               jsr     revers
    \ 1499 20....               jsr     `?L2043`
    \ 149c 20....               jsr     `?L1996`
    \ 149f a5..                 lda     zp:_Zp+30
    \ 14a1 85..                 sta     zp:_Zp+2
    \ 14a3 a5..                 lda     zp:_Zp+31
    \ 14a5 20....               jsr     `?L1924`
    \ 14a8 18                   clc
    \ 14a9 69..                 adc     #.byte0 disknames
    \ 14ab 85..                 sta     zp:_Zp
    \ 14ad a900                 lda     #0
    \ 14af 69..                 adc     #.byte1 disknames
    \ 14b1 85..                 sta     zp:_Zp+1
    \ 14b3 20....               jsr     `?L2023`
    \ 14b6 a5..                 lda     zp:_Zp+30
    \ 14b8 20....               jsr     `?L1908`
    \ 14bb 20....               jsr     `?L1942`
    \ 14be f01e                 beq     `?L339`
    \ 14c0 20....               jsr     wherex
    \ 14c3 1a                   inc     a
    \ 14c4 85..                 sta     zp:_Zp+1
    \ 14c6 20....               jsr     `?L2043`
    \ 14c9 85..                 sta     zp:_Zp
    \ 14cb a5..                 lda     zp:_Zp+1
    \ 14cd 20....               jsr     mcputsxy
    \ 14d0 a5..                 lda     zp:_Zp+30
    \ 14d2 20....               jsr     `?L1908`
    \ 14d5 e3..                 inw     zp:_Zp
    \ 14d7 e3..                 inw     zp:_Zp
    \ 14d9 e3..                 inw     zp:_Zp
    \ 14db 20....               jsr     `?L2023`
    \ 14de          `?L339`:
    \ 14de a9..                 lda     #.byte0 `_StringLiteral_ drv:`
    \ 14e0 85..                 sta     zp:_Zp+2
    \ 14e2 a9..                 lda     #.byte1 `_StringLiteral_ drv:`
    \ 14e4 85..                 sta     zp:_Zp+3
    \ 14e6 a917                 lda     #23
    \ 14e8 20....               jsr     `?L1996`
    \ 14eb a900                 lda     #0
    \ 14ed 85..                 sta     zp:_Zp+4
    \ 14ef a5..                 lda     zp:_Zp+30
    \ 14f1 20....               jsr     `?L1908`
    \ 14f4 a000                 ldy     #0
    \ 14f6 b1..                 lda     (_Zp),y
    \ 14f8 85..                 sta     zp:_Zp
    \ 14fa 98                   tya
    \ 14fb 85..                 sta     zp:_Zp+1
    \ 14fd 20....               jsr     `?L2071`
    \ 1500 a920                 lda     #32
    \ 1502 20....               jsr     cputc
    \ 1505 a5..                 lda     zp:_Zp+30
    \ 1507 20....               jsr     `?L1908`
    \ 150a e3..                 inw     zp:_Zp
    \ 150c 20....               jsr     `?L1927`
    \ 150f 1a                   inc     a
    \ 1510 d01a                 bne     `?L341`
    \ 1512 a9..                 lda     #.byte0 `_StringLiteral_ empty `
    \ 1514 85..                 sta     zp:_Zp+2
    \ 1516 a9..                 lda     #.byte1 `_StringLiteral_ empty `
    \ 1518 85..                 sta     zp:_Zp+3
    \ 151a a903                 lda     #3
    \ 151c 85..                 sta     zp:_Zp
    \ 151e a5..                 lda     zp:_Zp+28
    \ 1520 85..                 sta     zp:_Zp+1
    \ 1522 a911                 lda     #17
    \ 1524 18                   clc
    \ 1525 65..                 adc     zp:_Zp+1
    \ 1527 20....               jsr     mcputsxy
    \ 152a 803b                 bra     `?L342`
    \ 152c          `?L341`:
    \ 152c a5..                 lda     zp:_Zp+24
    \ 152e 38                   sec
    \ 152f e5..                 sbc     zp:_Zp+30
    \ 1531 05..                 ora     zp:_Zp+31
    \ 1533 f003                 beq     `?L685`
    \ 1535 98                   tya
    \ 1536 8002                 bra     `?L1872`
    \ 1538 a901     `?L685`:    lda     #1
    \ 153a          `?L1872`:
    \ 153a 85..                 sta     zp:_Zp+8
    \ 153c a5..                 lda     zp:_Zp+30
    \ 153e 20....               jsr     `?L1908`
    \ 1541 e3..                 inw     zp:_Zp
    \ 1543 e3..                 inw     zp:_Zp
    \ 1545 b1..                 lda     (_Zp),y
    \ 1547 85..                 sta     zp:_Zp+4
    \ 1549 a5..                 lda     zp:_Zp+30
    \ 154b 20....               jsr     `?L1908`
    \ 154e e3..                 inw     zp:_Zp
    \ 1550 b1..                 lda     (_Zp),y
    \ 1552 85..                 sta     zp:_Zp+3
    \ 1554 a901                 lda     #1
    \ 1556 85..                 sta     zp:_Zp+2
    \ 1558 a5..                 lda     zp:_Zp+28
    \ 155a 85..                 sta     zp:_Zp+1
    \ 155c e6..                 inc     zp:_Zp+1
    \ 155e a5..                 lda     zp:_Zp+30
    \ 1560 85..                 sta     zp:_Zp
    \ 1562 a5..                 lda     zp:_Zp+8
    \ 1564 20....               jsr     listbox
    \ 1567          `?L342`:
    \ 1567 a5..                 lda     zp:_Zp+30
    \ 1569 20....               jsr     `?L1908`
    \ 156c a901                 lda     #1
    \ 156e a044                 ldy     #68
    \ 1570 51..                 eor     (_Zp),y
    \ 1572 c8                   iny
    \ 1573 31..                 and     (_Zp),y
    \ 1575 1a                   inc     a
    \ 1576 d02d                 bne     `?L344`
    \ 1578 a901                 lda     #1
    \ 157a 20....               jsr     blink
    \ 157d a908                 lda     #8
    \ 157f 20....               jsr     textcolor
    \ 1582 a9..                 lda     #.byte0 `_StringLiteral_ disk access error `
    \ 1584 85..                 sta     zp:_Zp+2
    \ 1586 a9..                 lda     #.byte1 `_StringLiteral_ disk access error `
    \ 1588 20....               jsr     `?L1943`
    \ 158b a900                 lda     #0
    \ 158d 20....               jsr     blink
    \ 1590 20....               jsr     sidbong
    \ 1593 a5..                 lda     zp:_Zp+30
    \ 1595 20....               jsr     `?L1908`
    \ 1598 a044                 ldy     #68
    \ 159a a9ff                 lda     #255
    \ 159c 91..                 sta     (_Zp),y
    \ 159e c8                   iny
    \ 159f a9ff                 lda     #255
    \ 15a1 91..                 sta     (_Zp),y
    \ 15a3 8045                 bra     `?L345`
    \ 15a5          `?L344`:
    \ 15a5 a5..                 lda     zp:_Zp+30
    \ 15a7 20....               jsr     `?L1908`
    \ 15aa 88                   dey
    \ 15ab b1..                 lda     (_Zp),y
    \ 15ad c8                   iny
    \ 15ae 31..                 and     (_Zp),y
    \ 15b0 1a                   inc     a
    \ 15b1 f02e                 beq     `?L347`
    \ 15b3 a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 15b5 85..                 sta     zp:_Zp+2
    \ 15b7 a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 15b9 20....               jsr     `?L1943`
    \ 15bc a900                 lda     #0
    \ 15be 85..                 sta     zp:_Zp+4
    \ 15c0 a5..                 lda     zp:_Zp+30
    \ 15c2 20....               jsr     `?L1929`
    \ 15c5 a344                 ldz     #68
    \ 15c7 b2..                 lda     (_Zp+6),z
    \ 15c9 85..                 sta     zp:_Zp
    \ 15cb 1b                   inz
    \ 15cc b2..                 lda     (_Zp+6),z
    \ 15ce 20....               jsr     `?L1934`
    \ 15d1 20....               jsr     `?L2071`
    \ 15d4 a9..                 lda     #.byte0 `_StringLiteral_ blocks free `
    \ 15d6 85..                 sta     zp:_Zp
    \ 15d8 a9..                 lda     #.byte1 `_StringLiteral_ blocks free `
    \ 15da 85..                 sta     zp:_Zp+1
    \ 15dc 20....               jsr     msprintf
    \ 15df 8009                 bra     `?L345`
    \ 15e1          `?L347`:
    \ 15e1 a9..                 lda     #.byte0 `_StringLiteral_ F11 to mount real drive `
    \ 15e3 85..                 sta     zp:_Zp+2
    \ 15e5 a9..                 lda     #.byte1 `_StringLiteral_ F11 to mount real drive `
    \ 15e7 20....               jsr     `?L1943`
    \ 15ea          `?L345`:
    \ 15ea 20....               jsr     `?L1973`
    \ 15ed e3..                 inw     zp:_Zp+30
    \ 15ef 4c....               jmp     `?L329`
    \ 15f2          `?L300`:
1686                    }
1687                  }
1688                }
    \ 15f2 a203                 ldx     #3
    \ 15f4 a008                 ldy     #8
    \ 15f6 4c....               jmp     _DeallocStackRestore
    \ 15f9          `?L310`:
    \ 15f9 e3..                 inw     zp:_Zp+28
    \ 15fb 4c....               jmp     `?L309`
    \ 15fe          `?L301`:
    \ 15fe a5..                 lda     zp:_Zp+28
    \ 1600 85..                 sta     zp:_Zp
    \ 1602 a5..                 lda     zp:_Zp+28
    \ 1604 0a                   asl     a
    \ 1605 aa                   tax
    \ 1606 bd....               lda     midnight,x
    \ 1609 85..                 sta     zp:_Zp+2
    \ 160b bd....               lda     midnight+1,x
    \ 160e 85..                 sta     zp:_Zp+3
    \ 1610 a5..                 lda     zp:_Zp
    \ 1612 a000                 ldy     #0
    \ 1614 91..                 sta     (_Zp+2),y
    \ 1616 a9..                 lda     #.byte0 `_StringLiteral_already mounted`
    \ 1618 85..                 sta     zp:_Zp+2
    \ 161a a9..                 lda     #.byte1 `_StringLiteral_already mounted`
    \ 161c 85..                 sta     zp:_Zp+3
    \ 161e a5..                 lda     zp:_Zp+28
    \ 1620 20....               jsr     `?L1908`
    \ 1623 e3..                 inw     zp:_Zp
    \ 1625 e3..                 inw     zp:_Zp
    \ 1627 e3..                 inw     zp:_Zp
    \ 1629 20....               jsr     strcpy
    \ 162c a5..                 lda     zp:_Zp+28
    \ 162e 20....               jsr     `?L1908`
    \ 1631 a928                 lda     #40
    \ 1633 a047                 ldy     #71
    \ 1635 91..                 sta     (_Zp),y
    \ 1637 a5..                 lda     zp:_Zp+28
    \ 1639 20....               jsr     `?L1908`
    \ 163c a901                 lda     #1
    \ 163e c8                   iny
    \ 163f 91..                 sta     (_Zp),y
    \ 1641 a5..                 lda     zp:_Zp+28
    \ 1643 20....               jsr     `?L1908`
    \ 1646 a950                 lda     #80
    \ 1648 c8                   iny
    \ 1649 91..                 sta     (_Zp),y
    \ 164b a5..                 lda     zp:_Zp+28
    \ 164d 20....               jsr     `?L1908`
    \ 1650 e3..                 inw     zp:_Zp
    \ 1652 a900                 lda     #0
    \ 1654 a000                 ldy     #0
    \ 1656 91..                 sta     (_Zp),y
    \ 1658 a5..                 lda     zp:_Zp+28
    \ 165a 0a                   asl     a
    \ 165b aa                   tax
    \ 165c 18                   clc
    \ 165d a946                 lda     #70
    \ 165f 20....               jsr     `?L2038`
    \ 1662 20....               jsr     `?L1955`
    \ 1665 a901                 lda     #1
    \ 1667 45..                 eor     zp:_Zp+28
    \ 1669 05..                 ora     zp:_Zp+29
    \ 166b d027                 bne     `?L306`
    \ 166d ad....               lda     legacyHDOSstate
    \ 1670 d022                 bne     `?L306`
    \ 1672 a5..                 lda     zp:_Zp+28
    \ 1674 20....               jsr     `?L1908`
    \ 1677 20....               jsr     `?L1942`
    \ 167a f018                 beq     `?L306`
    \ 167c ad8bd6               lda     0xd68b
    \ 167f 8908                 bit     #8
    \ 1681 d011                 bne     `?L306`
    \ 1683 a5..                 lda     zp:_Zp+28
    \ 1685 0a                   asl     a
    \ 1686 aa                   tax
    \ 1687 18                   clc
    \ 1688 6b                   tza
    \ 1689 20....               jsr     `?L2038`
    \ 168c a9fe                 lda     #-2
    \ 168e a300                 ldz     #0
    \ 1690 32..                 and     (_Zp),z
    \ 1692 92..                 sta     (_Zp),z
    \ 1694          `?L306`:
    \ 1694 20....               jsr     `?L1909`
    \ 1697 20....               jsr     `?L1922`
    \ 169a a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 169c 85..                 sta     zp:_Zp+2
    \ 169e a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 16a0 85..                 sta     zp:_Zp+3
    \ 16a2 20....               jsr     `?L2032`
    \ 16a5 a902                 lda     #2
    \ 16a7 20....               jsr     `?L1915`
    \ 16aa a5..                 lda     zp:_Zp+28
    \ 16ac 85..                 sta     zp:_Zp+2
    \ 16ae a5..                 lda     zp:_Zp+29
    \ 16b0 20....               jsr     `?L1965`
    \ 16b3 85..                 sta     zp:_Zp+4
    \ 16b5 a9..                 lda     #.byte0 `_StringLiteral_reading disk drives`
    \ 16b7 85..                 sta     zp:_Zp+2
    \ 16b9 a9..                 lda     #.byte1 `_StringLiteral_reading disk drives`
    \ 16bb 85..                 sta     zp:_Zp+3
    \ 16bd a9..                 lda     #.byte0 `_StringLiteral_Initialising...`
    \ 16bf 85..                 sta     zp:_Zp
    \ 16c1 a9..                 lda     #.byte1 `_StringLiteral_Initialising...`
    \ 16c3 85..                 sta     zp:_Zp+1
    \ 16c5 a5..                 lda     zp:_Zp+4
    \ 16c7 18                   clc
    \ 16c8 6928                 adc     #40
    \ 16ca 20....               jsr     progress
    \ 16cd a5..                 lda     zp:_Zp+28
    \ 16cf 85..                 sta     zp:_Zp
    \ 16d1 a5..                 lda     zp:_Zp+28
    \ 16d3 20....               jsr     `?L1913`
    \ 16d6 a5..                 lda     zp:_Zp+28
    \ 16d8 20....               jsr     Deselect
    \ 16db e3..                 inw     zp:_Zp+28
    \ 16dd 4c....               jmp     `?L302`
    \ 0000                      .section code,text
    \ 0000 0a       `?L1908`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bd....               lda     midnight,x
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 bd....               lda     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+1
    \ 000c 60                   rts
    \ 0000                      .section code,text
    \ 0000 a9fc     `?L1909`:   lda     #-4
    \ 0002 20....               jsr     _DecVsp
    \ 0005 a003                 ldy     #3
    \ 0007 a900                 lda     #0
    \ 0009 91..                 sta     (_Vsp),y
    \ 000b 88                   dey
    \ 000c 91..                 sta     (_Vsp),y
    \ 000e 88                   dey
    \ 000f 91..                 sta     (_Vsp),y
    \ 0011 88                   dey
    \ 0012 91..                 sta     (_Vsp),y
    \ 0014 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1911`:
    \ 0000 a5..                 lda     zp:_Zp+2
    \ 0002 38                   sec
    \ 0003 e5..                 sbc     zp:_Zp
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 a5..                 lda     zp:_Zp+3
    \ 0009 e5..                 sbc     zp:_Zp+1
    \ 000b 85..                 sta     zp:_Zp+1
    \ 000d 18                   clc
    \ 000e a5..                 lda     zp:_Zp
    \ 0010 69..                 adc     #.byte0 direntflags
    \ 0012 85..                 sta     zp:_Zp+2
    \ 0014 a5..                 lda     zp:_Zp+1
    \ 0016 69..                 adc     #.byte1 direntflags
    \ 0018 85..                 sta     zp:_Zp+3
    \ 001a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1912`:
    \ 0000 85..                 sta     zp:_Zp+1
    \ 0002 cb....               asw     _Zp
    \ 0005 cb....               asw     _Zp
    \ 0008 cb....               asw     _Zp
    \ 000b a5..                 lda     zp:_Zp
    \ 000d 85..                 sta     zp:_Zp+2
    \ 000f a5..                 lda     zp:_Zp+1
    \ 0011 85..                 sta     zp:_Zp+3
    \ 0013 a905                 lda     #5
    \ 0015 aa                   tax
    \ 0016 60                   rts
    \ 0000                      .section code,text
    \ 0000 0a       `?L1913`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bd....               lda     midnight,x
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 bd....               lda     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+3
    \ 000c a000                 ldy     #0
    \ 000e b1..                 lda     (_Zp+2),y
    \ 0010 4c....               jmp     UpdateSectors
    \ 0000                      .section code,text
    \ 0000          `?L1914`:
    \ 0000 7d....               adc     midnight,x
    \ 0003 85..                 sta     zp:_Zp
    \ 0005 a900                 lda     #0
    \ 0007 7d....               adc     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+1
    \ 000c 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1915`:
    \ 0000 20....               jsr     messagebox
    \ 0003 a003                 ldy     #3
    \ 0005 4c....               jmp     _IncVsp
    \ 0000                      .section code,text
    \ 0000          `?L1917`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_      `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_      `
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000 0a       `?L1919`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bd....               lda     midnight,x
    \ 0005 85..                 sta     zp:_Zp+4
    \ 0007 bd....               lda     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+5
    \ 000c a000                 ldy     #0
    \ 000e          `?L1920`:
    \ 000e b1..                 lda     (_Zp+4),y
    \ 0010          `?L1921`:
    \ 0010 85..                 sta     zp:_Zp
    \ 0012 ad....               lda     legacyHDOSstate
    \ 0015 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1922`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 0002 85..                 sta     zp:_Zp+4
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 0006 85..                 sta     zp:_Zp+5
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000 0a       `?L1923`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bd....               lda     midnight,x
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 bd....               lda     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+3
    \ 000c e3..                 inw     zp:_Zp+2
    \ 000e 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1924`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a5..                 lda     zp:_Zp+2
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 cb....               asw     _Zp+2
    \ 0009 cb....               asw     _Zp+2
    \ 000c cb....               asw     _Zp+2
    \ 000f cb....               asw     _Zp+2
    \ 0012 a5..                 lda     zp:_Zp+2
    \ 0014 18                   clc
    \ 0015 65..                 adc     zp:_Zp
    \ 0017 60                   rts
    \ 0000                      .section code,text
    \ 0000 0a       `?L1925`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bc....               ldy     midnight,x
    \ 0005 84..                 sty     zp:_Zp
    \ 0007 bc....               ldy     midnight+1,x
    \ 000a 84..                 sty     zp:_Zp+1
    \ 000c 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1926`:
    \ 0000 a5..                 lda     zp:_Zp+30
    \ 0002 18                   clc
    \ 0003 65..                 adc     zp:_Zp+28
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 a5..                 lda     zp:_Zp+31
    \ 0009 65..                 adc     zp:_Zp+29
    \ 000b 85..                 sta     zp:_Zp+1
    \ 000d a5..                 lda     zp:_Zp+35
    \ 000f 38                   sec
    \ 0010 e5..                 sbc     zp:_Zp
    \ 0012 05..                 ora     zp:_Zp+1
    \ 0014 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1927`:
    \ 0000 e3..                 inw     zp:_Zp
    \ 0002 a000                 ldy     #0
    \ 0004 b1..                 lda     (_Zp),y
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1928`:
    \ 0000 a5..                 lda     zp:_Zp+30
    \ 0002 18                   clc
    \ 0003 6905                 adc     #5
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a5..                 lda     zp:_Zp+31
    \ 0009 6900                 adc     #0
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000 0a       `?L1929`:   asl     a
    \ 0001 aa                   tax
    \ 0002 bd....               lda     midnight,x
    \ 0005 85..                 sta     zp:_Zp+6
    \ 0007 bd....               lda     midnight+1,x
    \ 000a 85..                 sta     zp:_Zp+7
    \ 000c 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1930`:
    \ 0000 85..                 sta     zp:_Zp+5
    \ 0002 85..                 sta     zp:_Zp+4
    \ 0004 a903                 lda     #3
    \ 0006 85..                 sta     zp:_Zp+3
    \ 0008 a914                 lda     #20
    \ 000a 85..                 sta     zp:_Zp+2
    \ 000c a946                 lda     #70
    \ 000e 85..                 sta     zp:_Zp+1
    \ 0010 a904                 lda     #4
    \ 0012 85..                 sta     zp:_Zp
    \ 0014 a90a                 lda     #10
    \ 0016 20....               jsr     mcbox
    \ 0019 a901                 lda     #1
    \ 001b 20....               jsr     revers
    \ 001e a9..                 lda     #.byte0 `_StringLiteral_ Midnight Mega `
    \ 0020 85..                 sta     zp:_Zp+2
    \ 0022 a9..                 lda     #.byte1 `_StringLiteral_ Midnight Mega `
    \ 0024 85..                 sta     zp:_Zp+3
    \ 0026 a904                 lda     #4
    \ 0028 85..                 sta     zp:_Zp
    \ 002a a90e                 lda     #14
    \ 002c 4c....               jmp     mcputsxy
    \ 0000                      .section code,text
    \ 0000          `?L1933`:
    \ 0000 a5..                 lda     zp:_Zp+24
    \ 0002 0a                   asl     a
    \ 0003 aa                   tax
    \ 0004 18                   clc
    \ 0005 a94a                 lda     #74
    \ 0007 7d....               adc     midnight,x
    \ 000a 85..                 sta     zp:_Zp+2
    \ 000c 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1934`:
    \ 0000 85..                 sta     zp:_Zp+1
    \ 0002 a900                 lda     #0
    \ 0004 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1935`:
    \ 0000 a5..                 lda     zp:_Zp+24
    \ 0002 20....               jsr     getdirententry
    \ 0005 a5..                 lda     zp:_Zp
    \ 0007 85..                 sta     zp:_Zp+30
    \ 0009 a5..                 lda     zp:_Zp+1
    \ 000b 85..                 sta     zp:_Zp+31
    \ 000d 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1937`:
    \ 0000 a9..                 lda     #.byte0 _StringLiteral_BAM
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a9..                 lda     #.byte1 _StringLiteral_BAM
    \ 0006          `?L1938`:
    \ 0006 85..                 sta     zp:_Zp+3
    \ 0008 a9..                 lda     #.byte0 `_StringLiteral_Reading...`
    \ 000a 85..                 sta     zp:_Zp
    \ 000c a9..                 lda     #.byte1 `_StringLiteral_Reading...`
    \ 000e 85..                 sta     zp:_Zp+1
    \ 0010 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1939`:
    \ 0000 85..                 sta     zp:_Zp+2
    \ 0002 a5..                 lda     zp:_Zp+24
    \ 0004 85..                 sta     zp:_Zp+1
    \ 0006 a5..                 lda     zp:_Zp+24
    \ 0008 0a       `?L1940`:   asl     a
    \ 0009 aa                   tax
    \ 000a bd....               lda     midnight,x
    \ 000d 85..                 sta     zp:_Zp+8
    \ 000f bd....               lda     midnight+1,x
    \ 0012 85..                 sta     zp:_Zp+9
    \ 0014 a000                 ldy     #0
    \ 0016 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1941`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a5..                 lda     zp:_Zp+24
    \ 0004 0a                   asl     a
    \ 0005 aa                   tax
    \ 0006 18                   clc
    \ 0007 60                   rts
    \ 0000                      .section code,text
    \ 0000 a901     `?L1942`:   lda     #1
    \ 0002 a346                 ldz     #70
    \ 0004 32..                 and     (_Zp),z
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1943`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a917                 lda     #23
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 a5..                 lda     zp:_Zp+28
    \ 0008 85..                 sta     zp:_Zp+1
    \ 000a a90c                 lda     #12
    \ 000c 18                   clc
    \ 000d 65..                 adc     zp:_Zp+1
    \ 000f 4c....               jmp     mcputsxy
    \ 0000                      .section code,text
    \ 0000          `?L1944`:
    \ 0000 a5..                 lda     zp:_Zp+26
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a5..                 lda     zp:_Zp+27
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1945`:
    \ 0000 b1..                 lda     (_Vsp),y
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a900                 lda     #0
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 c8                   iny
    \ 0009 b1..                 lda     (_Vsp),y
    \ 000b 85..                 sta     zp:_Zp+2
    \ 000d 38                   sec
    \ 000e a5..                 lda     zp:_Zp
    \ 0010 e5..                 sbc     zp:_Zp+2
    \ 0012 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1946`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a9..                 lda     #.byte0 `_StringLiteral_Writing...`
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 a9..                 lda     #.byte1 `_StringLiteral_Writing...`
    \ 0008 85..                 sta     zp:_Zp+1
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000 a047     `?L1947`:   ldy     #71
    \ 0002          `?L1948`:
    \ 0002 b1..                 lda     (_Zp),y
    \ 0004          `?L1949`:
    \ 0004 85..                 sta     zp:_Zp+2
    \ 0006          `?L1950`:
    \ 0006 a5..                 lda     zp:_Zp+24
    \ 0008 85..                 sta     zp:_Zp+1
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000 aa       `?L1951`:   tax
    \ 0001 a920                 lda     #32
    \ 0003 9d....               sta     s,x
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1952`:
    \ 0000 a6..                 ldx     zp:_Zp+24
    \ 0002          `?L1953`:
    \ 0002 86..                 stx     zp:_Zp
    \ 0004 a900                 lda     #0
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1954`:
    \ 0000 a5..                 lda     zp:_Zp+24
    \ 0002 4c....               jmp     Deselect
    \ 0000                      .section code,text
    \ 0000 a901     `?L1955`:   lda     #1
    \ 0002 a300                 ldz     #0
    \ 0004 12..                 ora     (_Zp),z
    \ 0006 92..                 sta     (_Zp),z
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1956`:
    \ 0000 20....               jsr     mcputsxy
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_ The MEGA65 file commander `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_ The MEGA65 file commander `
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b a904                 lda     #4
    \ 000d 85..                 sta     zp:_Zp
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1958`:
    \ 0000 a5..                 lda     zp:_Zp+26
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 ab....               ldz     _Zp
    \ 0007 a901                 lda     #1
    \ 0009 32..                 and     (_Zp+2),z
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000 a000     `?L1959`:   ldy     #0
    \ 0002 b1..                 lda     (_Zp),y
    \ 0004 85..                 sta     zp:_Zp+6
    \ 0006 a980                 lda     #128
    \ 0008 85..                 sta     zp:_Zp+4
    \ 000a a90c                 lda     #12
    \ 000c 85..                 sta     zp:_Zp+5
    \ 000e a900                 lda     #0
    \ 0010 a26a                 ldx     #106
    \ 0012 a308                 ldz     #8
    \ 0014 424285..             stq     zp:_Zp
    \ 0018 ad....               lda     legacyHDOSstate
    \ 001b 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1960`:
    \ 0000 85..                 sta     zp:_Zp+1
    \ 0002 a5..                 lda     zp:_Zp+24
    \ 0004 20....               jsr     getdirententry
    \ 0007 a5..                 lda     zp:_Zp
    \ 0009 85..                 sta     zp:_Zp+26
    \ 000b a5..                 lda     zp:_Zp+1
    \ 000d 85..                 sta     zp:_Zp+27
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1962`:
    \ 0000 a5..                 lda     zp:_Zp+30
    \ 0002 18                   clc
    \ 0003 6905                 adc     #5
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 a5..                 lda     zp:_Zp+31
    \ 0009 6900                 adc     #0
    \ 000b 85..                 sta     zp:_Zp+1
    \ 000d 20....               jsr     hyppo_setname
    \ 0010 20....               jsr     hyppo_findfirst
    \ 0013 85..                 sta     zp:_Zp+26
    \ 0015 ab....               ldz     _Zp+26
    \ 0018 c284                 cpz     #-124
    \ 001a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1965`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 cb....               asw     _Zp+2
    \ 0005 cb....               asw     _Zp+2
    \ 0008 cb....               asw     _Zp+2
    \ 000b a5..                 lda     zp:_Zp+2
    \ 000d 85..                 sta     zp:_Zp
    \ 000f cb....               asw     _Zp+2
    \ 0012 cb....               asw     _Zp+2
    \ 0015 a5..                 lda     zp:_Zp+2
    \ 0017 18                   clc
    \ 0018 65..                 adc     zp:_Zp
    \ 001a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1966`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 ad....               lda     option
    \ 0005 4c....               jmp     optionstring
    \ 0000                      .section code,text
    \ 0000          `?L1967`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 a900                 lda     #0
    \ 0004 85..                 sta     zp:_Zp+1
    \ 0006 85..                 sta     zp:_Zp+2
    \ 0008 85..                 sta     zp:_Zp+3
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1968`:
    \ 0000 424285..             stq     zp:_Zp+24
    \ 0004 a001                 ldy     #1
    \ 0006 b1..                 lda     (_Vsp),y
    \ 0008 85..                 sta     zp:_Zp+28
    \ 000a a900                 lda     #0
    \ 000c 85..                 sta     zp:_Zp+29
    \ 000e 20....               jsr     wherex
    \ 0011 85..                 sta     zp:_Zp
    \ 0013 38                   sec
    \ 0014 a5..                 lda     zp:_Zp+28
    \ 0016 e5..                 sbc     zp:_Zp
    \ 0018 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1970`:
    \ 0000 a5..                 lda     zp:_Zp+24
    \ 0002 18                   clc
    \ 0003 6905                 adc     #5
    \ 0005 85..                 sta     zp:_Zp+4
    \ 0007 a5..                 lda     zp:_Zp+25
    \ 0009 6900                 adc     #0
    \ 000b 85..                 sta     zp:_Zp+5
    \ 000d 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1971`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_   OK   `
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_   OK   `
    \ 0006 85..                 sta     zp:_Zp+3
    \ 0008 a912                 lda     #18
    \ 000a 85..                 sta     zp:_Zp
    \ 000c a924                 lda     #36
    \ 000e          `?L1972`:
    \ 000e 20....               jsr     mcputsxy
    \ 0011 a900     `?L1973`:   lda     #0
    \ 0013 4c....               jmp     revers
    \ 0000                      .section code,text
    \ 0000          `?L1974`:
    \ 0000 6d....               adc     taskblock
    \ 0003 85..                 sta     zp:_Zp
    \ 0005 a900                 lda     #0
    \ 0007 6d....               adc     taskblock+1
    \ 000a 85..                 sta     zp:_Zp+1
    \ 000c ad....               lda     taskblock
    \ 000f 85..                 sta     zp:_Zp+4
    \ 0011 ad....               lda     taskblock+1
    \ 0014 85..                 sta     zp:_Zp+5
    \ 0016 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1975`:
    \ 0000 a5..                 lda     zp:_Zp+26
    \ 0002 18                   clc
    \ 0003 6905                 adc     #5
    \ 0005 85..                 sta     zp:_Zp+4
    \ 0007 a5..                 lda     zp:_Zp+27
    \ 0009 6900                 adc     #0
    \ 000b 85..                 sta     zp:_Zp+5
    \ 000d a9..                 lda     #.byte0 `_StringLiteral_open failed for`
    \ 000f 85..                 sta     zp:_Zp+2
    \ 0011 a9..                 lda     #.byte1 `_StringLiteral_open failed for`
    \ 0013 85..                 sta     zp:_Zp+3
    \ 0015 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1976`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 18                   clc
    \ 0003 a5..                 lda     zp:_Zp+2
    \ 0005 65..                 adc     zp:_Zp
    \ 0007 85..                 sta     zp:_Zp+2
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1977`:
    \ 0000 a9..                 lda     #.byte0 lfnname
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a9..                 lda     #.byte1 lfnname
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 4c....               jmp     hyppo_setname
    \ 0000                      .section code,text
    \ 0000          `?L1978`:
    \ 0000 20....               jsr     getdirententry
    \ 0003 a5..                 lda     zp:_Zp+24
    \ 0005 a01e                 ldy     #30
    \ 0007 18                   clc
    \ 0008 71..                 adc     (_Zp),y
    \ 000a 85..                 sta     zp:_Zp+24
    \ 000c a5..                 lda     zp:_Zp+25
    \ 000e c8                   iny
    \ 000f 71..                 adc     (_Zp),y
    \ 0011 85..                 sta     zp:_Zp+25
    \ 0013 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1980`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 _StringLiteral_Delete
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 _StringLiteral_Delete
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1982`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 _StringLiteral_Rename
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 _StringLiteral_Rename
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1984`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_Edit  `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_Edit  `
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1986`:
    \ 0000 a5..                 lda     zp:_Zp+26
    \ 0002 c9f8                 cmp     #248
    \ 0004 a5..                 lda     zp:_Zp+27
    \ 0006 e900                 sbc     #0
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000 a902     `?L1987`:   lda     #2
    \ 0002 a346                 ldz     #70
    \ 0004 32..                 and     (_Zp),z
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000 a047     `?L1988`:   ldy     #71
    \ 0002          `?L1989`:
    \ 0002 91..                 sta     (_Zp),y
    \ 0004 a5..                 lda     zp:_Zp+24
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1990`:
    \ 0000 cb....               asw     _Zp+2
    \ 0003 ca                   dex
    \ 0004 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1991`:
    \ 0000 a5..                 lda     zp:_Zp+28
    \ 0002 85..                 sta     zp:_Zp+4
    \ 0004 a5..                 lda     zp:_Zp+29
    \ 0006 85..                 sta     zp:_Zp+5
    \ 0008 4242a5..             ldq     zp:_Zp+24
    \ 000c 424285..             stq     zp:_Zp
    \ 0010 60                   rts
    \ 0000                      .section code,text
    \ 0000 a900     `?L1992`:   lda     #0
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a914                 lda     #20
    \ 0006 4c....               jmp     shortcuts
    \ 0000                      .section code,text
    \ 0000 a900     `?L1993`:   lda     #0
    \ 0002 85..                 sta     zp:_Zp+1
    \ 0004 4c....               jmp     _ValueSwitch16
    \ 0000                      .section code,text
    \ 0000 a001     `?L1994`:   ldy     #1
    \ 0002 b1..                 lda     (_Vsp),y
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 88                   dey
    \ 0007 b1..                 lda     (_Vsp),y
    \ 0009 20....               jsr     _Mul8
    \ 000c a5..                 lda     zp:_Zp+1
    \ 000e 097f                 ora     #127
    \ 0010 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1996`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 a5..                 lda     zp:_Zp+28
    \ 0004 85..                 sta     zp:_Zp+1
    \ 0006 e6..                 inc     zp:_Zp+1
    \ 0008 e6..                 inc     zp:_Zp+1
    \ 000a a5..                 lda     zp:_Zp+1
    \ 000c 4c....               jmp     mcputsxy
    \ 0000                      .section code,text
    \ 0000          `?L1997`:
    \ 0000 85..                 sta     zp:_Zp+1
    \ 0002 a90a                 lda     #10
    \ 0004 85..                 sta     zp:_Zp+10
    \ 0006 a900                 lda     #0
    \ 0008 85..                 sta     zp:_Zp+11
    \ 000a 20....               jsr     _DivMod16
    \ 000d a930                 lda     #48
    \ 000f 18                   clc
    \ 0010 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L1999`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a9..                 lda     #.byte0 `_StringLiteral_ 9`
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 a9..                 lda     #.byte1 `_StringLiteral_ 9`
    \ 0008 85..                 sta     zp:_Zp+1
    \ 000a a901                 lda     #1
    \ 000c 4c....               jmp     shortcutprint
    \ 0000                      .section code,text
    \ 0000          `?L2000`:
    \ 0000 424285..             stq     zp:_Zp
    \ 0004 a9fe                 lda     #-2
    \ 0006 20....               jsr     _DecVsp
    \ 0009 a001                 ldy     #1
    \ 000b a900                 lda     #0
    \ 000d 91..                 sta     (_Vsp),y
    \ 000f 88                   dey
    \ 0010 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2002`:
    \ 0000 e3..                 inw     zp:_Zp
    \ 0002 b1..                 lda     (_Zp),y
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 98                   tya
    \ 0007 85..                 sta     zp:_Zp+1
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2003`:
    \ 0000 e3..                 inw     zp:_Zp
    \ 0002 a901                 lda     #1
    \ 0004 a300                 ldz     #0
    \ 0006 18                   clc
    \ 0007 72..                 adc     (_Zp),z
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2004`:
    \ 0000 a2..                 ldx     #_Zp+6
    \ 0002 a901                 lda     #1
    \ 0004 20....               jsr     _LoadVspEA
    \ 0007 a2..                 ldx     #_Zp+4
    \ 0009 a902                 lda     #2
    \ 000b 4c....               jmp     _LoadVspEA
    \ 0000                      .section code,text
    \ 0000          `?L2006`:
    \ 0000 85..                 sta     zp:_Zp+1
    \ 0002 a928                 lda     #40
    \ 0004 85..                 sta     zp:_Zp+10
    \ 0006 a900                 lda     #0
    \ 0008 85..                 sta     zp:_Zp+11
    \ 000a 20....               jsr     _UDivMod16
    \ 000d a5..                 lda     zp:_Zp
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000 18       `?L2008`:   clc
    \ 0001 424265..             adcq    zp:_Zp
    \ 0005 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2009`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a9..                 lda     #.byte0 `_StringLiteral_ 1`
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2010`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_Mount `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_Mount `
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b          `?L2012`:
    \ 000b a9..                 lda     #.byte0 `_StringLiteral_ 2`
    \ 000d 85..                 sta     zp:_Zp
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2013`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_View  `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_View  `
    \ 0009          `?L2015`:
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b          `?L2016`:
    \ 000b a9..                 lda     #.byte0 `_StringLiteral_ 3`
    \ 000d 85..                 sta     zp:_Zp
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2017`:
    \ 0000 20....               jsr     shortcutprint
    \ 0003 a9..                 lda     #.byte0 `_StringLiteral_Mkdir `
    \ 0005 85..                 sta     zp:_Zp+2
    \ 0007 a9..                 lda     #.byte1 `_StringLiteral_Mkdir `
    \ 0009          `?L2019`:
    \ 0009 85..                 sta     zp:_Zp+3
    \ 000b          `?L2020`:
    \ 000b a9..                 lda     #.byte0 `_StringLiteral_ 7`
    \ 000d 85..                 sta     zp:_Zp
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000 a264     `?L2021`:   ldx     #100
    \ 0002 86..                 stx     zp:_Zp
    \ 0004 20....               jsr     _Mul8
    \ 0007          `?L2022`:
    \ 0007 a5..                 lda     zp:_Zp
    \ 0009 85..                 sta     zp:_Zp+24
    \ 000b a5..                 lda     zp:_Zp+1
    \ 000d 85..                 sta     zp:_Zp+25
    \ 000f 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2023`:
    \ 0000 20....               jsr     msprintf
    \ 0003 a920                 lda     #32
    \ 0005 4c....               jmp     cputc
    \ 0000                      .section code,text
    \ 0000          `?L2025`:
    \ 0000 a5..                 lda     zp:_Zp+28
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a5..                 lda     zp:_Zp+30
    \ 0006 18                   clc
    \ 0007 65..                 adc     zp:_Zp
    \ 0009 4b                   taz
    \ 000a a901                 lda     #1
    \ 000c 32..                 and     (_Zp+2),z
    \ 000e 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2026`:
    \ 0000 a5..                 lda     zp:_Zp+4
    \ 0002 0a                   asl     a
    \ 0003 aa                   tax
    \ 0004 bd....               lda     midnight,x
    \ 0007 85..                 sta     zp:_Zp+4
    \ 0009 bd....               lda     midnight+1,x
    \ 000c 85..                 sta     zp:_Zp+5
    \ 000e 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2027`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a5..                 lda     zp:_Zp+28
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 a5..                 lda     zp:_Zp+29
    \ 0008 85..                 sta     zp:_Zp+1
    \ 000a 4c....               jmp     _ValueSwitch16
    \ 0000                      .section code,text
    \ 0000          `?L2028`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_storage card`
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_storage card`
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 a910                 lda     #16
    \ 000a 4c....               jmp     strcopy
    \ 0000                      .section code,text
    \ 0000          `?L2029`:
    \ 0000 20....               jsr     _LoadVspEA
    \ 0003 88                   dey
    \ 0004 a5..                 lda     zp:_Zp+5
    \ 0006 91..                 sta     (_Vsp),y
    \ 0008 88                   dey
    \ 0009 a5..                 lda     zp:_Zp+4
    \ 000b 91..                 sta     (_Vsp),y
    \ 000d 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2031`:
    \ 0000 a5..                 lda     zp:_Zp+26
    \ 0002 18                   clc
    \ 0003 6905                 adc     #5
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 a5..                 lda     zp:_Zp+27
    \ 0009 6900                 adc     #0
    \ 000b 85..                 sta     zp:_Zp+1
    \ 000d 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2032`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000 a90f     `?L2033`:   lda     #15
    \ 0002 a302                 ldz     #2
    \ 0004 32..                 and     (_Zp+30),z
    \ 0006 c905                 cmp     #5
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2034`:
    \ 0000 a6..                 ldx     zp:_Zp+24
    \ 0002          `?L2035`:
    \ 0002 86..                 stx     zp:_Zp
    \ 0004 a5..                 lda     zp:_Zp
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2036`:
    \ 0000 b1..                 lda     (_Zp),y
    \ 0002          `?L2037`:
    \ 0002 85..                 sta     zp:_Zp+1
    \ 0004 a5..                 lda     zp:_Zp+24
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2038`:
    \ 0000 7d....               adc     midnight,x
    \ 0003 85..                 sta     zp:_Zp
    \ 0005 98                   tya
    \ 0006 7d....               adc     midnight+1,x
    \ 0009 85..                 sta     zp:_Zp+1
    \ 000b 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2039`:
    \ 0000 20....               jsr     helpbegin
    \ 0003 a901                 lda     #1
    \ 0005 85..                 sta     zp:_Zp
    \ 0007 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2041`:
    \ 0000 69..                 adc     #.byte0 disknames
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a900                 lda     #0
    \ 0006 69..                 adc     #.byte1 disknames
    \ 0008 85..                 sta     zp:_Zp+3
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2042`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a5..                 lda     zp:_Zp
    \ 0004 c5..                 cmp     zp:_Zp+2
    \ 0006 a5..                 lda     zp:_Zp+1
    \ 0008 e5..                 sbc     zp:_Zp+3
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2043`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_ `
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_ `
    \ 0006          `?L2044`:
    \ 0006 85..                 sta     zp:_Zp+3
    \ 0008 a900                 lda     #0
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2045`:
    \ 0000 85..                 sta     zp:_Zp+4
    \ 0002 a9..                 lda     #.byte0 `_StringLiteral_goes nowhere and does nothing`
    \ 0004 85..                 sta     zp:_Zp+2
    \ 0006 a9..                 lda     #.byte1 `_StringLiteral_goes nowhere and does nothing`
    \ 0008 85..                 sta     zp:_Zp+3
    \ 000a 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2046`:
    \ 0000 e3..                 inw     zp:_Zp
    \ 0002 b1..                 lda     (_Zp),y
    \ 0004 4b                   taz
    \ 0005 a901                 lda     #1
    \ 0007 32..                 and     (_Zp+2),z
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2047`:
    \ 0000 e3..                 inw     zp:_Zp
    \ 0002 b1..                 lda     (_Zp),y
    \ 0004 85..                 sta     zp:_Zp+2
    \ 0006 98                   tya
    \ 0007 85..                 sta     zp:_Zp+3
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2048`:
    \ 0000 20....               jsr     hyppo_chdir
    \ 0003 85..                 sta     zp:_Zp
    \ 0005 a30f                 ldz     #15
    \ 0007 d4..                 cpz     zp:_Zp
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2050`:
    \ 0000 20....               jsr     lcopy
    \ 0003 a001                 ldy     #1
    \ 0005 4c....               jmp     _IncVsp
    \ 0000                      .section code,text
    \ 0000          `?L2052`:
    \ 0000 20....               jsr     progress
    \ 0003 a5..                 lda     zp:_Zp+24
    \ 0005 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2054`:
    \ 0000 20....               jsr     readblockchain
    \ 0003 a000                 ldy     #0
    \ 0005 4c....               jmp     _IncVsp
    \ 0000                      .section code,text
    \ 0000 98       `?L2056`:   tya
    \ 0001 7d....               adc     midnight+1,x
    \ 0004 85..                 sta     zp:_Zp+3
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2057`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_from left side`
    \ 0002 85..                 sta     zp:_Zp+4
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_from left side`
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2058`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_from right side`
    \ 0002 85..                 sta     zp:_Zp+4
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_from right side`
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000 a900     `?L2059`:   lda     #0
    \ 0002 85..                 sta     zp:_Zp+26
    \ 0004 85..                 sta     zp:_Zp+27
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000 a900     `?L2060`:   lda     #0
    \ 0002 85..                 sta     zp:_Zp+28
    \ 0004 85..                 sta     zp:_Zp+29
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2061`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 18                   clc
    \ 0003 a5..                 lda     zp:_Zp+24
    \ 0005 65..                 adc     zp:_Zp
    \ 0007 85..                 sta     zp:_Zp+24
    \ 0009 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2062`:
    \ 0000 85..                 sta     zp:_Zp+2
    \ 0002 a9..                 lda     #.byte1 `_StringLiteral_is not supported.`
    \ 0004 85..                 sta     zp:_Zp+3
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2063`:
    \ 0000 b1..                 lda     (_Zp),y
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a5..                 lda     zp:_Zp+25
    \ 0006 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2064`:
    \ 0000 69..                 adc     #.byte1 direntflags
    \ 0002 85..                 sta     zp:_Zp+5
    \ 0004 a5..                 lda     zp:_Zp
    \ 0006 85..                 sta     zp:_Zp+2
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2065`:
    \ 0000 a5..                 lda     zp:_Zp
    \ 0002 c902                 cmp     #2
    \ 0004 a5..                 lda     zp:_Zp+1
    \ 0006 e900                 sbc     #0
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000 a901     `?L2066`:   lda     #1
    \ 0002 a300                 ldz     #0
    \ 0004 52..                 eor     (_Zp+2),z
    \ 0006 92..                 sta     (_Zp+2),z
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000 a910     `?L2067`:   lda     #16
    \ 0002 4c....               jmp     strmakefilename
    \ 0000                      .section code,text
    \ 0000 a914     `?L2068`:   lda     #20
    \ 0002 4c....               jmp     progress
    \ 0000                      .section code,text
    \ 0000 a200     `?L2069`:   ldx     #0
    \ 0002 a002                 ldy     #2
    \ 0004 4c....               jmp     _AllocStackSave
    \ 0000                      .section code,text
    \ 0000          `?L2070`:
    \ 0000 85..                 sta     zp:_Zp
    \ 0002 a9..                 lda     #.byte1 `_StringLiteral_real drive`
    \ 0004 85..                 sta     zp:_Zp+1
    \ 0006 a910                 lda     #16
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2071`:
    \ 0000 85..                 sta     zp:_Zp+2
    \ 0002 85..                 sta     zp:_Zp+3
    \ 0004 4c....               jmp     csputdec
    \ 0000                      .section code,text
    \ 0000          `?L2072`:
    \ 0000 85..                 sta     zp:_Zp+3
    \ 0002 a9..                 lda     #.byte0 `_StringLiteral_Directory delete,`
    \ 0004 85..                 sta     zp:_Zp
    \ 0006 a9..                 lda     #.byte1 `_StringLiteral_Directory delete,`
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2073`:
    \ 0000 a9..                 lda     #.byte0 `_StringLiteral_v0.6.6-beta`
    \ 0002 85..                 sta     zp:_Zp
    \ 0004 a9..                 lda     #.byte1 `_StringLiteral_v0.6.6-beta`
    \ 0006 85..                 sta     zp:_Zp+1
    \ 0008 60                   rts
    \ 0000                      .section code,text
    \ 0000          `?L2074`:
    \ 0000 a9..                 lda     #.byte0 s
    \ 0002 85..                 sta     zp:_Zp+2
    \ 0004 a9..                 lda     #.byte1 s
    \ 0006 85..                 sta     zp:_Zp+3
    \ 0008 60                   rts
    \ 0000                      .section switch,rodata
    \ 0000 0700     `?L672`:    .word   7
    \ 0002 ....                 .word   `?L110`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L111`-1
    \ 0008 0d00                 .word   13
    \ 000a ....                 .word   `?L113`-1
    \ 000c 1100                 .word   17
    \ 000e ....                 .word   `?L115`-1
    \ 0010 1b00                 .word   27
    \ 0012 ....                 .word   `?L111`-1
    \ 0014 1d00                 .word   29
    \ 0016 ....                 .word   `?L115`-1
    \ 0018 2000                 .word   32
    \ 001a ....                 .word   `?L114`-1
    \ 001c 9100                 .word   145
    \ 001e ....                 .word   `?L117`-1
    \ 0020 9d00                 .word   157
    \ 0022 ....                 .word   `?L117`-1
    \ 0000                      .section switch,rodata
    \ 0000 0600     `?L673`:    .word   6
    \ 0002 ....                 .word   `?L150`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L151`-1
    \ 0008 0d00                 .word   13
    \ 000a ....                 .word   `?L153`-1
    \ 000c 1100                 .word   17
    \ 000e ....                 .word   `?L154`-1
    \ 0010 1b00                 .word   27
    \ 0012 ....                 .word   `?L151`-1
    \ 0014 1d00                 .word   29
    \ 0016 ....                 .word   `?L154`-1
    \ 0018 9100                 .word   145
    \ 001a ....                 .word   `?L156`-1
    \ 001c 9d00                 .word   157
    \ 001e ....                 .word   `?L156`-1
    \ 0000                      .section switch,rodata
    \ 0000 0500     `?L677`:    .word   5
    \ 0002 ....                 .word   `?L200`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L201`-1
    \ 0008 0d00                 .word   13
    \ 000a ....                 .word   `?L203`-1
    \ 000c 1100                 .word   17
    \ 000e ....                 .word   `?L205`-1
    \ 0010 1b00                 .word   27
    \ 0012 ....                 .word   `?L201`-1
    \ 0014 2000                 .word   32
    \ 0016 ....                 .word   `?L203`-1
    \ 0018 9100                 .word   145
    \ 001a ....                 .word   `?L206`-1
    \ 0000                      .section switch,rodata
    \ 0000 0300     `?L679`:    .word   3
    \ 0002 ....                 .word   `?L236`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L237`-1
    \ 0008 0d00                 .word   13
    \ 000a ....                 .word   `?L239`-1
    \ 000c 1b00                 .word   27
    \ 000e ....                 .word   `?L237`-1
    \ 0010 2000                 .word   32
    \ 0012 ....                 .word   `?L239`-1
    \ 0000                      .section switch,rodata
    \ 0000 0e00     `?L688`:    .word   14
    \ 0002 ....                 .word   `?L355`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L356`-1
    \ 0008 0d00                 .word   13
    \ 000a ....                 .word   `?L358`-1
    \ 000c 1100                 .word   17
    \ 000e ....                 .word   `?L351`-1
    \ 0010 1b00                 .word   27
    \ 0012 ....                 .word   `?L356`-1
    \ 0014 1f00                 .word   31
    \ 0016 ....                 .word   `?L351`-1
    \ 0018 2000                 .word   32
    \ 001a ....                 .word   `?L351`-1
    \ 001c 9100                 .word   145
    \ 001e ....                 .word   `?L351`-1
    \ 0020 f100                 .word   241
    \ 0022 ....                 .word   `?L351`-1
    \ 0024 9101                 .word   0x191
    \ 0026 ....                 .word   `?L351`-1
    \ 0028 9401                 .word   0x194
    \ 002a ....                 .word   `?L351`-1
    \ 002c f101                 .word   0x1f1
    \ 002e ....                 .word   `?L351`-1
    \ 0030 9102                 .word   0x291
    \ 0032 ....                 .word   `?L351`-1
    \ 0034 9402                 .word   0x294
    \ 0036 ....                 .word   `?L351`-1
    \ 0038 f102                 .word   0x2f1
    \ 003a ....                 .word   `?L351`-1
    \ 003c 1204                 .word   0x412
    \ 003e ....                 .word   `?L351`-1
    \ 0000                      .section switch,rodata
    \ 0000 3400     `?L687`:    .word   52
    \ 0002 ....                 .word   `?L376`-1
    \ 0004 0300                 .word   3
    \ 0006 ....                 .word   `?L396`-1
    \ 0008 0900                 .word   9
    \ 000a ....                 .word   `?L419`-1
    \ 000c 0d00                 .word   13
    \ 000e ....                 .word   `?L392`-1
    \ 0010 1100                 .word   17
    \ 0012 ....                 .word   `?L426`-1
    \ 0014 1b00                 .word   27
    \ 0016 ....                 .word   `?L396`-1
    \ 0018 1d00                 .word   29
    \ 001a ....                 .word   `?L422`-1
    \ 001c 1f00                 .word   31
    \ 001e ....                 .word   `?L388`-1
    \ 0020 2000                 .word   32
    \ 0022 ....                 .word   `?L393`-1
    \ 0024 5f00                 .word   95
    \ 0026 ....                 .word   `?L396`-1
    \ 0028 9100                 .word   145
    \ 002a ....                 .word   `?L427`-1
    \ 002c 9d00                 .word   157
    \ 002e ....                 .word   `?L423`-1
    \ 0030 f100                 .word   241
    \ 0032 ....                 .word   `?L388`-1
    \ 0034 f200                 .word   242
    \ 0036 ....                 .word   `?L416`-1
    \ 0038 f300                 .word   243
    \ 003a ....                 .word   `?L381`-1
    \ 003c f400                 .word   244
    \ 003e ....                 .word   `?L381`-1
    \ 0040 f500                 .word   245
    \ 0042 ....                 .word   `?L408`-1
    \ 0044 f600                 .word   246
    \ 0046 ....                 .word   `?L408`-1
    \ 0048 f700                 .word   247
    \ 004a ....                 .word   `?L404`-1
    \ 004c f800                 .word   248
    \ 004e ....                 .word   `?L408`-1
    \ 0050 f900                 .word   249
    \ 0052 ....                 .word   `?L401`-1
    \ 0054 fa00                 .word   250
    \ 0056 ....                 .word   `?L378`-1
    \ 0058 fb00                 .word   251
    \ 005a ....                 .word   `?L400`-1
    \ 005c ff00                 .word   255
    \ 005e ....                 .word   `?L325`-1
    \ 0060 0901                 .word   0x109
    \ 0062 ....                 .word   `?L419`-1
    \ 0064 9101                 .word   0x191
    \ 0066 ....                 .word   `?L427`-1
    \ 0068 9401                 .word   0x194
    \ 006a ....                 .word   `?L393`-1
    \ 006c 9d01                 .word   0x19d
    \ 006e ....                 .word   `?L423`-1
    \ 0070 f101                 .word   0x1f1
    \ 0072 ....                 .word   `?L388`-1
    \ 0074 f201                 .word   0x1f2
    \ 0076 ....                 .word   `?L416`-1
    \ 0078 f301                 .word   0x1f3
    \ 007a ....                 .word   `?L381`-1
    \ 007c f401                 .word   500
    \ 007e ....                 .word   `?L381`-1
    \ 0080 f601                 .word   0x1f6
    \ 0082 ....                 .word   `?L408`-1
    \ 0084 f701                 .word   0x1f7
    \ 0086 ....                 .word   `?L404`-1
    \ 0088 f801                 .word   0x1f8
    \ 008a ....                 .word   `?L408`-1
    \ 008c fa01                 .word   0x1fa
    \ 008e ....                 .word   `?L378`-1
    \ 0090 0902                 .word   0x209
    \ 0092 ....                 .word   `?L419`-1
    \ 0094 9102                 .word   0x291
    \ 0096 ....                 .word   `?L427`-1
    \ 0098 9402                 .word   0x294
    \ 009a ....                 .word   `?L393`-1
    \ 009c 9d02                 .word   0x29d
    \ 009e ....                 .word   `?L423`-1
    \ 00a0 f102                 .word   0x2f1
    \ 00a2 ....                 .word   `?L388`-1
    \ 00a4 f202                 .word   0x2f2
    \ 00a6 ....                 .word   `?L416`-1
    \ 00a8 f302                 .word   0x2f3
    \ 00aa ....                 .word   `?L381`-1
    \ 00ac f402                 .word   0x2f4
    \ 00ae ....                 .word   `?L381`-1
    \ 00b0 f602                 .word   0x2f6
    \ 00b2 ....                 .word   `?L408`-1
    \ 00b4 f702                 .word   0x2f7
    \ 00b6 ....                 .word   `?L404`-1
    \ 00b8 f802                 .word   0x2f8
    \ 00ba ....                 .word   `?L408`-1
    \ 00bc fa02                 .word   0x2fa
    \ 00be ....                 .word   `?L378`-1
    \ 00c0 1204                 .word   0x412
    \ 00c2 ....                 .word   `?L399`-1
    \ 00c4 1504                 .word   0x415
    \ 00c6 ....                 .word   `?L381`-1
    \ 00c8 f408                 .word   0x8f4
    \ 00ca ....                 .word   `?L415`-1
    \ 00cc f608                 .word   0x8f6
    \ 00ce ....                 .word   `?L407`-1
    \ 00d0 f808                 .word   0x8f8
    \ 00d2 ....                 .word   `?L403`-1
    \ 00d4 fa08                 .word   0x8fa
    \ 00d6 ....                 .word   `?L402`-1
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ `
    \ 0000          `_StringLiteral_ `:
    \ 0000 2000                 .byte   32,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_[32,30]`
    \ 0000          `_StringLiteral_[32,30]`:
    \ 0000 201e00               .byte   32,30,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_    `
    \ 0000          `_StringLiteral_    `:
    \ 0000 20202020             .byte   32,32,32,32,0
    \ 0004 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_     `
    \ 0000          `_StringLiteral_     `:
    \ 0000 20202020             .byte   32,32,32,32,32,0
    \ 0004 2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_      `
    \ 0000          `_StringLiteral_      `:
    \ 0000 20202020             .byte   32,32,32,32,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_   OK   `
    \ 0000          `_StringLiteral_   OK   `:
    \ 0000 2020204f             .byte   32,32,32,79,75,32,32,32,0
    \ 0004 4b202020
    \ 0008 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 1`
    \ 0000          `_StringLiteral_ 1`:
    \ 0000 203100               .byte   32,49,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 10`
    \ 0000          `_StringLiteral_ 10`:
    \ 0000 20313000             .byte   32,49,48,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 2`
    \ 0000          `_StringLiteral_ 2`:
    \ 0000 203200               .byte   32,50,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 3`
    \ 0000          `_StringLiteral_ 3`:
    \ 0000 203300               .byte   32,51,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 4`
    \ 0000          `_StringLiteral_ 4`:
    \ 0000 203400               .byte   32,52,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 5`
    \ 0000          `_StringLiteral_ 5`:
    \ 0000 203500               .byte   32,53,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 6`
    \ 0000          `_StringLiteral_ 6`:
    \ 0000 203600               .byte   32,54,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 7`
    \ 0000          `_StringLiteral_ 7`:
    \ 0000 203700               .byte   32,55,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 8`
    \ 0000          `_StringLiteral_ 8`:
    \ 0000 203800               .byte   32,56,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ 9`
    \ 0000          `_StringLiteral_ 9`:
    \ 0000 203900               .byte   32,57,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ F11 to mount real drive `
    \ 0000          `_StringLiteral_ F11 to mount real drive `:
    \ 0000 20463131             .byte   32,70,49,49,32,116,111,32,109,111,117,110,116,32,114,101,97,108,32,100,114,105,118,101,32,0
    \ 0004 20746f20
    \ 0008 6d6f756e
    \ 000c 74207265
    \ 0010 616c2064
    \ 0014 72697665
    \ 0018 2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ List of ROM files `
    \ 0000          `_StringLiteral_ List of ROM files `:
    \ 0000 204c6973             .byte   32,76,105,115,116,32,111,102,32,82,79,77,32,102,105,108,101,115,32,0
    \ 0004 74206f66
    \ 0008 20524f4d
    \ 000c 2066696c
    \ 0010 65732000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ Menu `
    \ 0000          `_StringLiteral_ Menu `:
    \ 0000 204d656e             .byte   32,77,101,110,117,32,0
    \ 0004 752000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ Midnight Mega `
    \ 0000          `_StringLiteral_ Midnight Mega `:
    \ 0000 204d6964             .byte   32,77,105,100,110,105,103,104,116,32,77,101,103,97,32,0
    \ 0004 6e696768
    \ 0008 74204d65
    \ 000c 67612000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ RETURN`
    \ 0000          `_StringLiteral_ RETURN`:
    \ 0000 20524554             .byte   32,82,69,84,85,82,78,0
    \ 0004 55524e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ STOP`
    \ 0000          `_StringLiteral_ STOP`:
    \ 0000 2053544f             .byte   32,83,84,79,80,0
    \ 0004 5000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ Setup `
    \ 0000          `_StringLiteral_ Setup `:
    \ 0000 20536574             .byte   32,83,101,116,117,112,32,0
    \ 0004 75702000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ Space`
    \ 0000          `_StringLiteral_ Space`:
    \ 0000 20537061             .byte   32,83,112,97,99,101,0
    \ 0004 636500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ The MEGA65 file commander `
    \ 0000          `_StringLiteral_ The MEGA65 file commander `:
    \ 0000 20546865             .byte   32,84,104,101,32,77,69,71,65,54,53,32,102,105,108,101,32,99,111,109,109,97,110,100,101,114,32,0
    \ 0004 204d4547
    \ 0008 41363520
    \ 000c 66696c65
    \ 0010 20636f6d
    \ 0014 6d616e64
    \ 0018 65722000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ blocks free `
    \ 0000          `_StringLiteral_ blocks free `:
    \ 0000 20626c6f             .byte   32,98,108,111,99,107,115,32,102,114,101,101,32,0
    \ 0004 636b7320
    \ 0008 66726565
    \ 000c 2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ disk access error `
    \ 0000          `_StringLiteral_ disk access error `:
    \ 0000 20646973             .byte   32,100,105,115,107,32,97,99,99,101,115,115,32,101,114,114,111,114,32,0
    \ 0004 6b206163
    \ 0008 63657373
    \ 000c 20657272
    \ 0010 6f722000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ drv:`
    \ 0000          `_StringLiteral_ drv:`:
    \ 0000 20647276             .byte   32,100,114,118,58,0
    \ 0004 3a00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ empty `
    \ 0000          `_StringLiteral_ empty `:
    \ 0000 20656d70             .byte   32,101,109,112,116,121,32,0
    \ 0004 74792000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ github.com/nobruinfo `
    \ 0000          `_StringLiteral_ github.com/nobruinfo `:
    \ 0000 20676974             .byte   32,103,105,116,104,117,98,46,99,111,109,47,110,111,98,114,117,105,110,102,111,32,0
    \ 0004 6875622e
    \ 0008 636f6d2f
    \ 000c 6e6f6272
    \ 0010 75696e66
    \ 0014 6f2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ v`
    \ 0000          `_StringLiteral_ v`:
    \ 0000 207600               .byte   32,118,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_A HICKUP.M65 v1.2 or older is active on your storage card`
    \ 0000          `_StringLiteral_A HICKUP.M65 v1.2 or older is active on your storage card`:
    \ 0000 41204849             .byte   65,32,72,73,67,75,85,80,46,77,54,53,32,118,49,46,50,32,111,114,32,111,108,100,101,114,32,105,115,32,97,99,116,105,118,101,32,111,110,32,121,111,117,114,32,115,116,111,114,97,103,101,32,99,97,114,100,0
    \ 0004 434b5550
    \ 0008 2e4d3635
    \ 000c 2076312e
    \ 0010 32206f72
    \ 0014 206f6c64
    \ 0018 65722069
    \ 001c 73206163
    \ 0020 74697665
    \ 0024 206f6e20
    \ 0028 796f7572
    \ 002c 2073746f
    \ 0030 72616765
    \ 0034 20636172
    \ 0038 6400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Arrange entries:`
    \ 0000          `_StringLiteral_Arrange entries:`:
    \ 0000 41727261             .byte   65,114,114,97,110,103,101,32,101,110,116,114,105,101,115,58,0
    \ 0004 6e676520
    \ 0008 656e7472
    \ 000c 6965733a
    \ 0010 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_BAM
    \ 0000          _StringLiteral_BAM:
    \ 0000 42414d00             .byte   66,65,77,0
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Copy  `
    \ 0000          `_StringLiteral_Copy  `:
    \ 0000 436f7079             .byte   67,111,112,121,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Copying from/to storage cards`
    \ 0000          `_StringLiteral_Copying from/to storage cards`:
    \ 0000 436f7079             .byte   67,111,112,121,105,110,103,32,102,114,111,109,47,116,111,32,115,116,111,114,97,103,101,32,99,97,114,100,115,0
    \ 0004 696e6720
    \ 0008 66726f6d
    \ 000c 2f746f20
    \ 0010 73746f72
    \ 0014 61676520
    \ 0018 63617264
    \ 001c 7300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Copying full directory structures`
    \ 0000          `_StringLiteral_Copying full directory structures`:
    \ 0000 436f7079             .byte   67,111,112,121,105,110,103,32,102,117,108,108,32,100,105,114,101,99,116,111,114,121,32,115,116,114,117,99,116,117,114,101,115,0
    \ 0004 696e6720
    \ 0008 66756c6c
    \ 000c 20646972
    \ 0010 6563746f
    \ 0014 72792073
    \ 0018 74727563
    \ 001c 74757265
    \ 0020 7300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Copying storage card files/folders`
    \ 0000          `_StringLiteral_Copying storage card files/folders`:
    \ 0000 436f7079             .byte   67,111,112,121,105,110,103,32,115,116,111,114,97,103,101,32,99,97,114,100,32,102,105,108,101,115,47,102,111,108,100,101,114,115,0
    \ 0004 696e6720
    \ 0008 73746f72
    \ 000c 61676520
    \ 0010 63617264
    \ 0014 2066696c
    \ 0018 65732f66
    \ 001c 6f6c6465
    \ 0020 727300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Copying subdirectories`
    \ 0000          `_StringLiteral_Copying subdirectories`:
    \ 0000 436f7079             .byte   67,111,112,121,105,110,103,32,115,117,98,100,105,114,101,99,116,111,114,105,101,115,0
    \ 0004 696e6720
    \ 0008 73756264
    \ 000c 69726563
    \ 0010 746f7269
    \ 0014 657300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Crsr down`
    \ 0000          `_StringLiteral_Crsr down`:
    \ 0000 43727372             .byte   67,114,115,114,32,100,111,119,110,0
    \ 0004 20646f77
    \ 0008 6e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Crsr up`
    \ 0000          `_StringLiteral_Crsr up`:
    \ 0000 43727372             .byte   67,114,115,114,32,117,112,0
    \ 0004 20757000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Currently this option dialog cannot`
    \ 0000          `_StringLiteral_Currently this option dialog cannot`:
    \ 0000 43757272             .byte   67,117,114,114,101,110,116,108,121,32,116,104,105,115,32,111,112,116,105,111,110,32,100,105,97,108,111,103,32,99,97,110,110,111,116,0
    \ 0004 656e746c
    \ 0008 79207468
    \ 000c 6973206f
    \ 0010 7074696f
    \ 0014 6e206469
    \ 0018 616c6f67
    \ 001c 2063616e
    \ 0020 6e6f7400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Delete
    \ 0000          _StringLiteral_Delete:
    \ 0000 44656c65             .byte   68,101,108,101,116,101,0
    \ 0004 746500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Directory `
    \ 0000          `_StringLiteral_Directory `:
    \ 0000 44697265             .byte   68,105,114,101,99,116,111,114,121,32,0
    \ 0004 63746f72
    \ 0008 792000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Directory delete,`
    \ 0000          `_StringLiteral_Directory delete,`:
    \ 0000 44697265             .byte   68,105,114,101,99,116,111,114,121,32,100,101,108,101,116,101,44,0
    \ 0004 63746f72
    \ 0008 79206465
    \ 000c 6c657465
    \ 0010 2c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Directory entry sorting,`
    \ 0000          `_StringLiteral_Directory entry sorting,`:
    \ 0000 44697265             .byte   68,105,114,101,99,116,111,114,121,32,101,110,116,114,121,32,115,111,114,116,105,110,103,44,0
    \ 0004 63746f72
    \ 0008 7920656e
    \ 000c 74727920
    \ 0010 736f7274
    \ 0014 696e672c
    \ 0018 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Directory operation on`
    \ 0000          `_StringLiteral_Directory operation on`:
    \ 0000 44697265             .byte   68,105,114,101,99,116,111,114,121,32,111,112,101,114,97,116,105,111,110,32,111,110,0
    \ 0004 63746f72
    \ 0008 79206f70
    \ 000c 65726174
    \ 0010 696f6e20
    \ 0014 6f6e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Directory structure delete,`
    \ 0000          `_StringLiteral_Directory structure delete,`:
    \ 0000 44697265             .byte   68,105,114,101,99,116,111,114,121,32,115,116,114,117,99,116,117,114,101,32,100,101,108,101,116,101,44,0
    \ 0004 63746f72
    \ 0008 79207374
    \ 000c 72756374
    \ 0010 75726520
    \ 0014 64656c65
    \ 0018 74652c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Disk copy,`
    \ 0000          `_StringLiteral_Disk copy,`:
    \ 0000 4469736b             .byte   68,105,115,107,32,99,111,112,121,44,0
    \ 0004 20636f70
    \ 0008 792c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Disk will be quickformatted`
    \ 0000          `_StringLiteral_Disk will be quickformatted`:
    \ 0000 4469736b             .byte   68,105,115,107,32,119,105,108,108,32,98,101,32,113,117,105,99,107,102,111,114,109,97,116,116,101,100,0
    \ 0004 2077696c
    \ 0008 6c206265
    \ 000c 20717569
    \ 0010 636b666f
    \ 0014 726d6174
    \ 0018 74656400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_DskCpy
    \ 0000          _StringLiteral_DskCpy:
    \ 0000 44736b43             .byte   68,115,107,67,112,121,0
    \ 0004 707900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ERROR text data file not found!`
    \ 0000          `_StringLiteral_ERROR text data file not found!`:
    \ 0000 4552524f             .byte   69,82,82,79,82,32,116,101,120,116,32,100,97,116,97,32,102,105,108,101,32,110,111,116,32,102,111,117,110,100,33,0
    \ 0004 52207465
    \ 0008 78742064
    \ 000c 61746120
    \ 0010 66696c65
    \ 0014 206e6f74
    \ 0018 20666f75
    \ 001c 6e642100
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_ERROR too much text data for available blocks!`
    \ 0000          `_StringLiteral_ERROR too much text data for available blocks!`:
    \ 0000 4552524f             .byte   69,82,82,79,82,32,116,111,111,32,109,117,99,104,32,116,101,120,116,32,100,97,116,97,32,102,111,114,32,97,118,97,105,108,97,98,108,101,32,98,108,111,99,107,115,33,0
    \ 0004 5220746f
    \ 0008 6f206d75
    \ 000c 63682074
    \ 0010 65787420
    \ 0014 64617461
    \ 0018 20666f72
    \ 001c 20617661
    \ 0020 696c6162
    \ 0024 6c652062
    \ 0028 6c6f636b
    \ 002c 732100
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Edit  `
    \ 0000          `_StringLiteral_Edit  `:
    \ 0000 45646974             .byte   69,100,105,116,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Enter amount of tracks 2..80, 0 to quit:`
    \ 0000          `_StringLiteral_Enter amount of tracks 2..80, 0 to quit:`:
    \ 0000 456e7465             .byte   69,110,116,101,114,32,97,109,111,117,110,116,32,111,102,32,116,114,97,99,107,115,32,50,46,46,56,48,44,32,48,32,116,111,32,113,117,105,116,58,0
    \ 0004 7220616d
    \ 0008 6f756e74
    \ 000c 206f6620
    \ 0010 74726163
    \ 0014 6b732032
    \ 0018 2e2e3830
    \ 001c 2c203020
    \ 0020 746f2071
    \ 0024 7569743a
    \ 0028 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Enter the new name, empty to skip:`
    \ 0000          `_StringLiteral_Enter the new name, empty to skip:`:
    \ 0000 456e7465             .byte   69,110,116,101,114,32,116,104,101,32,110,101,119,32,110,97,109,101,44,32,101,109,112,116,121,32,116,111,32,115,107,105,112,58,0
    \ 0004 72207468
    \ 0008 65206e65
    \ 000c 77206e61
    \ 0010 6d652c20
    \ 0014 656d7074
    \ 0018 7920746f
    \ 001c 20736b69
    \ 0020 703a00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_File `
    \ 0000          `_StringLiteral_File `:
    \ 0000 46696c65             .byte   70,105,108,101,32,0
    \ 0004 2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_File copy,`
    \ 0000          `_StringLiteral_File copy,`:
    \ 0000 46696c65             .byte   70,105,108,101,32,99,111,112,121,44,0
    \ 0004 20636f70
    \ 0008 792c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_File delete,`
    \ 0000          `_StringLiteral_File delete,`:
    \ 0000 46696c65             .byte   70,105,108,101,32,100,101,108,101,116,101,44,0
    \ 0004 2064656c
    \ 0008 6574652c
    \ 000c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_File type for`
    \ 0000          `_StringLiteral_File type for`:
    \ 0000 46696c65             .byte   70,105,108,101,32,116,121,112,101,32,102,111,114,0
    \ 0004 20747970
    \ 0008 6520666f
    \ 000c 7200
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Format
    \ 0000          _StringLiteral_Format:
    \ 0000 466f726d             .byte   70,111,114,109,97,116,0
    \ 0004 617400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Freezer
    \ 0000          _StringLiteral_Freezer:
    \ 0000 46726565             .byte   70,114,101,101,122,101,114,0
    \ 0004 7a657200
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Freezr
    \ 0000          _StringLiteral_Freezr:
    \ 0000 46726565             .byte   70,114,101,101,122,114,0
    \ 0004 7a7200
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Help  `
    \ 0000          `_StringLiteral_Help  `:
    \ 0000 48656c70             .byte   72,101,108,112,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Initialising...`
    \ 0000          `_StringLiteral_Initialising...`:
    \ 0000 496e6974             .byte   73,110,105,116,105,97,108,105,115,105,110,103,46,46,46,0
    \ 0004 69616c69
    \ 0008 73696e67
    \ 000c 2e2e2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_MIDNIGHTMEGATEXT
    \ 0000          _StringLiteral_MIDNIGHTMEGATEXT:
    \ 0000 4d49444e             .byte   77,73,68,78,73,71,72,84,77,69,71,65,84,69,88,84,0
    \ 0004 49474854
    \ 0008 4d454741
    \ 000c 54455854
    \ 0010 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Menu  `
    \ 0000          `_StringLiteral_Menu  `:
    \ 0000 4d656e75             .byte   77,101,110,117,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Mkdir `
    \ 0000          `_StringLiteral_Mkdir `:
    \ 0000 4d6b6469             .byte   77,107,100,105,114,32,0
    \ 0004 722000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Mount `
    \ 0000          `_StringLiteral_Mount `:
    \ 0000 4d6f756e             .byte   77,111,117,110,116,32,0
    \ 0004 742000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_No space to create a`
    \ 0000          `_StringLiteral_No space to create a`:
    \ 0000 4e6f2073             .byte   78,111,32,115,112,97,99,101,32,116,111,32,99,114,101,97,116,101,32,97,0
    \ 0004 70616365
    \ 0008 20746f20
    \ 000c 63726561
    \ 0010 74652061
    \ 0014 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Not enough tracks available`
    \ 0000          `_StringLiteral_Not enough tracks available`:
    \ 0000 4e6f7420             .byte   78,111,116,32,101,110,111,117,103,104,32,116,114,97,99,107,115,32,97,118,97,105,108,97,98,108,101,0
    \ 0004 656e6f75
    \ 0008 67682074
    \ 000c 7261636b
    \ 0010 73206176
    \ 0014 61696c61
    \ 0018 626c6500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Operation on mulitiple`
    \ 0000          `_StringLiteral_Operation on mulitiple`:
    \ 0000 4f706572             .byte   79,112,101,114,97,116,105,111,110,32,111,110,32,109,117,108,105,116,105,112,108,101,0
    \ 0004 6174696f
    \ 0008 6e206f6e
    \ 000c 206d756c
    \ 0010 69746970
    \ 0014 6c6500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Please enter name of the subdirectory`
    \ 0000          `_StringLiteral_Please enter name of the subdirectory`:
    \ 0000 506c6561             .byte   80,108,101,97,115,101,32,101,110,116,101,114,32,110,97,109,101,32,111,102,32,116,104,101,32,115,117,98,100,105,114,101,99,116,111,114,121,0
    \ 0004 73652065
    \ 0008 6e746572
    \ 000c 206e616d
    \ 0010 65206f66
    \ 0014 20746865
    \ 0018 20737562
    \ 001c 64697265
    \ 0020 63746f72
    \ 0024 7900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Please enter the disk's name`
    \ 0000          `_StringLiteral_Please enter the disk's name`:
    \ 0000 506c6561             .byte   80,108,101,97,115,101,32,101,110,116,101,114,32,116,104,101,32,100,105,115,107,39,115,32,110,97,109,101,0
    \ 0004 73652065
    \ 0008 6e746572
    \ 000c 20746865
    \ 0010 20646973
    \ 0014 6b277320
    \ 0018 6e616d65
    \ 001c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Press RETURN or STOP to continue.`
    \ 0000          `_StringLiteral_Press RETURN or STOP to continue.`:
    \ 0000 50726573             .byte   80,114,101,115,115,32,82,69,84,85,82,78,32,111,114,32,83,84,79,80,32,116,111,32,99,111,110,116,105,110,117,101,46,0
    \ 0004 73205245
    \ 0008 5455524e
    \ 000c 206f7220
    \ 0010 53544f50
    \ 0014 20746f20
    \ 0018 636f6e74
    \ 001c 696e7565
    \ 0020 2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Press RETURN to continue, STOP to halt.`
    \ 0000          `_StringLiteral_Press RETURN to continue, STOP to halt.`:
    \ 0000 50726573             .byte   80,114,101,115,115,32,82,69,84,85,82,78,32,116,111,32,99,111,110,116,105,110,117,101,44,32,83,84,79,80,32,116,111,32,104,97,108,116,46,0
    \ 0004 73205245
    \ 0008 5455524e
    \ 000c 20746f20
    \ 0010 636f6e74
    \ 0014 696e7565
    \ 0018 2c205354
    \ 001c 4f502074
    \ 0020 6f206861
    \ 0024 6c742e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Programme terminating.`
    \ 0000          `_StringLiteral_Programme terminating.`:
    \ 0000 50726f67             .byte   80,114,111,103,114,97,109,109,101,32,116,101,114,109,105,110,97,116,105,110,103,46,0
    \ 0004 72616d6d
    \ 0008 65207465
    \ 000c 726d696e
    \ 0010 6174696e
    \ 0014 672e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Quit `
    \ 0000          `_StringLiteral_Quit `:
    \ 0000 51756974             .byte   81,117,105,116,32,0
    \ 0004 2000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Quit  `
    \ 0000          `_StringLiteral_Quit  `:
    \ 0000 51756974             .byte   81,117,105,116,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_ROMlst
    \ 0000          _StringLiteral_ROMlst:
    \ 0000 524f4d6c             .byte   82,79,77,108,115,116,0
    \ 0004 737400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Reading...`
    \ 0000          `_StringLiteral_Reading...`:
    \ 0000 52656164             .byte   82,101,97,100,105,110,103,46,46,46,0
    \ 0004 696e672e
    \ 0008 2e2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Rename
    \ 0000          _StringLiteral_Rename:
    \ 0000 52656e61             .byte   82,101,110,97,109,101,0
    \ 0004 6d6500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Storage card change directory,`
    \ 0000          `_StringLiteral_Storage card change directory,`:
    \ 0000 53746f72             .byte   83,116,111,114,97,103,101,32,99,97,114,100,32,99,104,97,110,103,101,32,100,105,114,101,99,116,111,114,121,44,0
    \ 0004 61676520
    \ 0008 63617264
    \ 000c 20636861
    \ 0010 6e676520
    \ 0014 64697265
    \ 0018 63746f72
    \ 001c 792c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Storage card mounting,`
    \ 0000          `_StringLiteral_Storage card mounting,`:
    \ 0000 53746f72             .byte   83,116,111,114,97,103,101,32,99,97,114,100,32,109,111,117,110,116,105,110,103,44,0
    \ 0004 61676520
    \ 0008 63617264
    \ 000c 206d6f75
    \ 0010 6e74696e
    \ 0014 672c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Storage card parent directory,`
    \ 0000          `_StringLiteral_Storage card parent directory,`:
    \ 0000 53746f72             .byte   83,116,111,114,97,103,101,32,99,97,114,100,32,112,97,114,101,110,116,32,100,105,114,101,99,116,111,114,121,44,0
    \ 0004 61676520
    \ 0008 63617264
    \ 000c 20706172
    \ 0010 656e7420
    \ 0014 64697265
    \ 0018 63746f72
    \ 001c 792c00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_The to be formatted disk/image file has to`
    \ 0000          `_StringLiteral_The to be formatted disk/image file has to`:
    \ 0000 54686520             .byte   84,104,101,32,116,111,32,98,101,32,102,111,114,109,97,116,116,101,100,32,100,105,115,107,47,105,109,97,103,101,32,102,105,108,101,32,104,97,115,32,116,111,0
    \ 0004 746f2062
    \ 0008 6520666f
    \ 000c 726d6174
    \ 0010 74656420
    \ 0014 6469736b
    \ 0018 2f696d61
    \ 001c 67652066
    \ 0020 696c6520
    \ 0024 68617320
    \ 0028 746f00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_This file type/directory`
    \ 0000          `_StringLiteral_This file type/directory`:
    \ 0000 54686973             .byte   84,104,105,115,32,102,105,108,101,32,116,121,112,101,47,100,105,114,101,99,116,111,114,121,0
    \ 0004 2066696c
    \ 0008 65207479
    \ 000c 70652f64
    \ 0010 69726563
    \ 0014 746f7279
    \ 0018 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_To create a directory a disk has to`
    \ 0000          `_StringLiteral_To create a directory a disk has to`:
    \ 0000 546f2063             .byte   84,111,32,99,114,101,97,116,101,32,97,32,100,105,114,101,99,116,111,114,121,32,97,32,100,105,115,107,32,104,97,115,32,116,111,0
    \ 0004 72656174
    \ 0008 65206120
    \ 000c 64697265
    \ 0010 63746f72
    \ 0014 79206120
    \ 0018 6469736b
    \ 001c 20686173
    \ 0020 20746f00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_Unmount
    \ 0000          _StringLiteral_Unmount:
    \ 0000 556e6d6f             .byte   85,110,109,111,117,110,116,0
    \ 0004 756e7400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Use the spacebar to select/unselect.`
    \ 0000          `_StringLiteral_Use the spacebar to select/unselect.`:
    \ 0000 55736520             .byte   85,115,101,32,116,104,101,32,115,112,97,99,101,98,97,114,32,116,111,32,115,101,108,101,99,116,47,117,110,115,101,108,101,99,116,46,0
    \ 0004 74686520
    \ 0008 73706163
    \ 000c 65626172
    \ 0010 20746f20
    \ 0014 73656c65
    \ 0018 63742f75
    \ 001c 6e73656c
    \ 0020 6563742e
    \ 0024 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_View  `
    \ 0000          `_StringLiteral_View  `:
    \ 0000 56696577             .byte   86,105,101,119,32,32,0
    \ 0004 202000
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Writing...`
    \ 0000          `_StringLiteral_Writing...`:
    \ 0000 57726974             .byte   87,114,105,116,105,110,103,46,46,46,0
    \ 0004 696e672e
    \ 0008 2e2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_Your version of the Hyppo/HDOS is too old`
    \ 0000          `_StringLiteral_Your version of the Hyppo/HDOS is too old`:
    \ 0000 596f7572             .byte   89,111,117,114,32,118,101,114,115,105,111,110,32,111,102,32,116,104,101,32,72,121,112,112,111,47,72,68,79,83,32,105,115,32,116,111,111,32,111,108,100,0
    \ 0004 20766572
    \ 0008 73696f6e
    \ 000c 206f6620
    \ 0010 74686520
    \ 0014 48797070
    \ 0018 6f2f4844
    \ 001c 4f532069
    \ 0020 7320746f
    \ 0024 6f206f6c
    \ 0028 6400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_abort
    \ 0000          _StringLiteral_abort:
    \ 0000 61626f72             .byte   97,98,111,114,116,0
    \ 0004 7400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_accept.`
    \ 0000          `_StringLiteral_accept.`:
    \ 0000 61636365             .byte   97,99,99,101,112,116,46,0
    \ 0004 70742e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_already mounted`
    \ 0000          `_StringLiteral_already mounted`:
    \ 0000 616c7265             .byte   97,108,114,101,97,100,121,32,109,111,117,110,116,101,100,0
    \ 0004 61647920
    \ 0008 6d6f756e
    \ 000c 74656400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_be mounted and its root directory selected.`
    \ 0000          `_StringLiteral_be mounted and its root directory selected.`:
    \ 0000 6265206d             .byte   98,101,32,109,111,117,110,116,101,100,32,97,110,100,32,105,116,115,32,114,111,111,116,32,100,105,114,101,99,116,111,114,121,32,115,101,108,101,99,116,101,100,46,0
    \ 0004 6f756e74
    \ 0008 65642061
    \ 000c 6e642069
    \ 0010 74732072
    \ 0014 6f6f7420
    \ 0018 64697265
    \ 001c 63746f72
    \ 0020 79207365
    \ 0024 6c656374
    \ 0028 65642e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_be quit unsaved. So use RETURN to`
    \ 0000          `_StringLiteral_be quit unsaved. So use RETURN to`:
    \ 0000 62652071             .byte   98,101,32,113,117,105,116,32,117,110,115,97,118,101,100,46,32,83,111,32,117,115,101,32,82,69,84,85,82,78,32,116,111,0
    \ 0004 75697420
    \ 0008 756e7361
    \ 000c 7665642e
    \ 0010 20536f20
    \ 0014 75736520
    \ 0018 52455455
    \ 001c 524e2074
    \ 0020 6f00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_copy allocated BAM blocks only`
    \ 0000          `_StringLiteral_copy allocated BAM blocks only`:
    \ 0000 636f7079             .byte   99,111,112,121,32,97,108,108,111,99,97,116,101,100,32,66,65,77,32,98,108,111,99,107,115,32,111,110,108,121,0
    \ 0004 20616c6c
    \ 0008 6f636174
    \ 000c 65642042
    \ 0010 414d2062
    \ 0014 6c6f636b
    \ 0018 73206f6e
    \ 001c 6c7900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_destination disk space insufficient`
    \ 0000          `_StringLiteral_destination disk space insufficient`:
    \ 0000 64657374             .byte   100,101,115,116,105,110,97,116,105,111,110,32,100,105,115,107,32,115,112,97,99,101,32,105,110,115,117,102,102,105,99,105,101,110,116,0
    \ 0004 696e6174
    \ 0008 696f6e20
    \ 000c 6469736b
    \ 0010 20737061
    \ 0014 63652069
    \ 0018 6e737566
    \ 001c 66696369
    \ 0020 656e7400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_destination disk will be OVERWRITTEN`
    \ 0000          `_StringLiteral_destination disk will be OVERWRITTEN`:
    \ 0000 64657374             .byte   100,101,115,116,105,110,97,116,105,111,110,32,100,105,115,107,32,119,105,108,108,32,98,101,32,79,86,69,82,87,82,73,84,84,69,78,0
    \ 0004 696e6174
    \ 0008 696f6e20
    \ 000c 6469736b
    \ 0010 2077696c
    \ 0014 6c206265
    \ 0018 204f5645
    \ 001c 52575249
    \ 0020 5454454e
    \ 0024 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_destination file`
    \ 0000          `_StringLiteral_destination file`:
    \ 0000 64657374             .byte   100,101,115,116,105,110,97,116,105,111,110,32,102,105,108,101,0
    \ 0004 696e6174
    \ 0008 696f6e20
    \ 000c 66696c65
    \ 0010 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_did you save your work?`
    \ 0000          `_StringLiteral_did you save your work?`:
    \ 0000 64696420             .byte   100,105,100,32,121,111,117,32,115,97,118,101,32,121,111,117,114,32,119,111,114,107,63,0
    \ 0004 796f7520
    \ 0008 73617665
    \ 000c 20796f75
    \ 0010 7220776f
    \ 0014 726b3f00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_directory
    \ 0000          _StringLiteral_directory:
    \ 0000 64697265             .byte   100,105,114,101,99,116,111,114,121,0
    \ 0004 63746f72
    \ 0008 7900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_directory is not empty`
    \ 0000          `_StringLiteral_directory is not empty`:
    \ 0000 64697265             .byte   100,105,114,101,99,116,111,114,121,32,105,115,32,110,111,116,32,101,109,112,116,121,0
    \ 0004 63746f72
    \ 0008 79206973
    \ 000c 206e6f74
    \ 0010 20656d70
    \ 0014 747900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_entries is not supported`
    \ 0000          `_StringLiteral_entries is not supported`:
    \ 0000 656e7472             .byte   101,110,116,114,105,101,115,32,105,115,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0
    \ 0004 69657320
    \ 0008 6973206e
    \ 000c 6f742073
    \ 0010 7570706f
    \ 0014 72746564
    \ 0018 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_from left side`
    \ 0000          `_StringLiteral_from left side`:
    \ 0000 66726f6d             .byte   102,114,111,109,32,108,101,102,116,32,115,105,100,101,0
    \ 0004 206c6566
    \ 0008 74207369
    \ 000c 646500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_from left to right`
    \ 0000          `_StringLiteral_from left to right`:
    \ 0000 66726f6d             .byte   102,114,111,109,32,108,101,102,116,32,116,111,32,114,105,103,104,116,0
    \ 0004 206c6566
    \ 0008 7420746f
    \ 000c 20726967
    \ 0010 687400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_from right side`
    \ 0000          `_StringLiteral_from right side`:
    \ 0000 66726f6d             .byte   102,114,111,109,32,114,105,103,104,116,32,115,105,100,101,0
    \ 0004 20726967
    \ 0008 68742073
    \ 000c 69646500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_from right to left`
    \ 0000          `_StringLiteral_from right to left`:
    \ 0000 66726f6d             .byte   102,114,111,109,32,114,105,103,104,116,32,116,111,32,108,101,102,116,0
    \ 0004 20726967
    \ 0008 68742074
    \ 000c 6f206c65
    \ 0010 667400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_goes nowhere and does nothing`
    \ 0000          `_StringLiteral_goes nowhere and does nothing`:
    \ 0000 676f6573             .byte   103,111,101,115,32,110,111,119,104,101,114,101,32,97,110,100,32,100,111,101,115,32,110,111,116,104,105,110,103,0
    \ 0004 206e6f77
    \ 0008 68657265
    \ 000c 20616e64
    \ 0010 20646f65
    \ 0014 73206e6f
    \ 0018 7468696e
    \ 001c 6700
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_is not supported`
    \ 0000          `_StringLiteral_is not supported`:
    \ 0000 6973206e             .byte   105,115,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0
    \ 0004 6f742073
    \ 0008 7570706f
    \ 000c 72746564
    \ 0010 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_is not supported.`
    \ 0000          `_StringLiteral_is not supported.`:
    \ 0000 6973206e             .byte   105,115,32,110,111,116,32,115,117,112,112,111,114,116,101,100,46,0
    \ 0004 6f742073
    \ 0008 7570706f
    \ 000c 72746564
    \ 0010 2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_is not yet implemented.`
    \ 0000          `_StringLiteral_is not yet implemented.`:
    \ 0000 6973206e             .byte   105,115,32,110,111,116,32,121,101,116,32,105,109,112,108,101,109,101,110,116,101,100,46,0
    \ 0004 6f742079
    \ 0008 65742069
    \ 000c 6d706c65
    \ 0010 6d656e74
    \ 0014 65642e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_left drive?`
    \ 0000          `_StringLiteral_left drive?`:
    \ 0000 6c656674             .byte   108,101,102,116,32,100,114,105,118,101,63,0
    \ 0004 20647269
    \ 0008 76653f00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_mount failed for`
    \ 0000          `_StringLiteral_mount failed for`:
    \ 0000 6d6f756e             .byte   109,111,117,110,116,32,102,97,105,108,101,100,32,102,111,114,0
    \ 0004 74206661
    \ 0008 696c6564
    \ 000c 20666f72
    \ 0010 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_mounted on left side`
    \ 0000          `_StringLiteral_mounted on left side`:
    \ 0000 6d6f756e             .byte   109,111,117,110,116,101,100,32,111,110,32,108,101,102,116,32,115,105,100,101,0
    \ 0004 74656420
    \ 0008 6f6e206c
    \ 000c 65667420
    \ 0010 73696465
    \ 0014 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_mounted on right side`
    \ 0000          `_StringLiteral_mounted on right side`:
    \ 0000 6d6f756e             .byte   109,111,117,110,116,101,100,32,111,110,32,114,105,103,104,116,32,115,105,100,101,0
    \ 0004 74656420
    \ 0008 6f6e2072
    \ 000c 69676874
    \ 0010 20736964
    \ 0014 6500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_multiple selected entries`
    \ 0000          `_StringLiteral_multiple selected entries`:
    \ 0000 6d756c74             .byte   109,117,108,116,105,112,108,101,32,115,101,108,101,99,116,101,100,32,101,110,116,114,105,101,115,0
    \ 0004 69706c65
    \ 0008 2073656c
    \ 000c 65637465
    \ 0010 6420656e
    \ 0014 74726965
    \ 0018 7300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_not found`
    \ 0000          `_StringLiteral_not found`:
    \ 0000 6e6f7420             .byte   110,111,116,32,102,111,117,110,100,0
    \ 0004 666f756e
    \ 0008 6400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_on multiple selected`
    \ 0000          `_StringLiteral_on multiple selected`:
    \ 0000 6f6e206d             .byte   111,110,32,109,117,108,116,105,112,108,101,32,115,101,108,101,99,116,101,100,0
    \ 0004 756c7469
    \ 0008 706c6520
    \ 000c 73656c65
    \ 0010 63746564
    \ 0014 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_on storage card not possible`
    \ 0000          `_StringLiteral_on storage card not possible`:
    \ 0000 6f6e2073             .byte   111,110,32,115,116,111,114,97,103,101,32,99,97,114,100,32,110,111,116,32,112,111,115,115,105,98,108,101,0
    \ 0004 746f7261
    \ 0008 67652063
    \ 000c 61726420
    \ 0010 6e6f7420
    \ 0014 706f7373
    \ 0018 69626c65
    \ 001c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_open failed for`
    \ 0000          `_StringLiteral_open failed for`:
    \ 0000 6f70656e             .byte   111,112,101,110,32,102,97,105,108,101,100,32,102,111,114,0
    \ 0004 20666169
    \ 0008 6c656420
    \ 000c 666f7200
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_or an old core containing it. Falling back to slow mode.`
    \ 0000          `_StringLiteral_or an old core containing it. Falling back to slow mode.`:
    \ 0000 6f722061             .byte   111,114,32,97,110,32,111,108,100,32,99,111,114,101,32,99,111,110,116,97,105,110,105,110,103,32,105,116,46,32,70,97,108,108,105,110,103,32,98,97,99,107,32,116,111,32,115,108,111,119,32,109,111,100,101,46,0
    \ 0004 6e206f6c
    \ 0008 6420636f
    \ 000c 72652063
    \ 0010 6f6e7461
    \ 0014 696e696e
    \ 0018 67206974
    \ 001c 2e204661
    \ 0020 6c6c696e
    \ 0024 67206261
    \ 0028 636b2074
    \ 002c 6f20736c
    \ 0030 6f77206d
    \ 0034 6f64652e
    \ 0038 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_reading disk drives`
    \ 0000          `_StringLiteral_reading disk drives`:
    \ 0000 72656164             .byte   114,101,97,100,105,110,103,32,100,105,115,107,32,100,114,105,118,101,115,0
    \ 0004 696e6720
    \ 0008 6469736b
    \ 000c 20647269
    \ 0010 76657300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_real drive`
    \ 0000          `_StringLiteral_real drive`:
    \ 0000 7265616c             .byte   114,101,97,108,32,100,114,105,118,101,0
    \ 0004 20647269
    \ 0008 766500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_removing BAM entries`
    \ 0000          `_StringLiteral_removing BAM entries`:
    \ 0000 72656d6f             .byte   114,101,109,111,118,105,110,103,32,66,65,77,32,101,110,116,114,105,101,115,0
    \ 0004 76696e67
    \ 0008 2042414d
    \ 000c 20656e74
    \ 0010 72696573
    \ 0014 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_right drive?`
    \ 0000          `_StringLiteral_right drive?`:
    \ 0000 72696768             .byte   114,105,103,104,116,32,100,114,105,118,101,63,0
    \ 0004 74206472
    \ 0008 6976653f
    \ 000c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_save
    \ 0000          _StringLiteral_save:
    \ 0000 73617665             .byte   115,97,118,101,0
    \ 0004 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_select
    \ 0000          _StringLiteral_select:
    \ 0000 73656c65             .byte   115,101,108,101,99,116,0
    \ 0004 637400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_show DEL files`
    \ 0000          `_StringLiteral_show DEL files`:
    \ 0000 73686f77             .byte   115,104,111,119,32,68,69,76,32,102,105,108,101,115,0
    \ 0004 2044454c
    \ 0008 2066696c
    \ 000c 657300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_show drive access overlay`
    \ 0000          `_StringLiteral_show drive access overlay`:
    \ 0000 73686f77             .byte   115,104,111,119,32,100,114,105,118,101,32,97,99,99,101,115,115,32,111,118,101,114,108,97,121,0
    \ 0004 20647269
    \ 0008 76652061
    \ 000c 63636573
    \ 0010 73206f76
    \ 0014 65726c61
    \ 0018 7900
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_source file`
    \ 0000          `_StringLiteral_source file`:
    \ 0000 736f7572             .byte   115,111,117,114,99,101,32,102,105,108,101,0
    \ 0004 63652066
    \ 0008 696c6500
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_storage card`
    \ 0000          `_StringLiteral_storage card`:
    \ 0000 73746f72             .byte   115,116,111,114,97,103,101,32,99,97,114,100,0
    \ 0004 61676520
    \ 0008 63617264
    \ 000c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_storage card files/folders`
    \ 0000          `_StringLiteral_storage card files/folders`:
    \ 0000 73746f72             .byte   115,116,111,114,97,103,101,32,99,97,114,100,32,102,105,108,101,115,47,102,111,108,100,101,114,115,0
    \ 0004 61676520
    \ 0008 63617264
    \ 000c 2066696c
    \ 0010 65732f66
    \ 0014 6f6c6465
    \ 0018 727300
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_subdirectory.`
    \ 0000          `_StringLiteral_subdirectory.`:
    \ 0000 73756264             .byte   115,117,98,100,105,114,101,99,116,111,114,121,46,0
    \ 0004 69726563
    \ 0008 746f7279
    \ 000c 2e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_to create a directory.`
    \ 0000          `_StringLiteral_to create a directory.`:
    \ 0000 746f2063             .byte   116,111,32,99,114,101,97,116,101,32,97,32,100,105,114,101,99,116,111,114,121,46,0
    \ 0004 72656174
    \ 0008 65206120
    \ 000c 64697265
    \ 0010 63746f72
    \ 0014 792e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_to unmount drives.`
    \ 0000          `_StringLiteral_to unmount drives.`:
    \ 0000 746f2075             .byte   116,111,32,117,110,109,111,117,110,116,32,100,114,105,118,101,115,46,0
    \ 0004 6e6d6f75
    \ 0008 6e742064
    \ 000c 72697665
    \ 0010 732e00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak _StringLiteral_unsupported
    \ 0000          _StringLiteral_unsupported:
    \ 0000 756e7375             .byte   117,110,115,117,112,112,111,114,116,101,100,0
    \ 0004 70706f72
    \ 0008 74656400
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_updating BAM`
    \ 0000          `_StringLiteral_updating BAM`:
    \ 0000 75706461             .byte   117,112,100,97,116,105,110,103,32,66,65,77,0
    \ 0004 74696e67
    \ 0008 2042414d
    \ 000c 00
    \ 0000                      .section cdata,rodata
    \ 0000                      .pubweak `_StringLiteral_v0.6.6-beta`
    \ 0000          `_StringLiteral_v0.6.6-beta`:
    \ 0000 76302e36             .byte   118,48,46,54,46,54,45,98,101,116,97,0
    \ 0004 2e362d62
    \ 0008 65746100

##########################
#                        #
# Memory sizes (decimal) #
#                        #
##########################

Executable        (Text): 10915 bytes
Zero initialized   (BSS):   179 bytes
Data                    :     4 bytes
Constant                :  2899 bytes
